/*
活动名称：批量店铺签到（活动查询）
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割

查询活动信息主脚本，IP限制严重建议使用代理，请勿频繁运行
自动去重并过滤无效活动，默认过滤垃圾奖品活动
运行后会在本地目录生成缓存文件以用于签到脚本使用

cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到（活动查询）')
var iｉl='jsjiami.com.v7';const lillIl=iii1II;function Iii11l(){const illIiI=(function(){return[...[iｉl,'SGjqbSseVjHiaubmUik.qcIonme.HYvWRA7ElqRW==','WQ5tWOmyD8kaWQBdRhHg','uNRdNmocWQG','WRXbaw1o','rtpdVG','d8oiD3dcGmosWRhcQCoUvbtdIum','W7XeW5u','W67dQvBcNWa','W5tdOmkWhq','WOqnWQzdua','W5ddGmkVdCoP','g8kuc8k7vKHF','EmkfWO7dHSk2WQxdP1iWW6Pvy8oN','W7yeW4vmlCkHWRldNKHvla','WPpORjlMSzFLPQxOTjpcOokEVSog5PEa5zow5BMz5PEE5O6b','CEIUREAYJowMIEI3VhtIN716','W7K+FCkbwW','5yEW57Mh5yYq','4PMSe+IUN+wfN+wUSEs7GEw+VEINHoEzTUEoMEwHUEwpHoMfQEwqIoweQEI+RUIJIoIfToAESE+/JG','DYVdMrDd','yspcLCkqwGtcVuVdHCoJAdLnvdm','8kskMCkf','W7TwW7e5W5xcTSkR','WPNdQHzBmG','nUw/UowNSU+8LoAzI+EaV+wfV+ADNUwsHCk0','W7FcUJSjnG','WPvoW53dPCk0','CxWapLuoWPJdI8oJtq','bZpcI8oSWPy','WRaDEW','W6r4WO0','W7vYW7WqW5C','W4CSggG','fmovEq','W73dRSktnCou','44oIqow6QEMrN+wsVUENU++/GtS','qmkeW453qq','zCkkta','5P2155YT5AE/5zkA772V','W7DkW6CoW6K','W6tdUSkSWQlcOa','W4RdRmopWROwWRVcVqTeW4iUiWy','5BI+6zgC56EX5yUb','jdDfsIS','d8oBD3a','WPa9w2VdIfbhxCo/W4hdNSo4BsZcGG','WPS3sa','WQjpWOC0Amko','W54ChdS','WPylWQnhuJ7dKa','c+w6MEISJUEMKoMyG+EBJ+A2LUwjV++8Kq','qgJdLq','WQiGWPPbrG','jJjsBrGcWPxdHSoT','W57cGgBdP1FdP0C','l8oXW4fBW7TUkCkSW51jW5e','W4DTWRbGka','W7ZdP8kig8ofiuFcS8oKWOxcLfZcVIJdRW','W71kW4i','W6mGzCknxu3dLN7cSmoaW4xcSWfPtCoYjtb5lW','W79qW4G0W5VcOq','WQzCaxK','v8oiBvVcGCoKWQNcOCouCWldJexcO8oSESk1CSoRWPy','zhnvpx8','W5O4e0X8CSo/WRO','W4NVV5JMTy/LI7NLSzpLNQup','iKm8','qdldUSkpBLT/W5C','av3dGG','W5xdT8o0WPrzWP3cI8oIAmoQWPpcPSkgq8oy','W4pdVcvGWO0','W5VdVmo2WRrwWOdcHSovySoQ','77+15BAI5y6V5A6v','4P6GW7dOH6BMNkBOVOpOOjhPGQZLIj3KUiRPLA/ORivo','kdHsAtS','W70AwCoQWRtcMmoJnexcRG','W7NdI8omWPH7','W5JdRCkslSodo1RdQmozWOJcNxa','4PIXbEATQUATT+I9RUIIN+s/N+IMUUEzIEs5U+wkNEEyGoE+LUwUPUAvMEs4QU+8IUITVUAWSEAeH+wKPEs6Ko+/Mq','4P+feUAFJEIcQUASOEEJREwMMUEsGmoY','WPu/gq','FtpdSSkgDxPOW5BdVdFdH8o9iW','tw3dL8o1WPa','W6ldKmkvEmow','h0FdICk5W4O','W7RLUPJORApNP53PMzRNM5BMTPlLIzZVV6S','W48BfqRdUwpdPG','W4JdMCo+rCkN','4P+oWQlMN77OGkxMROtNO4hLPlJNKzWZ','c1VdICkOW5ZdQa','nUA3G+wkKEw3QUE7NUE5LEAEREs6Vq','W5S2da','WQTsWPi'],...(function(){return[...['W5WUBSoHWR4','ntVcT8ol','xWFdRSkjW4hdKmodWPu','j8oFW6pcS8oN','WPmZFZuM','W61tWPm2','W6mGz8kjq0xdKuVcG8og','W4ldV8kjFJOXWPGcW54tWOGHyZj3yq','WRNdQmkHsCkEkKK','cwtdKSk4W6m','eZlcUmokWR4','W6b0WRq5jq','qbJdJbP+','DCksWQuxWRG','57Yf5A6G5yAG5yw95A6D5Q2t77++5OM75z6k55IK5B2F776A','WR9MeLvg','WOddVSokrmkh','WOlcOSkW','WR5SW7NdNmk4uaJcHq','zmkmrvNdVSoeW49X','W7m6gK5H','BCo5WP5UurfkiHpcT8oME1u','d8oCW7FcJ8o4','kSoFFghcICoN','WPpdRcjiffNcGW','sCk3gmkm','pNJdGCkEW40','woE5QEADGE+8Ios7RUAUTEAuSEEbVoAFRUwqObm','W5ZdRSkU','W47dG2RcHI1FWPKAdmk8pJVcUIOf','cEA1P+wiSEw0KEE7LoE7RoADHEs4OG','CINcISk0vW','WPJcKINdVN4zW4ifnCkscHtcGa','w+E7TEACL+AwMoMxOE++Qa','ic5A','W5JdT8kXj8o2','W5ZdNSocWOvT','DqZdIW4j','WOJcSmovW4PGWQhdTW86W70TibSsx0NcPeKF','WR9hcwnEW7S','W5ddHsrVkg/cTG','rSk3gW','CHFdGr8soa','W5zGW7e','W40qbr/dS3RdQGFcGqtdUmkYEmosca','WR5rW6ZdRSkB','WQjWWOCivq','W7ZMTzdLIQlKVRNMGjpOJ7BLJilLPilOT7S','W73dImkWkCoJ','WQnCWOey','WQbyWOe4EmkDWQVdM3jgohhdPSo7W4u','DLvdaLy','WRBdL8o/x8kc','C2rgk2G','W7XaW5yLW5/cTmkG','E8kZWP1bWQezfmkgWOLYW4OF','ytZcImkHfvdcSfJdISo7CarghNZdNeK','W6S9ySkbsei','W78rsSo7W7xcKmoRhfdcVW','ye7dOmo2WRO','WR8eBJ0','f8otWRCze8kgyCkqob3cIW','t8kQdSkKFgO','5yY56ywg6k6N5PIZtbFdISknW4xcPCkErHHA','WRVdQmoR','us/dPcfl','WQeZWOPsAq','W7FcRrOLpmoJwSkPlHj9W4pcO3WBeColaSkXW4JdUq','W740WQddO8k8yd3cR8o8','WQqwWPnKWOJdP8krBmo7DCktW6G','ybf5aetdHchdMSo0','WOjGj1vH','W559W5a7W6q','vmkeW6XjqCkTF8k6','BHFdGmkHDa','WP8zCmoTW5O','rwRdGCo/','WQJOR6dMSQJLK6/LU6VcNG','WRXgg38','WOCTxei','4PI0W6lOROpLHjNLR4/KU4tLV6ROPy3NM7RNJ4/LOPFLJAhPHiNLKkdLH6pOVQ3OO6lOHztMN7tVVRO','WPhdUZPhfhJcGSoCWP3dLmokcfe','W4ZLV5dLPlFVViBMMiNNG6tLHABMNyJLKQSi','CEs4Jow7N+MsLa','vKLFe38','WQNcT8onASoPhx3cRSo6WQm','zqldMrG','WPpdHWLfjq','WQHshhy','cvpdNmkV','omkTW50AbfiueYdcS8o2wxFdSbW','8j2jJGS','W53cHhJdSq','lmoEW54'],...(function(){return['WODQjfPQ','W6ldSCkDc8od','W7T8WP9ShSotW4i','WPylWQfswYa','W6BdO8kTWQS','rtNdT8keB1C','WQbwbNbFW6a','W5NdQmo0qCkT','WOPkW7NdMCkD','W4xdJCkCWOdcQq','WOqAWQDuEq','jNNcQdrNW7BcP8ogW7i','W4qWeHRdHa','W4jtW7OtcgxcNSkZWQTBDMDN','W5KzFmozWQ8','WPvyi3Lh','uqZdPtev','D3PTiXaAW5WAWPxdL0PDW4lcTCoSW64','gcNcHG','8yIoHYRLVzJLPRFMNQtORlyt','WPxdPJHyhW','5O6O56Aa57Un5P2BW5JcQCoLW7JcTJPqWPODW7a','W6fqW5y+','WR9hcwvFW5Wrkmkx','swNdHa','AxjWnx3dMSouWQVcMSoUW4ZcPx7cRW','WQaKmLFdGa','W6fiW6e1W7y','DCoNWOm','W6T2WP5bfW','Amkgx3ZdRCoBW55Kfea','wgJdMCoDW7ZdRG','WOldKItdUMFdTLtcR04','W5T8WQ0geq','WPLRW73dICkyDbFcKSo2WOlcLmkKW4S','tCk9cmkOBhL3WROyDGXvWRJdKSkr','W5ddLwJcVIq','W67cLZyudq','W53dQComp2uvWPTEW58rWOC','CwnbfgpdJW','FCkMWO4dWR4','zMrDpN8','W4tdRSkIc8oB','W7BdKCkzi8om','lNpdPmkDW7i','WPVcTSkoW6HcW6tdQsz0W4e','uCkuW6foqCkSrq','yYJcHCkfub3cSq','W4tdKtTwWRK','WORcGCkTEXW','WPuqWR9Rttu','W5/cINi','WP7cVCkwW65AW6u','W73dUSkeimoH','W6ddPZ5eWPy','W5tdUmkMbmoM','W6KsWOanCSkfWRhcGKLxi13dPmoUW7ubmwBdSCo+WOFdNL0','WPWnWQO','W5WAgWFdUG','WQy8E1ZdJW','WRBdTmo/q8kwnG','W77dU8kzdCof','W78XW53dUCkoEY3cGq','WRtNUQFMNBdVVOFKU5pMR5dMLA7NG4ZMNypLK709','zJ3dRbjdW4dcLSoVW64','W5VdVmoJWOn8','W7NdL8out8kUW4VdUa','W5FcGMpdGgq','5yEXW5FLJ6e','W7tdP8k6WRZcGSoDDt4','WRtORzlMMi/MJzFdImkp5OUM5l2y55s45lMC55cT','WQPHW6ldRCkvrqZcLSoWWOtcOmkEW4lcS8kX','WQxcNCokamk2W63cQKTvW7P5Dq','W5tVVkJMT5ZLI7/LTRdKUi3cVG','4P67EoACHEEFJ+ITNoAXPG4','iJNcVmorWQKG','W68Cg3vP','WPldVdbEffNcHa','WR3dO8ottSkbkv5sAxNcGWtcOc1CrCktW7lMTjxLIlWcF++8KEwLHEs4G+EwNUIiSoAwRoMaVowpRowjGUwlGG','WQarWPjVWO7dOCo3vCopASkDW6ldKq','W5P4WQ8dB8ohW47dL8kwW7ZdOa','j1BdLCkqW74','WP3dGN/dTh0','ASk2WOCh','lmovDwhcI8orWQRcT8oKDsddLeC','W57cRqiudW','W4BVVPJMT4FLI7lLTztNUOBMNBe','fmohW6dcMCou','WOhcRmkkW6baW6RdPafU','twtdHSorW6tcUSkqWQKflCkfWQNdPhu','W5a8h1nXA8oQWPJdU0v7'];}())];}())];}());Iii11l=function(){return illIiI;};return Iii11l();};function iii1II(_0x356711,_0x54f858){const _0x3fd2ce=Iii11l();return iii1II=function(_0x2c7220,_0x5e3e5a){_0x2c7220=_0x2c7220-0x192;let _0x4768a5=_0x3fd2ce[_0x2c7220];if(iii1II['bjXLSE']===undefined){var _0x559cbc=function(_0x5c283d){const _0x1fc9c8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x360548='',_0x355282='';for(let _0x23bc2b=0x0,_0x29c4c6,_0x5943ee,_0x547f53=0x0;_0x5943ee=_0x5c283d['charAt'](_0x547f53++);~_0x5943ee&&(_0x29c4c6=_0x23bc2b%0x4?_0x29c4c6*0x40+_0x5943ee:_0x5943ee,_0x23bc2b++%0x4)?_0x360548+=String['fromCharCode'](0xff&_0x29c4c6>>(-0x2*_0x23bc2b&0x6)):0x0){_0x5943ee=_0x1fc9c8['indexOf'](_0x5943ee);}for(let _0x2907dd=0x0,_0x59aa00=_0x360548['length'];_0x2907dd<_0x59aa00;_0x2907dd++){_0x355282+='%'+('00'+_0x360548['charCodeAt'](_0x2907dd)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x355282);};const _0x1ca1fc=function(_0x53a9b5,_0x2b2d6e){let _0x2b6072=[],_0x1c7786=0x0,_0x436521,_0x360eb0='';_0x53a9b5=_0x559cbc(_0x53a9b5);let _0x360d55;for(_0x360d55=0x0;_0x360d55<0x100;_0x360d55++){_0x2b6072[_0x360d55]=_0x360d55;}for(_0x360d55=0x0;_0x360d55<0x100;_0x360d55++){_0x1c7786=(_0x1c7786+_0x2b6072[_0x360d55]+_0x2b2d6e['charCodeAt'](_0x360d55%_0x2b2d6e['length']))%0x100,_0x436521=_0x2b6072[_0x360d55],_0x2b6072[_0x360d55]=_0x2b6072[_0x1c7786],_0x2b6072[_0x1c7786]=_0x436521;}_0x360d55=0x0,_0x1c7786=0x0;for(let _0xccc89f=0x0;_0xccc89f<_0x53a9b5['length'];_0xccc89f++){_0x360d55=(_0x360d55+0x1)%0x100,_0x1c7786=(_0x1c7786+_0x2b6072[_0x360d55])%0x100,_0x436521=_0x2b6072[_0x360d55],_0x2b6072[_0x360d55]=_0x2b6072[_0x1c7786],_0x2b6072[_0x1c7786]=_0x436521,_0x360eb0+=String['fromCharCode'](_0x53a9b5['charCodeAt'](_0xccc89f)^_0x2b6072[(_0x2b6072[_0x360d55]+_0x2b6072[_0x1c7786])%0x100]);}return _0x360eb0;};iii1II['dPMIgB']=_0x1ca1fc,_0x356711=arguments,iii1II['bjXLSE']=!![];}const _0x2eef27=_0x3fd2ce[0x0],_0x1462e1=_0x2c7220+_0x2eef27,_0x3b6dd4=_0x356711[_0x1462e1];return!_0x3b6dd4?(iii1II['LgXxJy']===undefined&&(iii1II['LgXxJy']=!![]),_0x4768a5=iii1II['dPMIgB'](_0x4768a5,_0x5e3e5a),_0x356711[_0x1462e1]=_0x4768a5):_0x4768a5=_0x3b6dd4,_0x4768a5;},iii1II(_0x356711,_0x54f858);}(function(il1i1i,lil111,i11ilI,ii1ii1,llllI,lllil1,iil1il){return il1i1i=il1i1i>>0x8,lllil1='hs',iil1il='hs',function(ilil1I,i11il1,ii1iiI,lllilI,ilil11){const iil1li=iii1II;lllilI='tfi',lllil1=lllilI+lllil1,ilil11='up',iil1il+=ilil11,lllil1=ii1iiI(lllil1),iil1il=ii1iiI(iil1il),ii1iiI=0x0;const illlI1=ilil1I();while(!![]&&--ii1ii1+i11il1){try{lllilI=parseInt(iil1li(0x201,'Gsqc'))/0x1*(parseInt(iil1li(0x273,'%MFV'))/0x2)+-parseInt(iil1li(0x1a7,'sOPv'))/0x3*(-parseInt(iil1li(0x203,'891I'))/0x4)+parseInt(iil1li(0x1da,'9Nq('))/0x5*(-parseInt(iil1li(0x1e4,'&lo)'))/0x6)+parseInt(iil1li(0x1a9,'9)#k'))/0x7+-parseInt(iil1li(0x298,'J7&h'))/0x8*(-parseInt(iil1li(0x1bc,'mmOQ'))/0x9)+-parseInt(iil1li(0x193,'1lT5'))/0xa*(parseInt(iil1li(0x290,'Z5VR'))/0xb)+-parseInt(iil1li(0x202,'thKB'))/0xc;}catch(IIIl11){lllilI=ii1iiI;}finally{ilil11=illlI1[lllil1]();if(il1i1i<=ii1ii1)ii1iiI?llllI?lllilI=ilil11:llllI=ilil11:ii1iiI=ilil11;else{if(ii1iiI==llllI['replace'](/[WuAqelIVYbERSUnHkG=]/g,'')){if(lllilI===i11il1){illlI1['un'+lllil1](ilil11);break;}illlI1[iil1il](ilil11);}}}}}(i11ilI,lil111,function(I1lIi1,liiIIi,lil11I,Iliii1,iIiIi,iil1ll,iiilil){return liiIIi='\x73\x70\x6c\x69\x74',I1lIi1=arguments[0x0],I1lIi1=I1lIi1[liiIIi](''),lil11I=`\x72\x65\x76\x65\x72\x73\x65`,I1lIi1=I1lIi1[lil11I]('\x76'),Iliii1=`\x6a\x6f\x69\x6e`,(0x15c170,I1lIi1[Iliii1](''));});}(0xbd00,0xb7ee9,Iii11l,0xbf),Iii11l)&&(iｉl=0xbf);const common=require(lillIl(0x1d4,'891I')),{H5st,jsTk}=require(lillIl(0x25a,'jH&O'));console[lillIl(0x19b,'thKB')](''),console[lillIl(0x1fa,'@mNS')](lillIl(0x211,'Ldh(')+$['name']+lillIl(0x292,'glN[')),console['log'](lillIl(0x1ea,'0!^b')),console[lillIl(0x217,'*Qeb')]('=========='+$[lillIl(0x19a,'mmOQ')]+lillIl(0x1b1,'*Qeb')),console[lillIl(0x21b,'r3$B')]('');let tokensList=(process[lillIl(0x1b4,'CWWP')][lillIl(0x1b5,'nPy(')]||'')[lillIl(0x206,'fj29')](/[,@&|\n]+/g)[lillIl(0x19f,'9)#k')](Boolean),TokensMap=null;const CacheFile=__dirname+lillIl(0x234,'*Qeb');!(async()=>{const iIiIl=lillIl,Iiili={'MmSRw':function(IilIli){return IilIli();}};await Iiili[iIiIl(0x1aa,'d%4P')](Main);})()[lillIl(0x1b9,'0hlS')](li1=>$['logErr'](li1))[lillIl(0x227,'9)#k')](()=>$['done']());async function Main(){const iiilii=lillIl,illIl1={'XJKIB':function(l1llII,IilIll){return l1llII>IilIll;},'gnZFi':iiilii(0x208,'P1nt'),'lnuut':iiilii(0x244,'J7&h'),'XEpup':function(lI11Ii,Iiill,l11i1i,lI11I1){return lI11Ii(Iiill,l11i1i,lI11I1);},'VRjCQ':function(l1il11,IiI1){return l1il11<IiI1;},'iFSng':'getActivityInfo','lSNHi':function(liI,illIli){return liI-illIli;},'vojYj':function(l11i1l,lIII11){return l11i1l!==lIII11;},'xVWXk':iiilii(0x1bd,'$27]'),'gezlr':iiilii(0x1ad,'3zJw'),'NSOBJ':function(IiilI,ii1I11){return IiilI<ii1I11;},'txjrG':iiilii(0x20f,'KqKh'),'UnzgG':function(liIi1,lI11II){return liIi1===lI11II;},'OXumZ':function(l1llI1,llIIll){return l1llI1!==llIIll;},'xreby':'优惠券','yGhLO':function(IillIi,lii){return IillIi||lii;},'beLZe':function(IllI1i,i11I1l){return IllI1i>i11I1l;},'sUzBm':function(lil,IllI1l){return lil===IllI1l;},'cOvBI':iiilii(0x267,'G$pj'),'dyojS':function(i11I1i,IillIl){return i11I1i>IillIl;},'YkKnl':iiilii(0x263,'0!^b'),'GOHXN':iiilii(0x1ed,'K7X['),'SJdBt':iiilii(0x24b,'9)#k'),'incVF':function(llliil,liIl1){return llliil(liIl1);},'OmNzv':iiilii(0x261,'][WI')};try{if(illIl1[iiilii(0x192,'3zJw')](tokensList['length'],0x0))tokensList=[...new Set(tokensList[iiilii(0x24f,'K7X[')](IiIl=>IiIl!==''))];if(tokensList[iiilii(0x1d0,'uvCf')]<=0x0){console['log'](illIl1[iiilii(0x256,'thKB')]);return;}TokensMap=new Map(tokensList['map']((IiIi,iI1ll1)=>[IiIi,{'index':iI1ll1+0x1,'venderId':'','shopName':'','activityId':'','startTime':'','endTime':'','isValid':!![],'rules':[],'minLevel':null,'maxLevel':null}])),console[iiilii(0x229,'CWWP')](illIl1['lnuut']),console[iiilii(0x224,'IJcL')](iiilii(0x1af,'tF@(')+tokensList[iiilii(0x1a2,'P1nt')]+iiilii(0x2a6,'E[9@'));const II1lll=[];console[iiilii(0x214,'0hlS')](''),$['UA']=common[iiilii(0x1f8,'wss%')](iiilii(0x26a,'*Qeb')),{jsToken:$['jsToken']}=await illIl1[iiilii(0x1e8,'G$pj')](jsTk,$['UA'],'https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html',{'bizId':iiilii(0x1ec,'$27]'),'v':'3.2.1.0','qs':iiilii(0x1bb,'CWWP')+tokensList[0x0]});for(const IlI1Il of tokensList){let l1il1l=!![];$[iiilii(0x1b0,'glN[')]=IlI1Il;let liIil=0x0;$[iiilii(0x1e3,'9Nq(')]='',$[iiilii(0x259,'fj29')]=![];const IllI1I=0xa;while(!$[iiilii(0x223,'IJcL')]&&illIl1['VRjCQ'](liIil,IllI1I)&&!$[iiilii(0x241,'d%4P')]){$[iiilii(0x27f,'FL94')]='',await sendRequest(illIl1[iiilii(0x25e,'$27]')]),await $['wait'](0x3e8),liIil++,liIil>illIl1['lSNHi'](IllI1I,0x1)&&(illIl1[iiilii(0x1d6,'FL94')](illIl1[iiilii(0x286,'3zJw')],illIl1['xVWXk'])?(IlI11[iiilii(0x26f,'hUV4')]('['+iIIIIl+']：活动将在\x20'+II1Il+iiilii(0x20e,'][WI')),lilIlI['push'](iIIIIi),iii1I1=![]):(console['log'](''+$[iiilii(0x1f0,'*Qeb')]),$[iiilii(0x1ce,'9)#k')]=''));}if(!$[iiilii(0x198,'v!UV')])continue;const liIii=$[iiilii(0x285,'891I')]['venderId'],II1ll1=$[iiilii(0x270,'%MFV')]['id'],IlI1Ii=$[iiilii(0x1bf,'Gsqc')][iiilii(0x1f5,'CWWP')],i11I1I=$[iiilii(0x23b,'G1]X')][iiilii(0x296,'KqKh')]||[],l1il1i=$[iiilii(0x20a,'0n%!')][iiilii(0x2a4,'glN[')]||[],ll1=$['getActivityInfo'][iiilii(0x1b3,'P1nt')],iI1llI=$['getActivityInfo'][iiilii(0x24c,'FL94')],llliii=$['time'](illIl1[iiilii(0x235,'nPy(')],ll1),IllI11=$[iiilii(0x226,'FL94')](illIl1[iiilii(0x1c4,'2J1P')],iI1llI),l1llIi=Date['now']();ll1&&illIl1[iiilii(0x29a,'P1nt')](l1llIi,ll1)&&(console['log']('['+IlI1Il+iiilii(0x237,'KqKh')+llliii+iiilii(0x2a5,'jH&O')),II1lll[iiilii(0x1ef,'2J1P')](IlI1Il),l1il1l=![]);if(iI1llI&&illIl1[iiilii(0x210,'9Nq(')](l1llIi,iI1llI))illIl1[iiilii(0x1a6,'9)#k')]===illIl1['txjrG']?(console[iiilii(0x27c,'Gsqc')]('['+IlI1Il+']：活动已于\x20'+IllI11+iiilii(0x1db,'d%4P')),II1lll['push'](IlI1Il),l1il1l=![]):(i1l1[iiilii(0x230,'J7&h')](''+IIII1i[iiilii(0x1be,'9Nq(')]),IiilI1[iiilii(0x225,'891I')]='');else illIl1['UnzgG'](IlI1Ii,0x3)&&(console['log']('['+IlI1Il+iiilii(0x1f2,'1lT5')),II1lll[iiilii(0x2a2,'IJcL')](IlI1Il),l1il1l=![]);let II1llI=![];const i11I11=[],l1llIl=[...l1il1i,...i11I1I];for(const iI1li1 of l1llIl){if(illIl1[iiilii(0x257,'tF@(')](iiilii(0x1a4,'9Nq('),'Pxkzo')){const lllii1=iI1li1['level'],liIli=iI1li1['prizeList']||[],liIll=[];for(const IilIi1 of liIli){let iI1liI='';const l1lIiI=IilIi1['discount'],llliiI=IilIi1['type'],IilIiI=IilIi1[iiilii(0x232,'J7&h')],i1i1I1=IilIi1[iiilii(0x27a,'P1nt')],IlII1=i1i1I1===0x5;switch(llliiI){case 0x1:iI1liI=illIl1[iiilii(0x248,'wss%')];break;case 0x4:iI1liI=l1lIiI+'京豆';break;case 0x6:iI1liI=l1lIiI+iiilii(0x220,'%MFV');break;case 0x9:iI1liI=''+IilIi1?.[iiilii(0x231,'fj29')][0x0]?.[iiilii(0x19e,'0hlS')];break;case 0xa:iI1liI=l1lIiI+iiilii(0x1e0,'G1]X');break;case 0xe:iI1liI=l1lIiI/0x64+iiilii(0x207,'mmOQ');break;default:iI1liI=iiilii(0x21c,'v!UV')+llliiI+'）';}if(![0x1,0x6][iiilii(0x239,'@mNS')](llliiI)&&!IlII1)II1llI=!![];liIll[iiilii(0x29f,'wss%')](iI1liI+'（共'+IilIiI+'份'+(IlII1?iiilii(0x23e,'dEQ2'):'')+'）');}i11I11['push']({'days':lllii1,'prize':liIll,'havePrize':II1llI});}else IiilII[iiilii(0x19b,'thKB')]('['+IliI1I+iiilii(0x1e5,'$27]')+lI1Iii+iiilii(0x26e,'*Qeb')),i1li[iiilii(0x1b2,'J7&h')](li1II),IliI11=![];}let ii1I1l=await common[iiilii(0x1f6,'G$pj')]({'venderId':liIii});console['log']('【'+IlI1Il+iiilii(0x219,'M@U3')+illIl1['yGhLO'](ii1I1l,'未知')+'\x0a开始时间：'+llliii+iiilii(0x274,'E[9@')+IllI11);illIl1[iiilii(0x21a,'Z5VR')](i11I11['length'],0x0)&&console['log'](i11I11[iiilii(0x1fc,'J7&h')](lli=>(lli['days']===0x0?'每日签到':'连续'+(lli[iiilii(0x1fe,'hUV4')]<0xa?'\x20':'')+lli[iiilii(0x197,'K7X[')]+'天')+'：'+lli[iiilii(0x1f9,'P1nt')]['join']('，'))[iiilii(0x233,'P1nt')]('\x0a')+'\x0a');!II1llI&&(illIl1[iiilii(0x280,'9Nq(')](illIl1['cOvBI'],iiilii(0x267,'G$pj'))?(II1lll[iiilii(0x2a1,'P1nt')](IlI1Il),l1il1l=![]):l1lIl1[iiilii(0x275,'Ldh(')](iiilii(0x24e,'d5s0')+IiiIlI+iiilii(0x2a0,'0hlS')+(Iilli1[iiilii(0x289,'J7&h')]||I1l1Il)));const ii1I1i=TokensMap['get'](IlI1Il);ii1I1i[iiilii(0x29c,'Z5VR')]=liIii,ii1I1i[iiilii(0x265,'9Nq(')]=ii1I1l,ii1I1i[iiilii(0x1ba,'r3$B')]=II1ll1,ii1I1i['startTime']=ll1,ii1I1i[iiilii(0x1cb,'0n%!')]=iI1llI,ii1I1i['isValid']=l1il1l,ii1I1i[iiilii(0x24a,'K7X[')]=i11I11,illIl1[iiilii(0x240,'Ldh(')](i11I11['length'],0x0)&&(illIl1[iiilii(0x262,'P1nt')](illIl1[iiilii(0x24d,']7LL')],illIl1[iiilii(0x1ab,'P1nt')])?(ii1I1i[iiilii(0x266,'r3$B')]=i11I11[0x0][iiilii(0x194,'Yjug')],ii1I1i[iiilii(0x236,'G$pj')]=i11I11[illIl1[iiilii(0x29e,'M@U3')](i11I11[iiilii(0x1a2,'P1nt')],0x1)]['days']):iii1Il['log'](lI1IiI['map'](llli1=>(llli1[iiilii(0x1a0,'d5s0')]===0x0?'每日签到':'连续'+(llli1[iiilii(0x254,'juku')]<0xa?'\x20':'')+llli1['days']+'天')+'：'+llli1[iiilii(0x288,'nPy(')]['join']('，'))['join']('\x0a')+'\x0a')),TokensMap[iiilii(0x238,'E[9@')](IlI1Il,ii1I1i);}if(illIl1[iiilii(0x1d3,'hUV4')](II1lll[iiilii(0x1a1,'@mNS')],0x0)){if(illIl1[iiilii(0x29b,'J7&h')](illIl1[iiilii(0x1a5,'d5s0')],illIl1[iiilii(0x1fd,'%MFV')]))i1l1li[iiilii(0x216,'G$pj')](i1ilii),iIIII1=![];else{console['log'](illIl1[iiilii(0x26d,'K7X[')]);for(const iI1lii of II1lll){console[iiilii(0x23a,'K7X[')](iI1lii);}}}const II1lli=Object['fromEntries'](TokensMap),ii1I1I=illIl1[iiilii(0x1dd,'G1]X')](require,'fs');ii1I1I[iiilii(0x1fb,'*Qeb')](CacheFile,JSON[iiilii(0x1dc,'sOPv')](II1lli,null,0x2)),console['log'](illIl1[iiilii(0x269,'thKB')]),console['log'](CacheFile);}catch(IilIii){console['log'](iiilii(0x23f,'jH&O')+IilIii);}}async function handleResponse(iI1lil,l1lIi1){const li1i1i=lillIl,iIli1l={'dVwdZ':function(i1i1II,liiIIl){return i1i1II!==liiIIl;},'UQRaS':function(iil1iI,IlIllI){return iil1iI===IlIllI;},'bbGln':li1i1i(0x1cc,'0j1b'),'RpTev':li1i1i(0x29d,'@mNS'),'OzZBW':'getActivityInfo','pZmBo':function(il1i1I,lI1li1){return il1i1I===lI1li1;},'foBXW':li1i1i(0x1c7,'1lT5'),'wMzZg':li1i1i(0x1f3,'thKB'),'RBWgx':function(iI11II,iIII1I){return iI11II===iIII1I;},'HznVC':'ViETO','QdTvd':function(ilil1i,IlIIi){return ilil1i===IlIIi;},'HZAjf':'ozqdb','PoEZr':li1i1i(0x1b6,'dEQ2'),'CAAAK':'UZXBh'};try{if(iIli1l[li1i1i(0x209,'sOPv')]!==iIli1l[li1i1i(0x19d,'hUV4')])switch(iI1lil){case iIli1l[li1i1i(0x22e,'0hlS')]:if(iIli1l['pZmBo'](l1lIi1[li1i1i(0x28f,'tF@(')],0xc8)&&iIli1l[li1i1i(0x28e,'wss%')](l1lIi1[li1i1i(0x1ca,'Z5VR')],!![])&&l1lIi1['data'])iIli1l[li1i1i(0x21d,'J7&h')]!==iIli1l['wMzZg']?$['getActivityInfo']=l1lIi1['data']:(lIIiii[li1i1i(0x291,'Gsqc')]=iI1lli,iIli1l[li1i1i(0x25c,'K7X[')](ll1iI,0x193)&&I1l1II[li1i1i(0x293,'0!^b')](IIli1I));else l1lIi1['msg']?iIli1l[li1i1i(0x22a,'9)#k')](li1i1i(0x212,'juku'),iIli1l['HznVC'])?(iIli1l[li1i1i(0x1d7,'IJcL')](l1lIi1['code'],0x192)?iIli1l[li1i1i(0x253,'d%4P')]!==iIli1l[li1i1i(0x1a3,']7LL')]?I1l1I1[li1i1i(0x246,'dEQ2')](I1i111):console[li1i1i(0x251,'G$pj')]($['token']+'\x20活动已经结束了'):console['log']($[li1i1i(0x278,'Yjug')]+'\x20活动信息获取失败'),$[li1i1i(0x1c9,'uvCf')]=!![]):(iillll['log']('❓'+lIIilI+'\x20'+II1li1[li1i1i(0x1f4,'uvCf')](l1lIlI)),IiiIl1[li1i1i(0x1f7,'891I')]=!![]):iIli1l[li1i1i(0x1ac,'Yjug')]!==iIli1l[li1i1i(0x1c8,'K7X[')]?(console[li1i1i(0x1cf,'mmOQ')]('❓'+iI1lil+'\x20'+JSON[li1i1i(0x1dc,'sOPv')](l1lIi1)),$[li1i1i(0x23d,'G1]X')]=!![]):Iliiii['log'](i1illI);break;}else iIli1l[li1i1i(0x25f,'sOPv')](IIII11[li1i1i(0x26c,'Gsqc')],0x192)?l1i111[li1i1i(0x19b,'thKB')](iliII1[li1i1i(0x278,'Yjug')]+li1i1i(0x271,'@mNS')):II11I1[li1i1i(0x293,'0!^b')](Iii11I[li1i1i(0x1d2,'0j1b')]+li1i1i(0x282,'tF@(')),lilIll[li1i1i(0x241,'d%4P')]=!![];}catch(lil11l){console[li1i1i(0x1d5,'9)#k')](li1i1i(0x245,'$27]')+iI1lil+'\x20请求响应\x20'+(lil11l[li1i1i(0x22c,'mmOQ')]||lil11l));}}async function sendRequest(i1i1Il){const IlIli1=lillIl,I1lIl1={'MIyGV':IlIli1(0x2a3,'KqKh'),'QQGtW':IlIli1(0x22f,'1lT5'),'zUBEX':IlIli1(0x1ee,'%MFV'),'HLjUa':'interact_center_shopSign_getActivityInfo','rNZxT':'interCenter_shopSign','fQQqO':function(IlIll1,IlIII){return IlIll1(IlIII);},'nLBPW':IlIli1(0x1ae,'CWWP'),'eMrqN':'https://api.m.jd.com/api','JovEZ':IlIli1(0x22b,'Ldh('),'KYLMA':function(ilil1l,illlIi){return ilil1l!==illlIi;},'OsaGj':IlIli1(0x294,'sOPv'),'dgvTR':'Moxhl','RUmsX':IlIli1(0x1b8,'v!UV'),'dWYFi':IlIli1(0x28b,'0n%!'),'aPsus':IlIli1(0x279,'uvCf'),'DtVZE':'text/plain','pShTW':IlIli1(0x28a,'2J1P'),'cJonB':'https://h5.m.jd.com/','awhlW':IlIli1(0x25b,'0!^b'),'eyeWc':'same-origin','oQQxt':function(I1lIii,IiI1I){return I1lIii===IiI1I;},'xcEfC':IlIli1(0x276,'hUV4'),'zJejA':IlIli1(0x243,'1lT5'),'pmDcH':function(illlIl,i11ill){return illlIl<i11ill;},'ekbsk':IlIli1(0x25d,'juku'),'WtpAu':'nizCr','pwbHI':IlIli1(0x1c0,'%MFV'),'okGiP':function(IIIIIi,IIIIIl,I1lIil){return IIIIIi(IIIIIl,I1lIil);},'dBkba':function(IIIl1i,liiII1){return IIIl1i===liiII1;},'fxxzG':IlIli1(0x1a8,'FL94'),'KBSWO':function(IIIl1l,lllll){return IIIl1l!==lllll;}};if($[IlIli1(0x1c3,'nPy(')])return;let lil11i='',IlIIl=null,lI1liI=null,i1i1Ii=IlIli1(0x213,'IJcL'),lllii={},iI11Ii={};switch(i1i1Il){case I1lIl1[IlIli1(0x295,'9)#k')]:iI11Ii={'appId':I1lIl1[IlIli1(0x1c1,'KqKh')],'functionId':I1lIl1['HLjUa'],'appid':I1lIl1[IlIli1(0x195,'glN[')],'body':{'token':$[IlIli1(0x1c6,'hUV4')],'venderId':I1lIl1[IlIli1(0x1cd,'jH&O')](parseInt,$[IlIli1(0x1e1,'d5s0')])||''},'version':I1lIl1[IlIli1(0x277,'G1]X')],'ua':$['UA']},lllii=await H5st['getH5st'](iI11Ii),lil11i=I1lIl1[IlIli1(0x281,'891I')],lI1liI=Object['assign']({},lllii['paramsData'],{'jsonp':I1lIl1[IlIli1(0x1f1,'KqKh')]});break;default:console[IlIli1(0x252,'891I')](IlIli1(0x1e6,'IJcL')+i1i1Il);return;}const iIII1l={'t':Math[IlIli1(0x218,'1lT5')](Date['now']()/0x3e8)+IlIli1(0x264,'G1]X'),'loginType':'2','x-api-eid-token':$[IlIli1(0x20c,'J7&h')]};IlIIl&&(I1lIl1[IlIli1(0x19c,'P1nt')](I1lIl1['OsaGj'],I1lIl1[IlIli1(0x1df,'mmOQ')])?Object[IlIli1(0x1d8,'0!^b')](IlIIl,iIII1l):i1II1[IlIli1(0x229,'CWWP')](iIIl11[IlIli1(0x272,'0n%!')]+'\x20活动信息获取失败'));lI1liI&&Object[IlIli1(0x28c,'fj29')](lI1liI,iIII1l);const lllil={'url':lil11i,'method':i1i1Ii,'headers':{'Accept':I1lIl1['RUmsX'],'Accept-Encoding':I1lIl1[IlIli1(0x215,'J7&h')],'Accept-Language':I1lIl1[IlIli1(0x287,'0!^b')],'Connection':IlIli1(0x28d,'d%4P'),'Content-Type':I1lIl1['DtVZE'],'Host':I1lIl1['pShTW'],'Referer':I1lIl1['cJonB'],'Sec-Fetch-Dest':IlIli1(0x1e7,'juku'),'Sec-Fetch-Mode':I1lIl1['awhlW'],'Sec-Fetch-Site':I1lIl1[IlIli1(0x1d9,'1lT5')],'User-Agent':$['UA']},'params':lI1liI,'data':IlIIl,'timeout':0x7530,'httpsTlsOptions':common['useAppTls']()};I1lIl1[IlIli1(0x260,'2J1P')](i1i1Ii,IlIli1(0x27e,'J7&h'))&&(IlIli1(0x221,'Ldh(')!==I1lIl1[IlIli1(0x20d,'glN[')]?I1iIli['log'](lI1Ill['token']+IlIli1(0x250,'][WI')):(delete lllil[IlIli1(0x258,'$27]')],delete lllil[IlIli1(0x1de,']7LL')][I1lIl1['zJejA']]));const iI11Il=0x1;let iIII1i=0x0,iil1i1=null,il1i11=null;while(I1lIl1[IlIli1(0x1b7,'J7&h')](iIII1i,iI11Il)){if(I1lIl1[IlIli1(0x242,'G1]X')](I1lIl1['ekbsk'],IlIli1(0x249,'&lo)'))){if(iIII1i>0x0){if(I1lIl1['KYLMA'](I1lIl1[IlIli1(0x23c,'0j1b')],I1lIl1['pwbHI']))await $[IlIli1(0x222,'*Qeb')](0x7d0);else{i1III['log'](IlIli1(0x228,'Yjug'));for(const ill11i of Ii1iIl){ill11I['log'](ill11i);}}}const lllli=await common[IlIli1(0x26b,'glN[')](lllil);if(!lllli[IlIli1(0x1e9,'glN[')]){il1i11=lllli[IlIli1(0x27d,'Yjug')],$[IlIli1(0x247,'@mNS')]=$[IlIli1(0x1ff,'9)#k')]+'：'+il1i11+IlIli1(0x1e2,'&lo)'),iil1i1=IlIli1(0x20b,'K7X[')+i1i1Il+IlIli1(0x205,'juku')+lllli[IlIli1(0x1c5,'nPy(')],iIII1i++;continue;}if(!lllli[IlIli1(0x284,'891I')]){iil1i1=IlIli1(0x199,'r3$B')+i1i1Il+IlIli1(0x204,'mmOQ'),iIII1i++;continue;}await I1lIl1['okGiP'](handleResponse,i1i1Il,lllli[IlIli1(0x196,'P1nt')]),ipBlack=![];break;}else{iIIIII['log'](I1lIl1[IlIli1(0x283,'hUV4')]);return;}}iIII1i>=iI11Il&&(I1lIl1['dBkba'](I1lIl1[IlIli1(0x21e,'d5s0')],I1lIl1[IlIli1(0x1d1,'1lT5')])?($['errMsg']=iil1i1,I1lIl1[IlIli1(0x200,'1lT5')](il1i11,0x193)&&console[IlIli1(0x21b,'r3$B')](iil1i1)):lIIiil['assign'](l1lIii,I11iI1));}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
