/*
活动名称：批量店铺签到（活动查询）
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割

查询活动信息主脚本，IP限制严重建议使用代理，请勿频繁运行
自动去重并过滤无效活动，默认过滤垃圾奖品活动
运行后会在本地目录生成缓存文件以用于签到脚本使用

cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到（活动查询）')
var iｉl='jsjiami.com.v7';function Iii11l(){const llI1Ii=(function(){return[iｉl,'IjsnjJiamrRi.wLcDKoJSmRk.bvq7BnNIJxQpPbD==','DmoQkgpcTCkutYG','Et/cIa','WPpcU8kfmstcRq','WQpcTmouW5NdIW','oSkSw8k3','WQtdPhOttcC','BqXcBCk9','WOXegmojW6q','WRurvSoAW5GxW7W','ehz5A8ktWQGBwq','57+U5A6N5ywI5yE75A+R5QY4776a5OIt5z2l55U/5BYH776O','W5pcGSkcwxVcISoea8kPqa','uCkXbKhcNq','o1pcIa','D+E5JoAFQE+8JUs6KEATNUAxOoEcMUACGowtIY4t','WRhcRKTQdaZcSW','sSkagNm3W6/dG8oP','W48mWRabWO8','W6rnWO7cOCox','WQ7cQLK','WPJcVCkEW6yk','FYn7WR8','BYDMWORdGLVcICkipmkAd8k4W5jDW68','FhZcVmkUWPi','hCoOi8kTBs4lWPFcKse','jWBcLHZdPmkAxIuriSoh','5O+S56EF57QN5P2iB8kGWRFcSmoUCvCdhSk0','qvRdTmknbq','WPCXFexdGCkJfSkN','WQqrtmo2WOGwW4f8','WQhcQLPb','WR4rvmo3WOe','Ah3cKmkNWO/dOCkZmai7W60','rCk3mxqi','W74BWQeZWRpcGLe','WPrEWOldLW','BNVcKmkDWPhdP8k3bYOY','pSk8w8kR','zsT8WOFdHfNcHCks','ASolouxdRq','W5uxW5ZdPgy','WQCmDxhdJW','AtfHWQldHKe','WQ4xzKRdGW','WRPboq','WQVcHSkxW7hdGHzCDSoteK/dJ8oWbgBcQbxdSSkA','5RsM5yIS5Bgn5zYNW6a','pEA2V+wlO+s/RUAcR+InH+wpVowLQUI3Gq','WR7cOuipjq','W7aHW7i','W5a2W4BcM8oR','BYtcOGe8W6q','W5K+WOGRWRC','CcJcTW','WQnljmos','5ywI57UN5yYi','W7FcK8kwvaa','i0hcNCktWPCrW5NdKSo9','WRWYC8o/WQu','u8oSnuy','ggddTmoRhNmseIC','WPpcOCkF','W5pcIJz7iCoqWQddILVdGq','BKRcHYK','WPFcOCkbpq','WOG6zKtdLSksoSkTWP1AW6FdRCkObmkPjZmZWOry','4PI8BUITOUwgPEwTGos5L+w/UoIMVEEyGUEpRowHMownOUMgQUwqIUwhMEI/SEIILUIfRoAFQE+9OG','W4DwWOS','W4X0rW','5RAq5yQr5BsE57Mf5P2yWPm','tqnCrCkj','CCoRla','5BUI6zcw5zkL56wi77+6ia','kcZcOd4PW5Ou','WPhcKmkC','os7dKaf3','k8o0uNVcL8oJW4NdUmoB','WQ7NUORMN7lMLiJPLBhVVRa','W4nnWPJdPNtcO0NcNYRdTCotW5FcRmopW4RdJ8kCqmomaW','gs3cPGtcRmkOAXG','yCk1avZcGCoh','WQL3m8oBWOhdSqPBxvZcNCkwz8koCSo/ma','vEISM+AzNoApMSkPu+AiQUs8J+EuVUs5QoEsMa','WPaYfSoYWQpdImkRW4mkuSkNW45g','5yYl6ywJ6k2a5PMhoxZcMLBdImoeWQngFmkD','WOOlkmoSWO4','EcBcQrS','WO/cU8kgfI/cUW','d8kbWOjPkG'].concat((function(){return['WQNORk/MS6tLKkVLUApcLG','WQlcM8ozW5hdQuLv','yZxcGvjFp8ojaG','bCoIemoT','g0lcR8k1WOa','W7/dGCopW4BdPvzvmCkSp0ZdHmoVteJdV0hcN8omW7RcR3lcNa','W5tdU3eZCq','W7CAWQi','W7xcRby','gCoYemkvqG','WOa3zKJdKSk4k8k6WRPlW7tdHSkUhW','CclcVG84W7G','W74DFCkkW4JcHCoIW7aqW6pcGmoM','ovZcIfGg','W57cJcX1i8or','WQVcQ0PbhWdcTCo+kw3dLSkzeLtcNu9CW5v9Eq','5B6V5Asd5PwS6zsX77YW','W6Tce8kHW59CWRX5sSoTW4lcIwq','ruVdPSkmdq','W7K3W73dI1vI','W4LHWPJcPG','W5aPWRldHMu','AZxcUrWPW5yLWOddPLZcGI7cSW','pow9H+wKM++9PoAyLUEaQEwhGEAEIEwsPhhdSq','W4ldPxCMzSoMWPzjBG','W4GeWQBdS2u','W6GHW77cImk0','vgFdLCkgkG','BdlcOWa','baZdLbb/','WQ8vwfFdLq','yWfHDCk8','WQ5boCo9WP3dHCoAW7yGW73cT8ogxeZcUG','W5LCWP3dO2ldQHi','W4ZcUSkfWQ9rAvyHh8kGwJmR','imkfuCkrW5a','WOngWPBdI8o/btnkemkRFvG8gZFdGG','tIFcT8oRkNy','W58HW7VcMCk/CeKrW5i6WQVdNW','FhtcJvaSnHe3FCkfW6tdLCoZ','cCoBhCkntq','vmo7AL3cV3b9sIqB','WQnkWQddQmkG','p3SIW73cLXVcSCkodmkeomky','W6xcVCoiWOhcG8oE','oSoLbmkTxa','x8o5geNdQW','W74hWRCQWQNcIa','bmoTeG','WOCSxNldRa','xmoZgJVcO19FAG','i8o5wbZcKCoyW5tdT8oFEa','W7NcPtHSsdldTG8OW5C','8lEkRaa','W5HKwNpdNCksgSkv','W7qRW6K','tbpcLaOE','D+A2PowiNUs/O+AdTEIpIowpN+wKKUI1Ga','WQNcJM48kq','5Q+D5PsK56YE5yIy','4P+JW6JMNRdNNkdOR53MSkddJq','D1hcGIaVx8ozcSkCFG','W5tcGc5MmSol','y8o2eNVdNa','bSkSpb3cS3jVwtmmW5ZdPmkBWPJcU8oaWODgt8kPW4G','tmk+W43dMSkfB08','W6nAWPtcPCoY','WRtdICoAheu','ESoHp07cO8keqY3cJCkcf0hdIYe5','WPNcNSkpW78','lmk1FJ/dSCogxX3cSCkDifi','5Q2u5PAq56675yMx','WQxcOePLdHxcV8o8egVdHSkQgwhcMq','W4ddGSogWQnAW5dcSw5Ela','WR4rtmo1WPKm','i8kWWOXep8kUE0NdId9/W64HwCoS','pJhdLW1T','WOhdMxqKl8oCWPhdO2xdVa','vGzdF8kw','W5qxW5lcISk/','WR3dG8od','oL3cNW','zc11','W7GxoCoWWQNdT8o2W6S','WP3dPw0dz8oAWO5Ervq/Fv3dRmoHb8k2W7lcUKK','WQWsEwldPq','W4DCWOldSxpdSq','fSkRprNcLh13wq','f8k/W57dJCkn','voIUU+AYNowLUEI3Rmo+4P6sva','W5BcIdTH'].concat((function(){return['vYbJq8kHWPWxvG','W6xcT8ob','W57dUhK','s8oXjW','WPpdICoo','fvZcRe0fW4G','WO07Dq','WP3dQCovW7GgiXe','5yw1towpNq','rmkjiulcSq','WOTokSoHW5C','pGpdOs91','WO3cISkiW7y','ymoVb23dKa','s8oSjX3cS3bPeZeBW5FdU8ksWRNcKCoK','cSoUoCkGFJu2WOO','W4iWW4pcN8oPW4yH','5lQ25lQQ54Uz5Qor5B+v6zsh6k+s','W6mOW6RcSmon','4P+fW7JOHRZMN4ROVkFOO7RPGRNLI7lKUl/PLOhORkHj','W4rPrmksW7/cLCo3','rmouoMRcTW','W7WqWReMWRNcM13cH8oauCkLlSoEW64d','iSkMtW','wMBdMW','W5fYu8kU','BGhdImoGWPatW5ZdQ8oLEW','qXtcQfv+','dvBcQu8FWP0','W511WPlcVq','gcpcUq','WQ/cOe1xdaBcSW','j8oTW594W78','W7GuWReeWRi','s8oyeuhdLq','W5vUtCkJ','qmo7ngldU8kXsfldM8oJB8ofC8oeBa','WPNcR8kria','WQlcJ8oxW5FcOvvuD8kzm0a','5l2v5OkH5yQd','W7RcSav1mG','W4RdISojWQ1qW5VcUrKMudFdQ8oR','WOFNUltMNQxVVkhKUz/MR5VMLyhNG5VMNQxLKiNcJmkO','WP/dO8oDW7i','EmkUcuy','WPaNA3VdPq','WQr+dSoeW4BcTaa','aSoSamoP','W7i3W5RdJvLPga','ymkRWOzRW4KurvKH','gCkdW48','WP5EWPBdGq','W5FcKSkjrq','hcpdJYj+','W7i3W6hdJei9rNCJ','W6ZcTSoq','yMddSmkfda','WQyBsCo3WOm','CLdcKW','W6ddJM82EG','cCkSnq','tsPQySk2WPW','W4HPq8kQW6pcNmo3W4i','WQNcRvSCmG','77+n5BwK5y+z5A+s','4PY5W4ZNROq','W686W7tcN8kUsLrrW6m','hoISKUAWTUwKPUI1T8k94PYwWQ3MLlpLKOhLU77MLy7MJy0','WPRcMSkpW58eWPNdPsukzq3dU8ocASoM','5P+J55+b5AsB5zg977+2','o8oWW5e','W4D1t8kRW5pcLSoMW4moEmky','pdBdLSoAW5BcOmoZ','W7ijWQBdJL0','WRldNmoDz2LVW40pW5VcMSoXfG','W41OrW','WOOXD1hcICkWm8kQWP9A','WOLpWOpdM8kM','bmkrEmk2W7e','WPtdL8omgYZcN8oTmSk3DW','e8o2cmoPWQa','5RAw5yQO5Bst5lMBWPe','W4HUWPxcP8oyWRFdOq','WQ7cOfbdgqK','phdcU8k7WPa','4P++W4NMNAJOG6/MRltNO5FLP5dNKRuY','W7aHW6/dHLD+bq','WO52WOC'];}()));}()));}());Iii11l=function(){return llI1Ii;};return Iii11l();};function iii1II(_0xb75bda,_0x13a86b){const _0x4d95cc=Iii11l();return iii1II=function(_0x5e5e40,_0x280822){_0x5e5e40=_0x5e5e40-0xf4;let _0x51e174=_0x4d95cc[_0x5e5e40];if(iii1II['LUkCyg']===undefined){var _0x5582a5=function(_0x1e1336){const _0x58b74a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x490b4c='',_0x3dafdd='';for(let _0x43601c=0x0,_0x3b96ea,_0x220dfd,_0x56d5fc=0x0;_0x220dfd=_0x1e1336['charAt'](_0x56d5fc++);~_0x220dfd&&(_0x3b96ea=_0x43601c%0x4?_0x3b96ea*0x40+_0x220dfd:_0x220dfd,_0x43601c++%0x4)?_0x490b4c+=String['fromCharCode'](0xff&_0x3b96ea>>(-0x2*_0x43601c&0x6)):0x0){_0x220dfd=_0x58b74a['indexOf'](_0x220dfd);}for(let _0x38f069=0x0,_0x530edc=_0x490b4c['length'];_0x38f069<_0x530edc;_0x38f069++){_0x3dafdd+='%'+('00'+_0x490b4c['charCodeAt'](_0x38f069)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3dafdd);};const _0x51ced6=function(_0x118d03,_0x3786b5){let _0x4dbe5b=[],_0x33f948=0x0,_0x3e8499,_0x5ebfe2='';_0x118d03=_0x5582a5(_0x118d03);let _0x4dcced;for(_0x4dcced=0x0;_0x4dcced<0x100;_0x4dcced++){_0x4dbe5b[_0x4dcced]=_0x4dcced;}for(_0x4dcced=0x0;_0x4dcced<0x100;_0x4dcced++){_0x33f948=(_0x33f948+_0x4dbe5b[_0x4dcced]+_0x3786b5['charCodeAt'](_0x4dcced%_0x3786b5['length']))%0x100,_0x3e8499=_0x4dbe5b[_0x4dcced],_0x4dbe5b[_0x4dcced]=_0x4dbe5b[_0x33f948],_0x4dbe5b[_0x33f948]=_0x3e8499;}_0x4dcced=0x0,_0x33f948=0x0;for(let _0xe9ffb7=0x0;_0xe9ffb7<_0x118d03['length'];_0xe9ffb7++){_0x4dcced=(_0x4dcced+0x1)%0x100,_0x33f948=(_0x33f948+_0x4dbe5b[_0x4dcced])%0x100,_0x3e8499=_0x4dbe5b[_0x4dcced],_0x4dbe5b[_0x4dcced]=_0x4dbe5b[_0x33f948],_0x4dbe5b[_0x33f948]=_0x3e8499,_0x5ebfe2+=String['fromCharCode'](_0x118d03['charCodeAt'](_0xe9ffb7)^_0x4dbe5b[(_0x4dbe5b[_0x4dcced]+_0x4dbe5b[_0x33f948])%0x100]);}return _0x5ebfe2;};iii1II['gtQzRA']=_0x51ced6,_0xb75bda=arguments,iii1II['LUkCyg']=!![];}const _0x1a5a99=_0x4d95cc[0x0],_0xcdb4cb=_0x5e5e40+_0x1a5a99,_0x56fa32=_0xb75bda[_0xcdb4cb];return!_0x56fa32?(iii1II['xPIAvl']===undefined&&(iii1II['xPIAvl']=!![]),_0x51e174=iii1II['gtQzRA'](_0x51e174,_0x280822),_0xb75bda[_0xcdb4cb]=_0x51e174):_0x51e174=_0x56fa32,_0x51e174;},iii1II(_0xb75bda,_0x13a86b);}const i11iil=iii1II;if(function(lllilI,ilil11,illlI1,IIIl11,I1lIi1,liiIIi,lil11I){return lllilI=lllilI>>0x1,liiIIi='hs',lil11I='hs',function(Iliii1,iIiIi,iil1ll,iiilil,iil1li){const ii1iii=iii1II;iiilil='tfi',liiIIi=iiilil+liiIIi,iil1li='up',lil11I+=iil1li,liiIIi=iil1ll(liiIIi),lil11I=iil1ll(lil11I),iil1ll=0x0;const lillIl=Iliii1();while(!![]&&--IIIl11+iIiIi){try{iiilil=-parseInt(ii1iii(0x13f,'vaRE'))/0x1*(-parseInt(ii1iii(0xff,'vaRE'))/0x2)+parseInt(ii1iii(0x133,'@Eq&'))/0x3*(-parseInt(ii1iii(0xfc,'1AOU'))/0x4)+-parseInt(ii1iii(0x190,'leZ&'))/0x5+parseInt(ii1iii(0x1b6,'&Lfs'))/0x6*(-parseInt(ii1iii(0x140,'t2u%'))/0x7)+parseInt(ii1iii(0x137,'m13R'))/0x8*(parseInt(ii1iii(0x142,'$iS9'))/0x9)+-parseInt(ii1iii(0x1fb,'xMiT'))/0xa*(-parseInt(ii1iii(0x152,']Sg#'))/0xb)+-parseInt(ii1iii(0x12e,'*M]w'))/0xc*(-parseInt(ii1iii(0x15f,'w[BH'))/0xd);}catch(iIiIl){iiilil=iil1ll;}finally{iil1li=lillIl[liiIIi]();if(lllilI<=IIIl11)iil1ll?I1lIi1?iiilil=iil1li:I1lIi1=iil1li:iil1ll=iil1li;else{if(iil1ll==I1lIi1['replace'](/[DBbRPrQpIxnqNKLkSJw=]/g,'')){if(iiilil===iIiIi){lillIl['un'+liiIIi](iil1li);break;}lillIl[lil11I](iil1li);}}}}}(illlI1,ilil11,function(iiilii,li1i1i,IlIli1,illIiI,lI1lli,Ill1l,llI1Il){return li1i1i='\x73\x70\x6c\x69\x74',iiilii=arguments[0x0],iiilii=iiilii[li1i1i](''),IlIli1='\x72\x65\x76\x65\x72\x73\x65',iiilii=iiilii[IlIli1]('\x76'),illIiI='\x6a\x6f\x69\x6e',(0x15fb3f,iiilii[illIiI](''));});}(0x186,0xca10f,Iii11l,0xc5),Iii11l){}const common=require(i11iil(0x111,']G[U')),{H5st,jsTk}=require(i11iil(0x175,'Q3)^'));console[i11iil(0x17f,'sqvp')](''),console[i11iil(0x1a3,'Q3)^')]('=========='+$['name']+i11iil(0x107,'8V5V')),console['log']('jd_dpqd_tokens\x20//\x20活动ID，多个用英文逗号分割'),console[i11iil(0x15e,'m13R')](i11iil(0x155,'leZ&')+$[i11iil(0x1e2,'rfgn')]+i11iil(0x1d9,'S@01')),console[i11iil(0xfd,'leZ&')]('');let tokensList=(process[i11iil(0x13c,'r@cn')]['jd_dpqd_tokens']||'')['split'](/[,@&|\n]+/g)[i11iil(0x14a,'RAk[')](Boolean);const printEnvValue=process[i11iil(0x19e,'rsEO')]['jd_dpqd_print_env']===i11iil(0x1fa,'AhqY');let TokensMap=new Map();const CacheFile=__dirname+i11iil(0x160,'Ss!W');!(async()=>{const Ill1i=i11iil,IiilI={'OCtkg':function(ii1I11){return ii1I11();}};await IiilI[Ill1i(0x1ea,'$iS9')](Main);})()[i11iil(0x188,'97c#')](liIi1=>$[i11iil(0x1a4,'kw]Q')](liIi1))[i11iil(0x177,'kKSL')](()=>$['done']());async function Main(){const ii1iil=i11iil,lI11II={'bSvum':ii1iil(0x132,'@KDd'),'rZnkG':function(l1llI1,llIIll){return l1llI1>llIIll;},'QDLRM':ii1iil(0x14d,'gB60'),'MFkCA':function(IillIi,lii,IllI1i,i11I1l){return IillIi(lii,IllI1i,i11I1l);},'BBErt':'https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html','kILou':ii1iil(0x1af,'R)!Z'),'PtlyT':function(lil,IllI1l){return lil!==IllI1l;},'PopvW':ii1iil(0x1e6,'AhqY'),'NAJvq':ii1iil(0x15a,'kw]Q'),'xgXjs':function(i11I1i,IillIl){return i11I1i+IillIl;},'dIAfM':function(llliil,liIl1){return llliil===liIl1;},'EDzfk':function(II1lll,II1lli){return II1lll!==II1lli;},'sqZaG':ii1iil(0x1c6,']pOl'),'VHAjE':ii1iil(0x1a2,'Ss!W'),'DLiAz':function(ii1I1I,IiIl){return ii1I1I<IiIl;},'qsyZA':function(IiIi,iI1ll1){return IiIi===iI1ll1;},'HYGge':'psbMF','FQQIQ':function(IlI1Il,l1il1l){return IlI1Il(l1il1l);},'eFNDc':'getActivityInfo','STWbV':'yyyy-MM-dd\x20HH:mm','jBCiw':ii1iil(0x18e,'@Eq&'),'JbIJd':function(liIil,IllI1I){return liIil/IllI1I;},'FnSiG':ii1iil(0x1a7,'t2u%'),'mlkHu':function(liIii,II1ll1){return liIii>II1ll1;},'BKMLm':function(IlI1Ii,i11I1I){return IlI1Ii<i11I1I;},'jCyqS':ii1iil(0x1cb,'vaRE'),'sBZKl':ii1iil(0x119,'@xET'),'BDlRx':ii1iil(0xf8,'1vG*'),'IMotf':ii1iil(0x110,'a&TB'),'lkYZv':function(l1il1i,ll1){return l1il1i>ll1;},'NZupC':function(iI1llI,llliii){return iI1llI-llliii;},'FXgPk':function(IllI11,l1llIi){return IllI11>l1llIi;},'PEnUL':'vUTYe','VDGcD':'Zqatj','KTzlv':ii1iil(0x134,'c0Yo'),'mYMRR':ii1iil(0x171,']pOl'),'eBexm':function(II1llI,i11I11){return II1llI(i11I11);}};try{if(lI11II[ii1iil(0x1c2,']G[U')](tokensList[ii1iil(0x1ba,'%DRb')],0x0))tokensList=[...new Set(tokensList['filter'](llI=>llI!==''))];if(tokensList[ii1iil(0x117,'1AOU')]<=0x0){console[ii1iil(0x168,'rsEO')](ii1iil(0xf5,'@KDd'));return;}const l1llIl=[];console['log'](''),$['UA']=common[ii1iil(0x14f,'8V5V')](lI11II[ii1iil(0x1b0,'dW!8')]),{jsToken:$[ii1iil(0x197,'%4$d')]}=await lI11II[ii1iil(0x161,'$iS9')](jsTk,$['UA'],lI11II[ii1iil(0x146,'n8!Q')],{'bizId':ii1iil(0x1d8,'kUGO'),'v':lI11II[ii1iil(0x125,'dW!8')],'qs':ii1iil(0x16c,'@xET')+tokensList[0x0]});for(let [llliI,iI1li1]of tokensList[ii1iil(0x1b9,'s8G)')]()){if(lI11II[ii1iil(0x1f7,'&Lfs')](lI11II['PopvW'],lI11II[ii1iil(0x12a,'$iS9')])){let lllii1=!![];const liIli=lI11II[ii1iil(0x13a,'AhqY')](llliI,0x1);iI1li1[ii1iil(0x1bf,']Sg#')](':')&&lI11II['dIAfM'](iI1li1[ii1iil(0x158,'@Eq&')](':')[ii1iil(0x156,'MfBA')],0x3)&&(iI1li1=iI1li1[ii1iil(0x1b4,'rfgn')](':')[0x0]);if(iI1li1[ii1iil(0x162,'1vG*')]!==0x20||!/^[A-Z0-9]*$/[ii1iil(0x1c3,'^60k')](iI1li1)){if(lI11II['EDzfk'](lI11II['sqZaG'],lI11II[ii1iil(0x170,'vaRE')])){console[ii1iil(0x185,'kUGO')](ii1iil(0x1a8,'gB60')+liIli+ii1iil(0x178,'@KDd'));continue;}else IIli11[ii1iil(0x1c0,'3789')](IllIII);}$[ii1iil(0x1a0,'MfBA')]=iI1li1,TokensMap['set'](iI1li1,{'index':null,'venderId':'','shopName':'','activityId':'','startTime':'','endTime':'','isValid':!![],'rules':[],'minLevel':null,'maxLevel':null});let liIll=0x0;$[ii1iil(0x157,'Dy3A')]='',$['invalidAct']=![];const IilIi1=0x1;while(!$[ii1iil(0x17d,'97c#')]&&lI11II['DLiAz'](liIll,IilIi1)&&!$['invalidAct']){lI11II[ii1iil(0x194,'$iS9')](lI11II[ii1iil(0x15b,'@KDd')],lI11II[ii1iil(0x18f,'RAk[')])?($[ii1iil(0x18b,'AhqY')]='',await lI11II['FQQIQ'](sendRequest,lI11II['eFNDc']),await $['wait'](0x3e8),liIll++,liIll>IilIi1-0x1&&(console[ii1iil(0x1d2,'%DRb')](''+$['TokenErrorMsg']),$[ii1iil(0x1c4,'t2u%')]='')):(i1ll[ii1iil(0x1a1,'T88t')](ii1iil(0x1b8,'s8G)')+i1l1lI+ii1iil(0x1cd,'iSva')),i1iliI[ii1iil(0x19b,'&Lfs')](I1iIii),IllII1=![]);}if(!$[ii1iil(0x150,']Sg#')])continue;const iI1liI=$['getActivityInfo'][ii1iil(0x1cf,'S@01')],l1lIiI=$[ii1iil(0x1d5,'m13R')]['id'],llliiI=$['getActivityInfo'][ii1iil(0x116,'$iS9')],IilIiI=$[ii1iil(0x1ab,'leZ&')][ii1iil(0x14c,'Q3)^')]||[],i1i1I1=$[ii1iil(0x154,'%DRb')]['prizeRuleList']||[],IlII1=$[ii1iil(0x18b,'AhqY')]['startTime'],IiI11=$['getActivityInfo'][ii1iil(0x17b,'dH5%')],lli=$['time'](ii1iil(0x130,'rfgn'),IlII1),liIlI=$[ii1iil(0x18a,'dH5%')](lI11II['STWbV'],IiI11);let lll=![];const llli1=[],iIli1i=[...i1i1I1,...IilIiI];for(const i1i1II of iIli1i){const liiIIl=i1i1II[ii1iil(0x1de,'MfBA')],iil1iI=i1i1II[ii1iil(0x124,'Ss!W')]||[],IlIllI=[];for(const il1i1I of iil1iI){let lI1li1='';const iI11II=il1i1I['discount'],iIII1I=il1i1I['type'],ilil1i=il1i1I[ii1iil(0x1c1,'qhG0')],IlIIi=il1i1I[ii1iil(0x103,'vaRE')],IiI1l=IlIIi===0x5;switch(iIII1I){case 0x1:lI1li1=lI11II[ii1iil(0x1bb,'a&TB')];break;case 0x4:lI1li1=iI11II+'京豆';break;case 0x6:lI1li1=iI11II+'店铺积分';break;case 0x9:lI1li1=''+il1i1I?.[ii1iil(0x11b,'%DRb')][0x0]?.[ii1iil(0x1ce,'%DRb')];break;case 0xa:lI1li1=iI11II+ii1iil(0x16f,'sqvp');break;case 0xe:lI1li1=lI11II['JbIJd'](iI11II,0x64)+ii1iil(0x1f6,'kw]Q');break;default:lI1li1=ii1iil(0x1ac,'w[BH')+iIII1I+'）';}if(![0x1,0x6][ii1iil(0x1a5,'dH5%')](iIII1I)&&!IiI1l)lll=!![];IlIllI[ii1iil(0x184,'s8G)')](lI1li1+'（共'+ilil1i+'份'+(IiI1l?lI11II[ii1iil(0x139,'c0Yo')]:'')+'）');}llli1[ii1iil(0x1fe,'T88t')]({'days':liiIIl,'prize':IlIllI,'havePrize':lll});}const iI1lii=await common[ii1iil(0x1df,'R)!Z')]({'venderId':iI1liI});console[ii1iil(0x199,'gB60')]('【'+iI1li1+'】\x0a'+(iI1lii&&ii1iil(0xfb,'gB60')+iI1lii+'\x0a')+ii1iil(0x11c,'f$2H')+lli+ii1iil(0x100,'kKSL')+liIlI);lI11II['mlkHu'](llli1['length'],0x0)&&console[ii1iil(0x1b2,'dH5%')](llli1['map'](illlII=>(illlII[ii1iil(0x19a,'rfgn')]===0x0?ii1iil(0x147,'vaRE'):'连续'+(illlII[ii1iil(0x18c,'qhG0')]<0xa?'\x20':'')+illlII[ii1iil(0x109,'1AOU')]+'天')+'：'+illlII['prize'][ii1iil(0x1f5,'w[BH')]('，'))['join']('\x0a'));console[ii1iil(0x143,'%4$d')]('');const IilIii=Date[ii1iil(0x15c,'8V5V')]();IlII1&&lI11II[ii1iil(0x1f3,'97c#')](IilIii,IlII1)&&(lI11II['PtlyT'](lI11II['jCyqS'],ii1iil(0x127,'sqvp'))?(console[ii1iil(0x1f4,'1AOU')](ii1iil(0x1ed,']Sg#')+lli+ii1iil(0x123,'1AOU')),l1llIl[ii1iil(0x1e4,'^60k')](iI1li1),lllii1=![]):(delete I1iIi1['data'],delete lliil1[ii1iil(0x1bd,'%4$d')][lI11II[ii1iil(0x164,'gB60')]]));if(IiI11&&lI11II['rZnkG'](IilIii,IiI11))console[ii1iil(0xfa,']Sg#')]('活动已于\x20'+liIlI+ii1iil(0x191,'&Lfs')),l1llIl['push'](iI1li1),lllii1=![];else llliiI===0x3&&(lI11II[ii1iil(0x172,'@Eq&')]===lI11II[ii1iil(0x11e,'sqvp')]?(console[ii1iil(0x15d,'a&TB')](lI11II[ii1iil(0x12b,'kw]Q')]),l1llIl[ii1iil(0x180,'dH5%')](iI1li1),lllii1=![]):IIII11['activityId']&&i1illi[ii1iil(0x10e,'3789')]&&l1i111[ii1iil(0x128,'1AOU')](iliII1+':'+II11I1[ii1iil(0x1d7,'c0Yo')]+':'+Iii11I['venderId']));!lll&&(lI11II[ii1iil(0x1d1,'s8G)')]!==lI11II[ii1iil(0x129,'@Eq&')]?(i1ili1['log'](''+i1l1l1['TokenErrorMsg']),IlI1I['errMsg']=''):(l1llIl['push'](iI1li1),lllii1=![]));const iI1lil=TokensMap['get'](iI1li1);iI1lil['index']=liIli,iI1lil[ii1iil(0x1db,'$iS9')]=iI1liI,iI1lil[ii1iil(0x163,'Q3)^')]=iI1lii,iI1lil[ii1iil(0x1e3,'R)!Z')]=l1lIiI,iI1lil[ii1iil(0x1a9,'@KDd')]=IlII1,iI1lil[ii1iil(0x1e1,'97c#')]=IiI11,iI1lil['isValid']=lllii1,iI1lil[ii1iil(0x1b7,'r@cn')]=llli1,lI11II[ii1iil(0x108,'Q*h6')](llli1[ii1iil(0x183,'@xET')],0x0)&&(iI1lil['minLevel']=llli1[0x0]['days'],iI1lil['maxLevel']=llli1[lI11II[ii1iil(0x14e,'s8G)')](llli1[ii1iil(0x11a,'RAk[')],0x1)]['days']),TokensMap[ii1iil(0x1eb,'w[BH')](iI1li1,iI1lil);}else i1ilil[ii1iil(0x1e5,'m13R')]=lilIii[0x0][ii1iil(0x166,'RAk[')],i1ill1[ii1iil(0x102,'kUGO')]=iIIl1l[llIli1[ii1iil(0x138,'rsEO')]-0x1]['days'];}if(lI11II[ii1iil(0x1e8,'$iS9')](l1llIl['length'],0x0)){if(lI11II['PEnUL']===lI11II[ii1iil(0x182,'3789')]){iIIIII[ii1iil(0x169,'Ss!W')]('⚠\x20请先定义必要的环境变量后再运行脚本！');return;}else{console['log']('\x0a建议移除的活动：');for(const I1lIl1 of l1llIl){lI11II['EDzfk'](lI11II[ii1iil(0x10b,'Dy3A')],lI11II['mYMRR'])?console[ii1iil(0x1d2,'%DRb')](I1lIl1):IlI11['log'](iIIIIl[ii1iil(0x1cc,'a&TB')](IlIIl=>(IlIIl[ii1iil(0x120,'s8G)')]===0x0?ii1iil(0x153,'97c#'):'连续'+(IlIIl['days']<0xa?'\x20':'')+IlIIl['days']+'天')+'：'+IlIIl[ii1iil(0x187,'iSva')][ii1iil(0x1ff,'qhG0')]('，'))[ii1iil(0x192,'*M]w')]('\x0a'));}}}const ii1I1l=Object[ii1iil(0x1ae,'dH5%')](TokensMap),ii1I1i=lI11II[ii1iil(0x1d3,'leZ&')](require,'fs');ii1I1i[ii1iil(0x122,'1AOU')](CacheFile,JSON['stringify'](ii1I1l,null,0x2)),console[ii1iil(0x113,'97c#')](ii1iil(0x1c9,'leZ&')),console[ii1iil(0x16d,'$iS9')](CacheFile);if(printEnvValue){console[ii1iil(0xf6,'1vG*')]('\x0a环境变量：');let lI1liI=[];for(const [i1i1Ii,lllii]of TokensMap){lllii[ii1iil(0x1fd,'RAk[')]&&lllii[ii1iil(0x176,'c0Yo')]&&lI1liI[ii1iil(0x184,'s8G)')](i1i1Ii+':'+lllii['activityId']+':'+lllii[ii1iil(0x1dc,'MfBA')]);}console['log'](lI1liI[ii1iil(0x193,'vaRE')](','));}}catch(iI11Ii){console['log'](ii1iil(0x17a,'rsEO')+iI11Ii);}}async function handleResponse(iIII1l,lllil){const lllI1l=i11iil,iI11Il={'PTDbR':lllI1l(0x154,'%DRb')};try{switch(iIII1l){case iI11Il[lllI1l(0x144,'1AOU')]:if(lllil[lllI1l(0x196,'r@cn')]===0xc8&&lllil[lllI1l(0x10d,']G[U')]===!![]&&lllil['data'])$[lllI1l(0x12c,'w[BH')]=lllil['data'];else lllil[lllI1l(0xf7,'dH5%')]?(lllil[lllI1l(0x1dd,'%DRb')]===0x192?console[lllI1l(0x169,'Ss!W')]($[lllI1l(0xfe,'@Eq&')]+'\x20活动已经结束了'):console[lllI1l(0x1f0,'@KDd')]($[lllI1l(0x1a0,'MfBA')]+lllI1l(0x1ee,']Sg#')),$[lllI1l(0x149,'T88t')]=!![]):lllI1l(0x115,'c0Yo')===lllI1l(0x1f9,'MfBA')?(lilIil[lllI1l(0x173,'leZ&')](i1l11),i1l1li=![]):(console[lllI1l(0x1b2,'dH5%')]('❓'+iIII1l+'\x20'+JSON['stringify'](lllil)),$['invalidAct']=!![]);break;}}catch(iil1i1){console[lllI1l(0x17e,'^60k')](lllI1l(0x1bc,'RAk[')+iIII1l+lllI1l(0x10c,'rsEO')+(iil1i1[lllI1l(0x186,'%DRb')]||iil1i1));}}async function sendRequest(il1i11){const i11iii=i11iil,IlIll1={'lFQbM':function(IIIl1l,lllll){return IIIl1l===lllll;},'yREcZ':'GET','BapRo':'getActivityInfo','UmiAx':'4da33','YuOZr':i11iii(0xf4,'$iS9'),'JCOXD':function(i11ili,iil1l1){return i11ili/ iil1l1;},'sdXZu':function(lllli,iiili1){return lllli!==iiili1;},'GqGNH':i11iii(0x19c,'@Eq&'),'DhRXD':i11iii(0x104,']pOl'),'DEWtC':i11iii(0x1ec,']G[U'),'igZdW':i11iii(0x1b3,'$iS9'),'nLyRo':i11iii(0x1ca,'&Lfs'),'TiLBm':i11iii(0x1b1,'8V5V'),'JXPuN':i11iii(0x101,'1vG*'),'vnMFG':i11iii(0x1f2,'1AOU'),'YPqew':'no-cors','kOFJI':i11iii(0x18d,']G[U'),'LIOJy':function(ill11i,lllill){return ill11i>lllill;},'vhGti':function(ill11l,I1lIiI,lllili){return ill11l(I1lIiI,lllili);},'MSRFT':function(IliiiI,Ill11){return IliiiI>=Ill11;},'TyufU':function(liiIII,li1i11){return liiIII!==li1i11;},'fxLSH':i11iii(0x1da,'sqvp')};if($[i11iii(0x10a,'qhG0')])return;let IlIII='',ilil1l=null,illlIi=null,I1lIii=IlIll1[i11iii(0x1e0,'S@01')],IiI1I={},illlIl={};switch(il1i11){case IlIll1[i11iii(0x1a6,'n8!Q')]:illlIl={'appId':IlIll1[i11iii(0x1ef,'n8!Q')],'functionId':'interact_center_shopSign_getActivityInfo','appid':IlIll1[i11iii(0x136,'rfgn')],'body':{'token':$['token'],'venderId':parseInt($[i11iii(0x167,'kw]Q')])||''},'version':i11iii(0x16b,'&Lfs'),'ua':$['UA']},IiI1I=await H5st[i11iii(0x1c7,'MfBA')](illlIl),IlIII='https://api.m.jd.com/api',illlIi=Object[i11iii(0x11f,'%4$d')]({},IiI1I['paramsData'],{'jsonp':i11iii(0x19d,'%4$d')});break;default:console[i11iii(0x169,'Ss!W')](i11iii(0x148,'f$2H')+il1i11);return;}const i11ill={'t':Math[i11iii(0x112,'Ss!W')](IlIll1['JCOXD'](Date[i11iii(0x1fc,'qhG0')](),0x3e8))+'000','loginType':'2','x-api-eid-token':$[i11iii(0x195,']pOl')]};ilil1l&&(IlIll1[i11iii(0x121,'dW!8')](IlIll1[i11iii(0x179,'kKSL')],IlIll1[i11iii(0x174,'AhqY')])?(IlIll1[i11iii(0x189,'AhqY')](l1lIl1[i11iii(0x196,'r@cn')],0x192)?Illl1i[i11iii(0x1f0,'@KDd')](lIIiil['token']+'\x20活动已经结束了'):l1lIii[i11iii(0x16a,'AhqY')](I11iI1[i11iii(0x1f1,'kKSL')]+i11iii(0x145,'iSva')),Illl1l['invalidAct']=!![]):Object[i11iii(0x131,'xMiT')](ilil1l,i11ill));illlIi&&Object[i11iii(0x1e9,'m13R')](illlIi,i11ill);const IIIIIi={'url':IlIII,'method':I1lIii,'headers':{'Accept':i11iii(0x1be,'kKSL'),'Accept-Encoding':IlIll1[i11iii(0x14b,'AhqY')],'Accept-Language':IlIll1['DEWtC'],'Connection':IlIll1['igZdW'],'Content-Type':IlIll1[i11iii(0x12f,'^60k')],'Host':IlIll1[i11iii(0x19f,'sqvp')],'Referer':IlIll1[i11iii(0x1b5,'^60k')],'Sec-Fetch-Dest':IlIll1['vnMFG'],'Sec-Fetch-Mode':IlIll1[i11iii(0x17c,']Sg#')],'Sec-Fetch-Site':IlIll1['kOFJI'],'User-Agent':$['UA']},'params':illlIi,'data':ilil1l,'timeout':0x7530,'httpsTlsOptions':common[i11iii(0x1f8,'a&TB')]()};IlIll1[i11iii(0xf9,'kw]Q')](I1lIii,i11iii(0x114,'RAk['))&&(delete IIIIIi[i11iii(0x151,'leZ&')],delete IIIIIi[i11iii(0x16e,'*M]w')]['Content-Type']);const IIIIIl=0x1;let I1lIil=0x0,IIIl1i=null,liiII1=null;while(I1lIil<IIIIIl){IlIll1[i11iii(0x1c5,'kw]Q')](I1lIil,0x0)&&await $[i11iii(0x1d4,'m13R')](0x7d0);const il1i1l=await common[i11iii(0x12d,'1vG*')](IIIIIi);if(!il1i1l['success']){liiII1=il1i1l['status'],$['TokenErrorMsg']=$[i11iii(0x126,'@KDd')]+'：'+liiII1+i11iii(0x105,'gB60'),IIIl1i=i11iii(0x141,'dH5%')+il1i11+i11iii(0x165,'kUGO')+il1i1l['error'],I1lIil++;continue;}if(!il1i1l[i11iii(0x10f,'r@cn')]){IIIl1i='🚫\x20'+il1i11+i11iii(0x1aa,'S@01'),I1lIil++;continue;}await IlIll1['vhGti'](handleResponse,il1i11,il1i1l[i11iii(0x10f,'r@cn')]),ipBlack=![];break;}IlIll1[i11iii(0x1e7,'%4$d')](I1lIil,IIIIIl)&&($[i11iii(0x13b,'97c#')]=IIIl1i,IlIll1[i11iii(0x1d0,'97c#')](liiII1,0x193)&&(IlIll1[i11iii(0x1d6,'R)!Z')](IlIll1[i11iii(0x13d,'$iS9')],IlIll1['fxLSH'])?li1Il[i11iii(0x16d,'$iS9')](li1Ii):console[i11iii(0x1ad,'iSva')](IIIl1i)));}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
