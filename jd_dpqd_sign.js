/*
活动名称：批量店铺签到
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割
        jd_dpqd_task_threads // 控制签到并发线程数（正整数），默认1
        jd_dpqd_account_threads // 控制账号并发线程数（正整数），默认1
        jd_dpqd_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认0
        jd_dpqd_max_retry // 签到火爆时的最大重试次数（整数），默认3
        jd_dpqd_prize_notify // 是否推送中奖信息（true/false），默认不推送

此脚本为高并发签到本，需要读取主脚本生成的活动信息缓存，自动过滤无效活动，签到后如有奖品则自动到账


cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到')
var iｉl='jsjiami.com.v7';const i1ilIl=iii1II;(function(ililII,lI1II1,i1ilII,iIIii1,IllIi1,lilIII,Ii1ilI){return ililII=ililII>>0x7,lilIII='hs',Ii1ilI='hs',function(II11i1,iliIil,iliIii,lill1i,il1li){const i1iiI=iii1II;lill1i='tfi',lilIII=lill1i+lilIII,il1li='up',Ii1ilI+=il1li,lilIII=iliIii(lilIII),Ii1ilI=iliIii(Ii1ilI),iliIii=0x0;const iIIill=II11i1();while(!![]&&--iIIii1+iliIil){try{lill1i=-parseInt(i1iiI(0xd3,'#C(J'))/0x1+-parseInt(i1iiI(0x142,'Jql4'))/0x2*(-parseInt(i1iiI(0x11d,'AzzK'))/0x3)+-parseInt(i1iiI(0x122,'^VLd'))/0x4*(-parseInt(i1iiI(0x152,'^VLd'))/0x5)+parseInt(i1iiI(0x14f,'S][&'))/0x6+parseInt(i1iiI(0xdc,'eSS2'))/0x7+parseInt(i1iiI(0x136,'O6x#'))/0x8*(parseInt(i1iiI(0x14b,'tr[@'))/0x9)+-parseInt(i1iiI(0x6f,'AzzK'))/0xa;}catch(iilii){lill1i=iliIii;}finally{il1li=iIIill[lilIII]();if(ililII<=iIIii1)iliIii?IllIi1?lill1i=il1li:IllIi1=il1li:iliIii=il1li;else{if(iliIii==IllIi1['replace'](/[UERMBPWAKTuXgbJeCIfYQl=]/g,'')){if(lill1i===iliIil){iIIill['un'+lilIII](il1li);break;}iIIill[Ii1ilI](il1li);}}}}}(i1ilII,lI1II1,function(Ill11i,iilil,Ill11l,il1ll,i1ilIi,lill1l,l1l1i1){return iilil='\x73\x70\x6c\x69\x74',Ill11i=arguments[0x0],Ill11i=Ill11i[iilil](''),Ill11l=`\x72\x65\x76\x65\x72\x73\x65`,Ill11i=Ill11i[Ill11l]('\x76'),il1ll=`\x6a\x6f\x69\x6e`,(0x15bd62,Ill11i[il1ll](''));});}(0x6500,0x1cb2e,Iii11l,0xcc),Iii11l)&&(iｉl=`\xd29`);const jdCookie=require(i1ilIl(0x13f,')12W')),notify=require(i1ilIl(0x157,'eejX')),common=require(i1ilIl(0x145,')n#Y')),{H5st}=require(i1ilIl(0x91,'(2pJ'));function Iii11l(){const IIliII=(function(){return[...[iｉl,'JEjWIsjYXliPUafmRiB.McKoRmgQb.IvTQ7CAeIu==','hKSDyCkm','mfaVeSkoWPpdPa','WRWQv8oRbG','oaXqeG','s8kJW61U','WQvTWRtdQSoX','W4n2j15ApmkTWOddVbngWPFdVtuOxSk4rUA0LUwiPCoEEU+8K+wKJUs4P+EwSoIkIoAuLUMdJEwnRowlNUwlQW','WObVrCkcW5r3iSov','W7iAzc85','W4tcNxW','jmoffa','gd3dLXtcLa','dsjNmCoj','j8kzwSkhWPu','rCkaW4bPWQq','W6pdGH7cHWe','nHqCAMq','omofWO06bG','WOSpcSkPBG','W5HApNvU','WONdOgVcQmob','W6fBlNLp','W7nqWPG','W5zJba','WOZcQSkPiNNcSLJcMseWAbhcUW','fmkiqguKW5lcIG','WOjLWPldQ8oF','lCotzhRdVmkx','fMKlu8kQ','WO5lWQxdJCoJ','W7tdJY8','5P+h55+J5AsQ5zoI77Yc','WOGfW4/dSmkJ','gmorWQGkca','WRxdO1BcU8oRw0VcKK8zc8kDkmokaSkqFCobp1y','W4fNbby','W58Yo2HEWOGkuq','W6q+nK7cRHq6','4PQVWPJOHyVLRB/KUk7OV7dOO6RPLQtPM7BML5ZPLPZOR4NNVydPLR/ORju','WRpdQg4','W41pW6Lofq','WO7cNGBcGmkTberpWOVcPWGg','hW7cSb4','W5fhW6nLW5W','xrn2j8ooe2ZcIs3dSq','gCkHCmkEWPq','rSobfG','W69EWO3cOuxdU8obW6hdUmoH','lmolb8kr','WOfPgW','5BUm6zkz56EB5yMX8lU/No+7Ha','g8o/vNOubMaFAmogfuldHrG','W6ZdISku','5l2h5OoB5yME8lA1Ho+7NG','iNOtFCkx','aqtcRXxcQfqjW6/dOa','ef8Uemki','qSkJW6K','6lAV5y2Y5PA65PAkA/cHQlO','WQNINjL656685yM75Awk6lA0772C','wEIUL+AWMUwtN+w6Nmoy','hCo2W6LlWPFdLfBdUa','pmoinCk3W5K','W6BdJmkFW4VcICou','fuGgymkc','WPxcTCkQ','W6pdISkxW5O','WOicrCoNimktW7tdQmknuCkQfCkgW7iiWQfwo8koFJddTZ8eWRlcOSoV5O2x5yMt6lAC5yYv5BUy5yY977+A6BMc6kYxAa','W4HqW6a','W453dhzfkSkGWRhdMWHmWOBdPJu','j8kAgmoqWRe2WRZcPSoDqq','W5VcK3y+o2C9W6JcTSkWW5C','WPOoySoVkG','AqbOv8oDWOxdLLBcR3fy','WOP6WQVdKCoQ','bXJcPW','B8oAqmkCWO5vWQtdMdyZW7uHW6JcUCkSEmkgWQukWQ5gfYa','WOmiW6RdTa','W4TZWRlcQh4','W7zrWOZcPvRdVa','WRRcOmkLm0W','WQzByWdcHq','WRBcV0tcQCodEGn5W6tcSmoLW6C','5lQl5Psq5BEh566w','tSoCbW','WPddIx7cNSoC','CCkzrCohWOJdJSo4WONcTtCDia','EmozW4JcKq','BmozW5xcHG8','WO7dL1ldTmoACNm'],...(function(){return[...['4P6cpUADL+IcGEATOoEIH+wKNUEtP8ko','W5vyWRhcO8obomkVWRpdTmoSamk9','nCoFvwmk','W4W1WORcImkq','v08TzMhcLamUW780tSkUW5/dJ8oAW67dPCotWQnFWO5LW6VcN8o2tN8','W49mW6RdPmkU','lCkqw8kpWPnr','W6HpW5X7hG','gu0rxmkllZ8','iWBdJbpcIq','WPT7WO7dSraaACoXWORdHSo6WR7cT8oosmkNch0a','W485fwBcKG','W67dHmkEW5O','W7hdOaxdN8kvlJe','hCo8WQ0flbfTWRnY','772u8jklTW','W6RdGCkSW5VcNmoxAcVcU8oWW4lcRM3dKCo2lSkTx8otWODTct7cLa','WO9WusZcMq','5ysy57Ub5yYX8kkvTa','zKSoWPik','WR4LkW','W6PpW5DCnq','5yAUq+wmNFcxVOS','zSowW5lcGbvu','s+kFQ8oG56Yf5yUO5Awu6lsC77+x','W6VdKr3cPWK','WOWzW67cV8kBiCkGWPVcNmonnCk7','CmkYW5dcLmkTW5JdOGLkW7lcOmo7W65t','WOnPuubLWRe6','kSoguN7dGCkqWPBdSq','44kp6lsz5yYi','xmk8WQ8OcrnDWRS','omkBx8kYWRq','W68Klg0','wgzvcSoLW4W','caxcPrRcRaa','W6n6W5m','lajDa8ohkSkMfW','WOjjkWzf','W5/cSv8uwW','pCoEfCoDWOm','WRlcKCk0W7tcUmoTtXO','4PIGWOxOHjNLRkxKUQxOVBBOOydPLOdPMy7MLAxPL57ORB/NVBBPLQBORA0','W5GYsbq6W7j5tCkjbSkjgCky','W45Jcqq','W7FdKZ8','WQTBW496mWpdM3qdB8kQWRxdPe42W7FcMa','qmkbuu8cW74','WPlcOMG3ka','W4v9hW','W69EWO3cS00','d38ZbCk7','WONINO5y562e5yIA5Aw86lES77+x','W5BdNLC','W5fEW7TxW6/cP1/cRGm','W7DAW7z0W70','smo9W7u','W7jCWRVcH20','mvO7','5RA75yIn5Bsb57MS5P6Z','WPznWRNdJ8od','5lIU6lon8kosPW','W7XsfHWT','WOicrCoNimktW7tdQmknuCkQfCkgW7iiWQfwo8koFJddTZ8','W4GMwr8u','W4XFW7u','WOdcMfe','WOLDBW','WQD4AGVcTG','AmoAp8oMWR0','W449gSobWRmMg8ogW5hdRGFdKa','fCo0vLWjkM4yECo1bNhdGXu9W7vhWRxcHey','W449mxlcPa','W7ddJSkcW7FcUG','WPzfWO3dSmoUeSkY','sMbfamoNW5hdLq','n8odzg7dPCkiWP/dI8oYW4mymSkoW4GyAwuLW4yG','CrqtW5ldVmk9WQGiymkMWOldRSogxmossG','WP8hC8o3bmklW73dKG','aY8WF38','WPZdHI9JiteyW7JcVSkjW6NcIW','heCk','WQfUfHrq','D2ymWOSG','dCoNWRekkXe','W4xdR8k/W4RcIa','vSkRqvyJ','W6RdJctcRre','W49PgrK','W5JdGLtdKG','W5pdGd/dHCks','WPb0W57dSmosW47dVbNcNZZcLmoo'],...(function(){return['WOxMT6hLIAxLPANNGABNI5e','fSoNASkbEq','W5njW5BdImkP','W4aPWP4','W6xdVCkeW7NcIq','5y+76ywG6k6u5PMtW6f9hhugW4nWW4evWQ8','W6HqW5Hojs4','WOqjFq','W4yOWOZcOG','WRX/EJNdTZ4sgSkVWPBdPG','smkNW61hW6NdGNS','4PIbdoITPEwfPEwSKos6OUw/S+ILNoEBS+EoOowIJ+woUEMfQEwqV+wgVEI8J+IHV+IgMoADHU+/Qq','nSkuxmkCWRnqWRRcKG','W7dcHu0Uva','krBcTJdcQW','ASk1W7xcQmkq','iSkAuCkn','ncVdOJa','s8kWE0aD','u3f5b8oYW5pdGSkpWRFcJuL4WR/dG8kbivO','rCocoaxcLW','W77MTRdLI5JLPRVNGP/NIyu','ps4BqMS','hJ3dLbBcGa','W4TiW41jW7RcMLlcGGnUFWRdUuvyWQ1wW6moWPVcOmoVWPFdM+AoPowlQoESU+wiQ+w5RowmPU++HoM5KEISTNa','eIzdlCoI','tNrpf8owW4VdI8k1','W5ngW4DiW4K','eSoDC8kkAq','W4ldM37dKmoF','CmkxruCH','DSkZW6hcL8kPW4e','W4a1WPRcQmkw','Bmong8ohWOyQWOdcTmoArW','nLusW4pdP8kWWRHtySkXWONdSCopFmoMDXpcJSkvWPG','W5xdPqtcOYW','WP9toxLH','WO18W4q','W7flW5KMBW','W6ZdGmkDW5JcMmoo','WQ/dSNRcTW','WQ4oW4BdHmkc','W4LPfW','mCoixa','E+kFVXtNRiNLIQpLPBlOT65st28','WRakWOS9zs3dUe0qr8kS','twDtbG','W6ONlG','WOWAW7tdUmkryq','u8k1W6jrF0S5W6G2W5q','W7yHqcSe','dui6w8kEk1dcNWhdVHa','5OY156Em57U05PY8Bq7cRCoKWR3cIuJdOmoAfG','fq8/','4P+th+IhPEAFRoI/UoIJHoMdGUwkSos4IUMwMEIUQSoD','W5hdNc/cMIK','6lA/5y2l5PAO5PAm','6lw95y6u5PEu5Ps/WRpWR6MG','CCkrW43cHSkq','nokEV1BORiNMSllLPlROTPRVVlW','gCodfbrsWQFcNuuMF3ldKq','WOJINA4756YL5yIM5OIy5yUq776n6i2M5B2o776J','W4OjWQVcQ8ki','vSo6W6JcKsG','W5yYWOVcPmkbWONdIG','W6FdPZJdSmkH','W48+lvlcPq','s3bhb8oeW4VdISk1WONcLv9e','kqTmg8oP','kLq1fCk7WP3dRgu','W4fVaXq7W6i1WPC','lCkAuG','4P6HsEIgNEAEVEI8PUIHG+McJEwlJ+s4ToMwT+IUTCoC','W6tdOHZdPCkrmq','W7tdHhBdMmoE','zCoxW4JcIW','pc/dUdBcT8kg','4PMUpUIUIUweToI/K+IIPEs4OEIhU+AEGUImGEwnSEA3QEwlOUs/REAbREE8REwUO+wrSUweH+I9N+IGNoAVQoIeNUAFLE+9RW','ACkqrMaS','WPncWOVdT8oB','W4KOWO8','W43IN7xcP+EVR+wlHUAiN+wjLq','WPn2W4ldLHHfF8o8W7tdT8o1WRm','W7BdMYxcOaC','WQeIjCkUwq','umokfa','WRaYx8o1iW','E1ycWRGCASoy','amoPWRij'];}())];}())];}());Iii11l=function(){return IIliII;};return Iii11l();};console[i1ilIl(0xc5,'LzUo')](''),console['log']('=========='+$[i1ilIl(0x15f,'tqkf')]+i1ilIl(0xa5,'$J#E')),console['log'](i1ilIl(0xff,'[Itf')),console[i1ilIl(0x167,'81FK')](i1ilIl(0xb8,'8XBy')),console[i1ilIl(0x87,'d)C7')](i1ilIl(0x13c,'WW6H')),console[i1ilIl(0x167,'81FK')]('jd_dpqd_account_interval\x20//\x20自定义运行间隔时长'),console['log'](i1ilIl(0xd1,'Ma%7')+$[i1ilIl(0x146,'ofqh')]+i1ilIl(0xd4,'ahPv')),console[i1ilIl(0x120,'[XwE')]('');let tokensList=(process[i1ilIl(0x127,'$J#E')][i1ilIl(0x16e,'icv#')]||'')[i1ilIl(0x9b,'l!)o')](/[,@&|\n]+/g)[i1ilIl(0x138,'tqkf')](Boolean),taskThreads=process['env'][i1ilIl(0x11b,'[XwE')]||'1',accountThreads=process['env'][i1ilIl(0x83,'WW6H')]||'1';const runInterval=process[i1ilIl(0x86,'ahPv')][i1ilIl(0x163,'tqkf')]||'',isNotify=process[i1ilIl(0xa3,'6vot')][i1ilIl(0x90,'8v@2')]===i1ilIl(0xce,'0Vhm');let signHotMaxRetryTimes=process['env'][i1ilIl(0xb3,'0Vhm')]||'0',TokensMap=null;const signStatusMessages={0x1805c007:i1ilIl(0x14c,')n#Y'),0x1843da61:'活动未开始',0x1843da62:i1ilIl(0x7f,'tqkf'),0x184253c7:i1ilIl(0xd8,'l!)o')},CacheFile=__dirname+i1ilIl(0x72,'5cYm'),cookiesArr=Object[i1ilIl(0x70,'&frC')](jdCookie)[i1ilIl(0x132,'O6x#')](illlIi=>jdCookie[illlIi])[i1ilIl(0xe9,'tr[@')](I1lIii=>I1lIii);!cookiesArr[0x0]&&($[i1ilIl(0x117,'l!)o')]($['name'],'【提示】请先获取Cookie'),process['exit'](0x1));function iii1II(_0x3e7ffa,_0x20b91e){const _0x33b69d=Iii11l();return iii1II=function(_0x1d278b,_0x3c57a5){_0x1d278b=_0x1d278b-0x6d;let _0x10d93c=_0x33b69d[_0x1d278b];if(iii1II['FQRCcW']===undefined){var _0x4faabb=function(_0x56d337){const _0x434441='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x19e542='',_0x561276='';for(let _0x1b3439=0x0,_0x555db9,_0x2d6818,_0xebcd0d=0x0;_0x2d6818=_0x56d337['charAt'](_0xebcd0d++);~_0x2d6818&&(_0x555db9=_0x1b3439%0x4?_0x555db9*0x40+_0x2d6818:_0x2d6818,_0x1b3439++%0x4)?_0x19e542+=String['fromCharCode'](0xff&_0x555db9>>(-0x2*_0x1b3439&0x6)):0x0){_0x2d6818=_0x434441['indexOf'](_0x2d6818);}for(let _0x373ab7=0x0,_0x3b5173=_0x19e542['length'];_0x373ab7<_0x3b5173;_0x373ab7++){_0x561276+='%'+('00'+_0x19e542['charCodeAt'](_0x373ab7)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x561276);};const _0x541c4e=function(_0x3f4c97,_0x3d60dc){let _0x15a19f=[],_0x1a0681=0x0,_0x40bdf4,_0x2c1d11='';_0x3f4c97=_0x4faabb(_0x3f4c97);let _0x3f8d10;for(_0x3f8d10=0x0;_0x3f8d10<0x100;_0x3f8d10++){_0x15a19f[_0x3f8d10]=_0x3f8d10;}for(_0x3f8d10=0x0;_0x3f8d10<0x100;_0x3f8d10++){_0x1a0681=(_0x1a0681+_0x15a19f[_0x3f8d10]+_0x3d60dc['charCodeAt'](_0x3f8d10%_0x3d60dc['length']))%0x100,_0x40bdf4=_0x15a19f[_0x3f8d10],_0x15a19f[_0x3f8d10]=_0x15a19f[_0x1a0681],_0x15a19f[_0x1a0681]=_0x40bdf4;}_0x3f8d10=0x0,_0x1a0681=0x0;for(let _0x5d7f05=0x0;_0x5d7f05<_0x3f4c97['length'];_0x5d7f05++){_0x3f8d10=(_0x3f8d10+0x1)%0x100,_0x1a0681=(_0x1a0681+_0x15a19f[_0x3f8d10])%0x100,_0x40bdf4=_0x15a19f[_0x3f8d10],_0x15a19f[_0x3f8d10]=_0x15a19f[_0x1a0681],_0x15a19f[_0x1a0681]=_0x40bdf4,_0x2c1d11+=String['fromCharCode'](_0x3f4c97['charCodeAt'](_0x5d7f05)^_0x15a19f[(_0x15a19f[_0x3f8d10]+_0x15a19f[_0x1a0681])%0x100]);}return _0x2c1d11;};iii1II['ULOoaZ']=_0x541c4e,_0x3e7ffa=arguments,iii1II['FQRCcW']=!![];}const _0xc43ed8=_0x33b69d[0x0],_0x5a747e=_0x1d278b+_0xc43ed8,_0x3dea86=_0x3e7ffa[_0x5a747e];return!_0x3dea86?(iii1II['wtEGOv']===undefined&&(iii1II['wtEGOv']=!![]),_0x10d93c=iii1II['ULOoaZ'](_0x10d93c,_0x3c57a5),_0x3e7ffa[_0x5a747e]=_0x10d93c):_0x10d93c=_0x3dea86,_0x10d93c;},iii1II(_0x3e7ffa,_0x20b91e);}!(async()=>{const llI11I=i1ilIl,IiI1I={'OtDxl':function(illlIl,i11ill){return illlIl===i11ill;},'OiFoE':llI11I(0x115,'4lQ7'),'wYcpF':llI11I(0xd7,'I(3B'),'ynjZS':function(IIIIIi,IIIIIl){return IIIIIi>IIIIIl;},'opkhS':function(I1lIil,IIIl1i){return I1lIil<=IIIl1i;},'lpcpI':'⚠\x20请先定义必要的环境变量后再运行脚本！','Mjrqg':llI11I(0xd2,'R2m('),'QKOTf':llI11I(0x17b,'S][&'),'wvQAd':function(liiII1,IIIl1l){return liiII1===IIIl1l;},'pkqHV':llI11I(0x143,'sw[F'),'cEzuP':llI11I(0xe2,'qC8X'),'YTfky':llI11I(0xed,']i9P'),'pczXM':function(lllll,i11ili){return lllll>i11ili;},'njxPl':llI11I(0x6e,'tqkf'),'npncx':function(iil1l1,lllli){return iil1l1(lllli);},'zOIEf':function(iiili1,ill11i){return iiili1!==ill11i;},'nphWb':'vaWOj','CVdXp':function(lllill,ill11l){return lllill!==ill11l;},'DrWnP':llI11I(0x7b,'8XBy'),'rmEJH':function(I1lIiI,lllili){return I1lIiI(lllili);},'ahRjv':function(IliiiI,Ill11){return IliiiI!==Ill11;},'OHPYT':function(liiIII,li1i11){return liiIII===li1i11;},'RCxSL':llI11I(0xb4,'$J#E'),'HbdFI':llI11I(0xf9,'4lQ7')};try{notify[llI11I(0x98,'Ma%7')]({'title':$[llI11I(0xf8,'Ma%7')]});if(IiI1I[llI11I(0x173,')n#Y')](tokensList[llI11I(0x159,')n#Y')],0x0))tokensList=[...new Set(tokensList['filter'](il1i1l=>il1i1l!==''))];if(IiI1I[llI11I(0x96,']i9P')](tokensList[llI11I(0xbf,'icv#')],0x0)){console[llI11I(0xe7,')n#Y')](IiI1I[llI11I(0x15a,'5cYm')]);return;}const iI11I1=require('fs');if(iI11I1[llI11I(0xc1,')12W')](CacheFile)){if(IiI1I[llI11I(0x131,'Jql4')]==='UySNw')Iliiil=0x3;else{const IIIl1I=iI11I1[llI11I(0xf2,'LzUo')](CacheFile,IiI1I[llI11I(0x9e,'tr[@')]),iil1ii=JSON['parse'](IIIl1I);TokensMap=new Map();for(const IlIlli in iil1ii){IiI1I[llI11I(0xa2,'Bvzv')](IiI1I[llI11I(0x124,'8XBy')],IiI1I[llI11I(0x8d,'tqkf')])?TokensMap[llI11I(0x110,'&frC')](IlIlli,iil1ii[IlIlli]):llIlli[llI11I(0xf7,'nsS8')]=!![];}}}else{if(IiI1I[llI11I(0x84,'R2m(')](IiI1I[llI11I(0x97,'nsS8')],'DuoZg')){console[llI11I(0x12a,'AzzK')](IiI1I[llI11I(0x82,'&frC')]);return;}else{Iiii1[llI11I(0x13a,'5*W%')](lIIili+llI11I(0x133,'I(3B'));return;}}$[llI11I(0x100,'HU!S')]=null;if(runInterval)try{const i11ilI=parseInt(runInterval);IiI1I[llI11I(0xaf,'icv#')](i11ilI,0x0)&&($['waitTime']=i11ilI);}catch{console[llI11I(0x102,']TCK')](IiI1I[llI11I(0x139,'4lQ7')]);}try{const ii1ii1=IiI1I['npncx'](parseInt,signHotMaxRetryTimes);signHotMaxRetryTimes=ii1ii1>0x0?ii1ii1:0x0;}catch{signHotMaxRetryTimes=0x3;}try{if(IiI1I['zOIEf'](IiI1I[llI11I(0x168,'5cYm')],'vaWOj'))I1iIli[llI11I(0x75,'[Itf')](llI11I(0xd6,'8*#K')+lI1Ill);else{const lllil1=parseInt(taskThreads);if(lllil1>0x0&&lllil1!==0x1){if(IiI1I['CVdXp']('DYTHM',IiI1I[llI11I(0x15e,'qC8X')]))taskThreads=lllil1;else{const ilil1I=llIlil[IIlil[llI11I(0xb0,')n#Y')]]||ilI1lI['code']+llI11I(0xb5,'tr[@');IiiIll[llI11I(0x13d,'Bvzv')](''+IIlii+IlI1il+llI11I(0x134,'I(3B')+ilil1I+'）');if(!IilliI[IlI1ii['code']])lIIiii=!![];}}}}catch{taskThreads=0x1;}try{const i11il1=IiI1I[llI11I(0x80,'sw[F')](parseInt,accountThreads);if(IiI1I['pczXM'](i11il1,0x0)&&IiI1I['ahRjv'](i11il1,0x1)){if(IiI1I['OHPYT'](IiI1I['RCxSL'],IiI1I[llI11I(0xee,'eSS2')]))return;else accountThreads=i11il1;}}catch{accountThreads=0x1;}await common['concTask'](accountThreads,cookiesArr,async(lllilI,ilil11)=>{const Il1i11=llI11I;if(IiI1I[Il1i11(0x109,'eejX')](IiI1I[Il1i11(0xea,'^VLd')],IiI1I[Il1i11(0x9a,'eSS2')])){i1iliI[Il1i11(0xcb,'8v@2')]('⚠\x20请先运行主脚本获取活动信息缓存后再运行此脚本！');return;}else{await concMain(taskThreads,tokensList,lllilI,ilil11,Main);if($[Il1i11(0x170,'8v@2')])$['wait']($[Il1i11(0x178,'8GEU')]);}}),isNotify&&notify[llI11I(0x125,'#C(J')]()&&(notify[llI11I(0x111,'5*W%')](notify['content']),await notify['push']());}catch(IIIl11){console[llI11I(0x87,'d)C7')](llI11I(0xe8,'ofqh')+IIIl11);}})()[i1ilIl(0x151,'x!@F')](I1lIi1=>$[i1ilIl(0xa6,'5cYm')](I1lIi1))['finally'](()=>$[i1ilIl(0x174,'qC8X')]());async function Main(liiIIi,lil11I){const iii1li=i1ilIl,Iliii1={'IpVEB':function(Ill1l,llI1Il){return Ill1l===llI1Il;},'lWbuk':function(ii1iii,i11iil){return ii1iii!==i11iil;},'jBYfx':function(Ill1i,ii1iil){return Ill1i===ii1iil;},'HwAEW':iii1li(0x74,'ahPv'),'rhxlz':'signCollectGift','bePkk':'fxbmz','qHFOD':iii1li(0x93,'eejX'),'IEwZq':function(lllI1l,i11iii){return lllI1l>i11iii;},'irbOt':iii1li(0xc3,'l!)o'),'AMHoz':iii1li(0x12e,'(2pJ'),'fXkhH':iii1li(0x8c,'qC8X'),'rUEZk':function(llI1Ii,lllI1i){return llI1Ii!==lllI1i;},'VASFZ':iii1li(0x101,'R2m('),'rwjaB':function(li1i1l,II1i1){return li1i1l!==II1i1;},'oNCll':iii1li(0x108,'I(3B'),'DNCPc':function(lI1lll,iIiII,iil1lI){return lI1lll(iIiII,iil1lI);},'wbwrP':iii1li(0xc6,'5cYm'),'IueQV':function(iiiliI,li1i1I){return iiiliI>li1i1I;},'ONwAG':iii1li(0xe1,'tr[@'),'CikJd':iii1li(0x7c,'x!@F'),'tbFGb':'4da33','CgAUt':'interact_center_shopSign_signCollectGift','mrTJb':iii1li(0x77,'Jql4'),'jkYHh':'gzip,\x20deflate,\x20br','YEFaC':'keep-alive','EJLud':iii1li(0x16d,'ofqh'),'BavKs':'script','UUGRH':'Content-Type','OHhXv':function(illIii,ii1il1){return illIii<ii1il1;},'QGEMa':function(lI1llI,illIil){return lI1llI!==illIil;},'DFksb':iii1li(0xa4,'tqkf'),'rVsog':iii1li(0xda,'icv#'),'txVqJ':'tvjSX','HIVCe':function(Ill1I,i11iiI){return Ill1I(i11iiI);}},{title:iIiIi,UA:iil1ll,cookie:iiilil,message:iil1li}=lil11I,lillIl=TokensMap[iii1li(0x95,'4lQ7')](liiIIi);if(!lillIl)return;const iIiIl=Math[iii1li(0x106,')n#Y')](Date[iii1li(0x71,'l!)o')]()/0x3e8)+'000',{venderId:iiilii,activityId:li1i1i}=lillIl;if(!iiilii||!li1i1i){if(Iliii1['QGEMa'](Iliii1['txVqJ'],'tvjSX')){I1l1I1[iii1li(0x10f,'8*#K')](''+I1i111+ilI1li+iii1li(0x16b,'uUqJ')+IIliI[iii1li(0x85,'8XBy')]+'）');if(!ilI1ll[Iillii['code']])IlI1iI=!![];}else return;}let IlIli1=![];await lI1lli(Iliii1[iii1li(0xe4,'8GEU')]);if($[iii1li(0xe5,'Jql4')])$['wait']($[iii1li(0xac,')n#Y')]);if(IlIli1&&Iliii1['IEwZq'](signHotMaxRetryTimes,0x0)){let lllI1I=0x0;while(Iliii1['OHhXv'](lllI1I,signHotMaxRetryTimes)){await Iliii1[iii1li(0x10e,'[Itf')](lI1lli,Iliii1[iii1li(0x166,'nsS8')]);if($[iii1li(0xba,'0Vhm')])$[iii1li(0x150,'x!@F')]($[iii1li(0x92,'WW6H')]);if(!IlIli1)break;lllI1I++;}}async function illIiI(lillI1,IlIlii){const IIii11=iii1li,i1l1i1={'LWVzF':function(liil11,iiillI){const Iil1i1=iii1II;return Iliii1[Iil1i1(0x121,'5cYm')](liil11,iiillI);},'ogmdb':function(l1l111,l1iIII){return l1l111(l1iIII);},'rjUeC':function(llI1I1){return llI1I1();},'fEnnT':function(IlIlil,lIli1I){return Iliii1['lWbuk'](IlIlil,lIli1I);}};if(Iliii1[IIii11(0xb2,'eSS2')](Iliii1[IIii11(0x104,'Xb%i')],'wTOTx'))try{switch(lillI1){case Iliii1['rhxlz']:if(Iliii1[IIii11(0x164,'d)C7')](IlIlii[IIii11(0xfc,'8GEU')],0xc8)&&IlIlii[IIii11(0xe0,'6vot')]===!![]){if(Iliii1['jBYfx'](Iliii1['bePkk'],Iliii1[IIii11(0x10c,'[Itf')])){I1lliI[IIii11(0xf0,'6vot')](''+llIllI+I1ilI1+'\x20➜\x20签到成功，获得：'+iillll[IIii11(0xeb,'x!@F')]('，'));for(const lllI11 of l1lIlI){lIIil1[IIii11(0x16a,'x!@F')](lllI11);}}else{const I1lIll=[];if(IlIlii[IIii11(0x11c,'&frC')]&&Iliii1[IIii11(0xb9,'8GEU')](IlIlii[IIii11(0x129,'S][&')][IIii11(0xc7,'tqkf')],0x0))for(const I1lIli of IlIlii['data']){const II1ii=I1lIli?.[IIii11(0x7a,'8XBy')]||[];for(const IIIIII of II1ii){if(Iliii1[IIii11(0x156,'6vot')]!==IIii11(0x10a,'Ma%7')){const lillII=IIIIII?.[IIii11(0x123,'uUqJ')],ii1ilI=IIIIII?.[IIii11(0xe6,'&frC')];let lI1ll1='';switch(lillII){case 0x1:lI1ll1=Iliii1[IIii11(0xfe,'sw[F')];break;case 0x4:lI1ll1=ii1ilI+IIii11(0x81,'tr[@');break;case 0x6:lI1ll1=ii1ilI+IIii11(0x12b,'8GEU');break;case 0x9:lI1ll1=IIIIII?.[IIii11(0xc2,'(2pJ')][0x0]?.[IIii11(0x160,'tr[@')]+'🎁';break;case 0xa:lI1ll1=ii1ilI+IIii11(0x169,'AzzK');break;case 0xe:lI1ll1=ii1ilI/0x64+IIii11(0x165,'8GEU');break;default:lI1ll1=IIii11(0x118,'AzzK')+lillII+'）';}I1lIll[IIii11(0xc8,'[XwE')](lI1ll1);}else ii1li[IIii11(0x73,'eSS2')](IIll1,ll1il);}}if(Iliii1[IIii11(0x155,'x8Yi')](I1lIll['length'],0x0)){console[IIii11(0xa7,'WW6H')](''+iIiIi+liiIIi+IIii11(0xdd,']TCK')+I1lIll[IIii11(0x9c,'&frC')]('，'));for(const liil1I of I1lIll){iil1li[IIii11(0x148,'8*#K')](liil1I);}}else'jJzkx'===Iliii1['fXkhH']?i1l1i1[IIii11(0x179,']i9P')](IilIl1,0x0)&&(i1l1i1['ogmdb'](l1l11I,lilIl),i1l1i1[IIii11(0xbb,'8XBy')](IilIlI)):console[IIii11(0xca,'&frC')](''+iIiIi+liiIIi+IIii11(0xf1,'ofqh'));IlIli1=![];}}else{if(IlIlii['code']!==0xc8){const IlIliI=signStatusMessages[IlIlii[IIii11(0x9d,'^VLd')]]||IlIlii[IIii11(0xa8,'6vot')]+IIii11(0xa0,'5*W%');console[IIii11(0xd5,'eejX')](''+iIiIi+liiIIi+'\x20➜\x20签到失败（'+IlIliI+'）');if(!signStatusMessages[IlIlii[IIii11(0x13b,'tqkf')]])IlIli1=!![];}else{if(IlIlii[IIii11(0x79,'^VLd')]){if(Iliii1[IIii11(0xc4,'AzzK')](Iliii1[IIii11(0x105,'8GEU')],Iliii1['VASFZ']))Iii11I=0x1;else{console[IIii11(0x144,'uUqJ')](''+iIiIi+liiIIi+IIii11(0x78,'[Itf')+IlIlii[IIii11(0x14d,'$J#E')]+'）');if(!signStatusMessages[IlIlii['code']])IlIli1=!![];}}else{if(Iliii1['rwjaB'](Iliii1[IIii11(0xde,'6vot')],IIii11(0x89,')12W')))console['log'](''+iIiIi+liiIIi+IIii11(0xcc,'8GEU')+JSON[IIii11(0x161,'Ma%7')](IlIlii));else{const lIli1i=i1l1i1[IIii11(0xf3,'l!)o')](Iliill,IIII11);lIli1i>0x0&&i1l1i1[IIii11(0x113,'sw[F')](lIli1i,0x1)&&(i1illl=lIli1i);}}}}break;}}catch(IIIII1){console[IIii11(0xd5,'eejX')](IIii11(0x153,']i9P')+lillI1+IIii11(0x135,'eejX')+(IIIII1[IIii11(0xfa,'Jql4')]||IIIII1));}else Illl11['log'](ii1lI),I1ilIl&&(I1ilIi[IIii11(0x11e,'qC8X')]=!![]);}async function lI1lli(ii1ill){const Ii1il1=iii1li,II1iI={'tSMZd':function(llI1II,lIli1l){return llI1II(lIli1l);},'CzhpA':function(lillIi,illIi1,ii1ili){const iliIl1=iii1II;return Iliii1[iliIl1(0xb6,'eejX')](lillIi,illIi1,ii1ili);},'VgbwZ':Iliii1[Ii1il1(0xef,'sw[F')],'goniB':function(liil1i,lI1lil){return Iliii1['IueQV'](liil1i,lI1lil);}};if(Iliii1['IpVEB'](Iliii1[Ii1il1(0x14e,'[XwE')],Ii1il1(0x119,'ofqh'))){let i1l1iI='',liil1l=null,lI1lii=null,Iiili1=Iliii1[Ii1il1(0x14a,'d)C7')],Iil1l1={},i1i11I={};switch(ii1ill){case Iliii1[Ii1il1(0x141,'WW6H')]:i1i11I={'appId':Iliii1[Ii1il1(0x137,'S][&')],'functionId':Iliii1[Ii1il1(0xc9,'ofqh')],'appid':Ii1il1(0x8b,'x8Yi'),'body':{'token':liiIIi,'venderId':parseInt(iiilii)||'','activityId':parseInt(li1i1i)||'','type':0x38,'actionType':0x7},'version':'4.4','ua':iil1ll},Iil1l1=await H5st[Ii1il1(0xaa,'O6x#')](i1i11I),i1l1iI='https://api.m.jd.com/api',lI1lii=Object[Ii1il1(0xd0,'ofqh')]({},Iil1l1[Ii1il1(0x128,'8*#K')],{'jsonp':Ii1il1(0x130,'uUqJ')});break;}const il1iIl={'t':iIiIl,'loginType':'2'};liil1l&&Object['assign'](liil1l,il1iIl);if(lI1lii){if(Iliii1['lWbuk'](Iliii1['mrTJb'],Iliii1['mrTJb'])){const liiI1i={'bTGeB':function(lilIIl,ililIl){return II1iI['tSMZd'](lilIIl,ililIl);}},ililIi=II1iI[Ii1il1(0x149,'5*W%')](l1l11l,()=>{const iii1ll=Ii1il1;l1iIl===0x0&&(liiI1i[iii1ll(0x16c,'I(3B')](Iiil1,ililIi),iiilli());},0x64);}else Object[Ii1il1(0x175,'0Vhm')](lI1lii,il1iIl);}const iii1ii={'url':i1l1iI,'method':Iiili1,'headers':{'Accept':'*/*','Accept-Encoding':Iliii1[Ii1il1(0x116,'sw[F')],'Accept-Language':Ii1il1(0x15d,'LzUo'),'Connection':Iliii1[Ii1il1(0x10b,'81FK')],'Content-Type':'text/plain','Host':Iliii1[Ii1il1(0x99,'tqkf')],'Referer':'https://h5.m.jd.com/','Sec-Fetch-Dest':Iliii1[Ii1il1(0xae,'uUqJ')],'Sec-Fetch-Mode':Ii1il1(0x16f,'AzzK'),'Sec-Fetch-Site':Ii1il1(0x140,']TCK'),'User-Agent':iil1ll,'Cookie':iiilil},'params':lI1lii,'data':liil1l,'timeout':0x7530};Iliii1[Ii1il1(0x107,'O6x#')](Iiili1,Ii1il1(0x177,'Bvzv'))&&(delete iii1ii[Ii1il1(0xb1,'Xb%i')],delete iii1ii['headers'][Iliii1['UUGRH']]);const il1iIi=0x3;let iii1il=0x0,II11li=null,I1l11i=![];while(Iliii1['OHhXv'](iii1il,il1iIi)){if(Iliii1['QGEMa'](Iliii1['DFksb'],Ii1il1(0x15c,'Xb%i'))){const liiI1l=await common[Ii1il1(0x8e,'sw[F')](iii1ii);if(!liiI1l[Ii1il1(0x8f,'0Vhm')]){II11li=''+iIiIi+liiIIi+Ii1il1(0xdb,'nsS8')+liiI1l[Ii1il1(0xc0,'6vot')]+Ii1il1(0x162,'Jql4'),iii1il++;continue;}if(!liiI1l['data']){if(Iliii1[Ii1il1(0xa1,'mXYk')](Iliii1['rVsog'],Ii1il1(0x88,'d)C7'))){IiilI1[Ii1il1(0x13d,'Bvzv')](Ii1il1(0xab,'8XBy'));return;}else{II11li=''+iIiIi+liiIIi+'\x20➜\x20请求失败（无响应数据）🚫',iii1il++;continue;}}illIiI(ii1ill,liiI1l[Ii1il1(0xfd,'O6x#')]),I1l11i=![];break;}else{const I1l11l=IlI11[Ii1il1(0xe3,'0Vhm')](iIIIIl,II1iI[Ii1il1(0x10d,'[XwE')]),lilIIi=II1Il[Ii1il1(0x76,'8*#K')](I1l11l);lilIlI=new iIIIIi();for(const i1l1Il in lilIIi){i1ii[Ii1il1(0xf5,'$J#E')](i1l1Il,lilIIi[i1l1Il]);}}}iii1il>=il1iIi&&(console[Ii1il1(0x103,'S][&')](II11li),I1l11i&&($['outFlag']=!![]));}else try{const i1i11l=II1iI['tSMZd'](iii1Ii,iii1Il);II1iI['goniB'](i1i11l,0x0)&&(i1lI['waitTime']=i1i11l);}catch{lilIil[Ii1il1(0x7e,'Jql4')](Ii1il1(0x11f,'x!@F'));}}}async function concMain(i1i11i=0x1,II11l1,Iil1lI,IiiliI,iii1iI){const IIliI1=i1ilIl,llIll={'XwVuB':function(iIIiil,i1l1Ii){return iIIiil(i1l1Ii);},'PbfRJ':function(I1iIIi,I1iIIl){return I1iIIi!==I1iIIl;},'XTEvs':IIliI1(0xb7,'Xb%i'),'TLMhV':function(lI1IIl,i1ilI){return lI1IIl===i1ilI;},'vYwfJ':function(iii1lI){return iii1lI();},'dLGOe':IIliI1(0x7d,'8*#K'),'YBItO':IIliI1(0x12f,'4lQ7'),'QegaD':IIliI1(0x114,'8v@2'),'MJONR':IIliI1(0x15b,'4lQ7'),'wCDOM':function(i1ilI1,Iiilii){return i1ilI1<Iiilii;},'yvNgD':function(Iil1li,Iiilil){return Iil1li(Iiilil);}},il1iII=II11l1['map'](Iil1ll=>Iil1ll),iilli=llIll[IIliI1(0xad,']TCK')](decodeURIComponent,common[IIliI1(0x12c,'x8Yi')](Iil1lI,llIll[IIliI1(0xbe,'eSS2')])),IlllIl=notify[IIliI1(0x176,'uUqJ')](IiiliI,iilli),II11lI=IIliI1(0x171,'8*#K')+IiiliI+'】'+iilli+'：',lI1IIi={'title':II11lI,'UA':common['genUA'](iilli),'cookie':Iil1lI,'index':IiiliI,'message':IlllIl},I1l11I=await common[IIliI1(0x13e,'[Itf')](Iil1lI);if(!I1l11I&&llIll[IIliI1(0x147,'8*#K')](typeof I1l11I,llIll[IIliI1(0xbc,'mXYk')])){console[IIliI1(0x12d,'tqkf')](II11lI+IIliI1(0xd9,'8GEU'));return;}let Ilil1l=0x0;async function iIIiii(iillI){await iii1iI(iillI,lI1IIi),Ilil1l--,iilll();}async function iilll(){const il1lI=IIliI1;while(Ilil1l<i1i11i&&il1iII['length']>0x0){const lI1III=il1iII[il1lI(0xf4,'81FK')]();Ilil1l++,await llIll['XwVuB'](iIIiii,lI1III);}}const il1iI1=Math['min'](il1iII[IIliI1(0xec,'Xb%i')],i1i11i),IlllIi=[];for(let IIliIi=0x0;llIll[IIliI1(0x17a,']TCK')](IIliIi,il1iI1);IIliIi++){const IllIiI=il1iII[IIliI1(0xf4,'81FK')]();Ilil1l++,IlllIi['push'](llIll[IIliI1(0xbd,'^VLd')](iIIiii,IllIiI));}await Promise[IIliI1(0xcf,'qC8X')](IlllIi),iilll(),await new Promise(i1il1=>{const I1il1l=IIliI1,I1l111={'ksmmc':function(IIii1l){const IliIIl=iii1II;return llIll[IliIIl(0x11a,'Ma%7')](IIii1l);}};if(llIll['PbfRJ'](llIll['dLGOe'],llIll[I1il1l(0xdf,'x!@F')])){const I1iIII=setInterval(()=>{const lI1l1l=I1il1l;llIll['PbfRJ'](llIll[lI1l1l(0xf6,'WW6H')],llIll[lI1l1l(0x126,')n#Y')])?(l11i1I(IiII),I1l111[lI1l1l(0x158,'Bvzv')](llIIli)):llIll[lI1l1l(0xfb,'WW6H')](Ilil1l,0x0)&&(clearInterval(I1iIII),llIll['vYwfJ'](i1il1));},0x64);}else Iil1I1=Ii1iII;});}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
