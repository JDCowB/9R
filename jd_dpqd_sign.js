/*
活动名称：批量店铺签到
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割
        jd_dpqd_task_threads // 控制签到并发线程数（正整数），默认1
        jd_dpqd_account_threads // 控制账号并发线程数（正整数），默认1
        jd_dpqd_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认0
        jd_dpqd_max_retry // 签到火爆时的最大重试次数（整数），默认3
        jd_dpqd_prize_notify // 是否推送中奖信息（true/false），默认不推送

此脚本为高并发签到本，需要读取主脚本生成的活动信息缓存，自动过滤无效活动，签到后如有奖品则自动到账


cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到')
var iｉl='jsjiami.com.v7';const llI11l=iii1II;if(function(i1iiI,i1ilIl,llI11I,Il1i11,iii1li,Iil1i1,IIii11){return i1iiI=i1iiI>>0x1,Iil1i1='hs',IIii11='hs',function(iliIl1,Ii1il1,iii1ll,IIliI1,il1lI){const i1iil=iii1II;IIliI1='tfi',Iil1i1=IIliI1+Iil1i1,il1lI='up',IIii11+=il1lI,Iil1i1=iii1ll(Iil1i1),IIii11=iii1ll(IIii11),iii1ll=0x0;const IliIIl=iliIl1();while(!![]&&--Il1i11+Ii1il1){try{IIliI1=-parseInt(i1iil(0xf8,'a[J]'))/0x1+parseInt(i1iil(0x128,'l7na'))/0x2+parseInt(i1iil(0xa1,'7JtH'))/0x3*(parseInt(i1iil(0x120,'cN9X'))/0x4)+parseInt(i1iil(0xcd,'bwx2'))/0x5+-parseInt(i1iil(0x13a,'qhN7'))/0x6*(parseInt(i1iil(0x182,'GODl'))/0x7)+parseInt(i1iil(0xc3,'coY@'))/0x8+parseInt(i1iil(0xc1,'MWtG'))/0x9;}catch(I1il1l){IIliI1=iii1ll;}finally{il1lI=IliIIl[Iil1i1]();if(i1iiI<=Il1i11)iii1ll?iii1li?IIliI1=il1lI:iii1li=il1lI:iii1ll=il1lI;else{if(iii1ll==iii1li['replace'](/[krOJFqhQwVgBuHbR=]/g,'')){if(IIliI1===Ii1il1){IliIIl['un'+Iil1i1](il1lI);break;}IliIIl[IIii11](il1lI);}}}}}(llI11I,i1ilIl,function(lI1l1l,IIliII,iiliI,Ill11I,I1il1i,IliIIi,lI1l1i){return IIliII='\x73\x70\x6c\x69\x74',lI1l1l=arguments[0x0],lI1l1l=lI1l1l[IIliII](''),iiliI=`\x72\x65\x76\x65\x72\x73\x65`,lI1l1l=lI1l1l[iiliI]('\x76'),Ill11I=`\x6a\x6f\x69\x6e`,(0x15bd5f,lI1l1l[Ill11I](''));});}(0x19a,0xd39f8,Iii11l,0xcf),Iii11l){}const jdCookie=require('./jdCookie'),notify=require(llI11l(0x151,'H$lx')),common=require('./utils/Rebels_jdCommon'),{H5st}=require(llI11l(0x97,'Xba9'));console[llI11l(0x12f,'n]iv')](''),console[llI11l(0x169,'Ud9i')]('=========='+$[llI11l(0x16e,'T(Pb')]+llI11l(0xe8,'yWjI')),console[llI11l(0x144,'s!S8')](llI11l(0x111,'eRbR')),console[llI11l(0xd4,'DQ@f')]('jd_dpqd_task_threads\x20//\x20控制签到并发，默认1'),console['log'](llI11l(0x166,'(WdS')),console[llI11l(0xe6,'cN9X')](llI11l(0x16b,'Ud9i')),console[llI11l(0x181,'4qpx')](llI11l(0xf2,'#q[4')+$[llI11l(0xe7,'dvX)')]+'提示结束=========='),console[llI11l(0x9a,'@*xv')]('');let tokensList=(process[llI11l(0x125,'Il9i')][llI11l(0xb8,'coY@')]||'')[llI11l(0x123,'j*tW')](/[,@&|\n]+/g)['filter'](Boolean),taskThreads=process['env'][llI11l(0x98,'%bPU')]||'1',accountThreads=process['env'][llI11l(0x102,'c]$N')]||'1';const runInterval=process[llI11l(0x15c,'yMmK')][llI11l(0x14b,'NTK*')]||'',isNotify=process[llI11l(0x149,'j*tW')][llI11l(0xc7,'T(Pb')]===llI11l(0x165,'7oe!');let signHotMaxRetryTimes=process['env'][llI11l(0xf0,'7JtH')]||'0',TokensMap=null;function iii1II(_0x26f04e,_0x5c6fbf){const _0x484369=Iii11l();return iii1II=function(_0x44a24c,_0x3bea89){_0x44a24c=_0x44a24c-0x81;let _0x43fd79=_0x484369[_0x44a24c];if(iii1II['iinpgo']===undefined){var _0x486058=function(_0x1f49d7){const _0x2d901d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x9cbcd='',_0xb1ed9a='';for(let _0x27ce84=0x0,_0x3a3f0c,_0x1204e1,_0x38c308=0x0;_0x1204e1=_0x1f49d7['charAt'](_0x38c308++);~_0x1204e1&&(_0x3a3f0c=_0x27ce84%0x4?_0x3a3f0c*0x40+_0x1204e1:_0x1204e1,_0x27ce84++%0x4)?_0x9cbcd+=String['fromCharCode'](0xff&_0x3a3f0c>>(-0x2*_0x27ce84&0x6)):0x0){_0x1204e1=_0x2d901d['indexOf'](_0x1204e1);}for(let _0x163e92=0x0,_0x39b904=_0x9cbcd['length'];_0x163e92<_0x39b904;_0x163e92++){_0xb1ed9a+='%'+('00'+_0x9cbcd['charCodeAt'](_0x163e92)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xb1ed9a);};const _0x4783df=function(_0x2e3c3e,_0x1dfd56){let _0x2b5b74=[],_0x360d62=0x0,_0x3a71e4,_0x20cbaa='';_0x2e3c3e=_0x486058(_0x2e3c3e);let _0x3d6880;for(_0x3d6880=0x0;_0x3d6880<0x100;_0x3d6880++){_0x2b5b74[_0x3d6880]=_0x3d6880;}for(_0x3d6880=0x0;_0x3d6880<0x100;_0x3d6880++){_0x360d62=(_0x360d62+_0x2b5b74[_0x3d6880]+_0x1dfd56['charCodeAt'](_0x3d6880%_0x1dfd56['length']))%0x100,_0x3a71e4=_0x2b5b74[_0x3d6880],_0x2b5b74[_0x3d6880]=_0x2b5b74[_0x360d62],_0x2b5b74[_0x360d62]=_0x3a71e4;}_0x3d6880=0x0,_0x360d62=0x0;for(let _0x2590f2=0x0;_0x2590f2<_0x2e3c3e['length'];_0x2590f2++){_0x3d6880=(_0x3d6880+0x1)%0x100,_0x360d62=(_0x360d62+_0x2b5b74[_0x3d6880])%0x100,_0x3a71e4=_0x2b5b74[_0x3d6880],_0x2b5b74[_0x3d6880]=_0x2b5b74[_0x360d62],_0x2b5b74[_0x360d62]=_0x3a71e4,_0x20cbaa+=String['fromCharCode'](_0x2e3c3e['charCodeAt'](_0x2590f2)^_0x2b5b74[(_0x2b5b74[_0x3d6880]+_0x2b5b74[_0x360d62])%0x100]);}return _0x20cbaa;};iii1II['zWEzpc']=_0x4783df,_0x26f04e=arguments,iii1II['iinpgo']=!![];}const _0x3a4fb8=_0x484369[0x0],_0x110e89=_0x44a24c+_0x3a4fb8,_0x2a1f71=_0x26f04e[_0x110e89];return!_0x2a1f71?(iii1II['tZrCna']===undefined&&(iii1II['tZrCna']=!![]),_0x43fd79=iii1II['zWEzpc'](_0x43fd79,_0x3bea89),_0x26f04e[_0x110e89]=_0x43fd79):_0x43fd79=_0x2a1f71,_0x43fd79;},iii1II(_0x26f04e,_0x5c6fbf);}const signStatusMessages={0x1805c007:llI11l(0x180,'eRbR'),0x1843da61:llI11l(0x92,'coY@'),0x1843da62:llI11l(0x117,'Ud9i'),0x184253c7:llI11l(0x140,'a$Yk')},CacheFile=__dirname+'/dpqd_tokens.json',cookiesArr=Object[llI11l(0x134,'4qpx')](jdCookie)[llI11l(0x13c,'GODl')](iil1l1=>jdCookie[iil1l1])[llI11l(0x115,'qhN7')](lllli=>lllli);!cookiesArr[0x0]&&($['msg']($[llI11l(0x124,'Ud9i')],'【提示】请先获取Cookie'),process['exit'](0x1));!(async()=>{const I1llIl=llI11l,iiili1={'idySK':'Content-Type','DosGi':function(ill11i,lllill){return ill11i>lllill;},'txYal':function(ill11l,I1lIiI){return ill11l===I1lIiI;},'XyhLV':I1llIl(0xcb,'4qpx'),'vBvlH':I1llIl(0xc5,'Xba9'),'SJdNG':function(lllili,IliiiI){return lllili(IliiiI);},'mxgIn':I1llIl(0xb6,'NTK*'),'QbmCs':'utf-8','kFkoe':function(Ill11,liiIII){return Ill11>liiIII;},'QmVhM':I1llIl(0xae,'l7na'),'rGaLV':function(li1i11,iI11I1){return li1i11!==iI11I1;},'NRLUF':function(il1i1l,IlIlll){return il1i1l(IlIlll);},'aFjrW':function(IIIl1I,iil1ii){return IIIl1I>iil1ii;},'UbcXf':function(IlIlli,il1i1i){return IlIlli===il1i1i;},'CkkqO':I1llIl(0x14a,'Xba9'),'cypFR':I1llIl(0x104,'l7na'),'SOqpr':I1llIl(0x11a,'7JtH')};try{if(iiili1[I1llIl(0xb1,'s!S8')](iiili1['XyhLV'],iiili1[I1llIl(0x145,'n]iv')]))delete l1iiI[I1llIl(0x10b,'DQ@f')],delete ll1li[I1llIl(0xbd,'C4lA')][iiili1['idySK']];else{notify['config']({'title':$[I1llIl(0x84,'a[J]')]});if(tokensList[I1llIl(0x11e,'@*xv')]>0x0)tokensList=[...new Set(tokensList[I1llIl(0x141,'d5@s')](ii1ii1=>ii1ii1!==''))];if(tokensList[I1llIl(0x171,'7oe!')]<=0x0){console[I1llIl(0x114,'7oe!')](I1llIl(0x17a,'CTK$'));return;}const i11ilI=iiili1[I1llIl(0xb2,'DQ@f')](require,'fs');if(i11ilI[I1llIl(0x157,'%bPU')](CacheFile)){if(I1llIl(0x90,'C4lA')===iiili1[I1llIl(0x150,'Xba9')]){const llllI=i11ilI[I1llIl(0xd1,'PQ!W')](CacheFile,iiili1['QbmCs']),lllil1=JSON[I1llIl(0x17e,'C#UZ')](llllI);TokensMap=new Map();for(const iil1il in lllil1){TokensMap[I1llIl(0x8b,'NTK*')](iil1il,lllil1[iil1il]);}}else{const i11il1=Iliill(IIII11);iiili1[I1llIl(0x14c,'L]&o')](i11il1,0x0)&&i11il1!==0x1&&(i1illl=i11il1);}}else{console[I1llIl(0xcf,'j*tW')](I1llIl(0x13d,'yWjI'));return;}$[I1llIl(0xd6,'cN9X')]=null;if(runInterval)try{const ii1iiI=iiili1['SJdNG'](parseInt,runInterval);iiili1[I1llIl(0x11d,'7JtH')](ii1iiI,0x0)&&($['waitTime']=ii1iiI);}catch{console[I1llIl(0x169,'Ud9i')](iiili1[I1llIl(0x121,'3R%h')]);}try{const lllilI=iiili1[I1llIl(0xef,'(WdS')](parseInt,signHotMaxRetryTimes);signHotMaxRetryTimes=lllilI>0x0?lllilI:0x0;}catch{signHotMaxRetryTimes=0x3;}try{const ilil11=iiili1['SJdNG'](parseInt,taskThreads);iiili1['DosGi'](ilil11,0x0)&&iiili1[I1llIl(0x131,'MWtG')](ilil11,0x1)&&(taskThreads=ilil11);}catch{taskThreads=0x1;}try{const illlI1=iiili1['NRLUF'](parseInt,accountThreads);iiili1[I1llIl(0x10d,'a8Nh')](illlI1,0x0)&&illlI1!==0x1&&(accountThreads=illlI1);}catch{accountThreads=0x1;}await common[I1llIl(0xf1,'%bPU')](accountThreads,cookiesArr,async(IIIl11,I1lIi1)=>{const i1iii=I1llIl;await concMain(taskThreads,tokensList,IIIl11,I1lIi1,Main);if($['waitTime'])$[i1iii(0x82,'DQ@f')]($[i1iii(0x15d,'coY@')]);}),isNotify&&notify[I1llIl(0xba,'a$Yk')]()&&(iiili1[I1llIl(0x174,'l7na')](I1llIl(0x94,'NTK*'),iiili1[I1llIl(0x185,'n]iv')])?(notify[I1llIl(0xed,'m6%I')](notify['content']),await notify[I1llIl(0x184,'CTK$')]()):II1lii[I1llIl(0x93,'eRbR')](''+lIIii1+ll1i1+'\x20➜\x20签到失败\x20-\x20'+IIli1i[I1llIl(0xc6,'d5@s')](I1iIi1)));}}catch(lil11I){if(iiili1[I1llIl(0x83,')ewb')](iiili1['cypFR'],iiili1[I1llIl(0x11b,')ewb')])){Iiii1[I1llIl(0xf3,'#q[4')](lIIili+'账号无效\x20🚫');return;}else console[I1llIl(0xde,'l7na')](I1llIl(0x11c,'(WdS')+lil11I);}})()[llI11l(0x137,'11bY')](iIiIi=>$[llI11l(0x168,'cN9X')](iIiIi))['finally'](()=>$['done']());async function Main(iil1ll,iiilil){const I1llIi=llI11l,iil1li={'nIcXN':I1llIi(0xb5,'Xba9'),'nDwnF':function(Ill1i,ii1iil){return Ill1i(ii1iil);},'qmvqB':function(lllI1l,i11iii){return lllI1l===i11iii;},'EUEaa':function(llI1Ii,lllI1i){return llI1Ii===lllI1i;},'PdAox':function(li1i1l,II1i1){return li1i1l!==II1i1;},'LQftb':I1llIi(0xa2,'L]&o'),'YHNlq':I1llIi(0x146,'eRbR'),'wAWYA':function(lI1lll,iIiII){return lI1lll!==iIiII;},'OxrWq':I1llIi(0x132,'RLmA'),'gSKsN':I1llIi(0x100,'c]$N'),'HNXhI':function(iil1lI,iiiliI){return iil1lI/ iiiliI;},'xmQtc':'vwoqf','huXkM':I1llIi(0x189,'6N^4'),'tleXt':'RyJNa','MIuSH':function(li1i1I,illIii,ii1il1){return li1i1I(illIii,ii1il1);},'OTubY':function(lI1llI,illIil){return lI1llI(illIil);},'wwSnj':function(Ill1I,i11iiI){return Ill1I>i11iiI;},'gDSmt':function(lIli11){return lIli11();},'Uzjtc':'GET','RhiLk':I1llIi(0xe4,'d5@s'),'lPYJJ':I1llIi(0xd3,'M[MA'),'CFGgd':I1llIi(0x89,'(WdS'),'PDupP':function(lllI1I,lillI1){return lllI1I(lillI1);},'uQAfp':I1llIi(0xea,']3E6'),'CXOZR':'https://api.m.jd.com/api','XkFOY':'*/*','ljtfN':I1llIi(0x154,'7oe!'),'ayLgS':I1llIi(0x139,'m6%I'),'jgmcR':I1llIi(0x14d,'PQ!W'),'ayLvh':I1llIi(0x163,'CTK$'),'NQxUZ':'script','QUeiJ':I1llIi(0x96,'dvX)'),'Ocals':I1llIi(0xf5,'7oe!'),'uvJSS':function(IlIlii,i1l1i1){return IlIlii<i1l1i1;},'PyxSQ':function(liil11,iiillI){return liil11!==iiillI;},'lmjYi':function(l1l111,l1iIII){return l1l111===l1iIII;},'tiVEE':'hfZSh','xUzKJ':I1llIi(0xe0,'GODl'),'YxrNe':I1llIi(0xe5,']3E6'),'wXpxb':'TsedV','yjKNa':function(llI1I1,IlIlil,lIli1I){return llI1I1(IlIlil,lIli1I);},'VBqxL':function(II1il,lllI11){return II1il>=lllI11;},'MGRdG':I1llIi(0x126,'W$9o'),'uskpY':I1llIi(0xff,'M[MA'),'LhzCc':function(I1lIll,I1lIli){return I1lIll>I1lIli;},'LQrOy':function(II1ii,IIIIII){return II1ii<IIIIII;},'RZtrR':function(lillII,ii1ilI){return lillII(ii1ilI);}},{title:lillIl,UA:iIiIl,cookie:iiilii,message:li1i1i}=iiilil,IlIli1=TokensMap[I1llIi(0xdb,'m6%I')](iil1ll);if(!IlIli1)return;const illIiI=Math[I1llIi(0x179,'Il9i')](iil1li[I1llIi(0xaa,'Xba9')](Date[I1llIi(0x108,'11bY')](),0x3e8))+I1llIi(0x9c,'W$9o'),{venderId:lI1lli,activityId:Ill1l}=IlIli1;if(!lI1lli||!Ill1l)return;let llI1Il=![];await i11iil(iil1li[I1llIi(0x170,'Ud9i')]);if($[I1llIi(0x118,'1([s')])$[I1llIi(0x15b,'yWjI')]($['waitTime']);if(llI1Il&&iil1li['LhzCc'](signHotMaxRetryTimes,0x0)){let lI1ll1=0x0;while(iil1li[I1llIi(0x81,'coY@')](lI1ll1,signHotMaxRetryTimes)){await iil1li[I1llIi(0x10e,'CTK$')](i11iil,iil1li[I1llIi(0xfb,'6N^4')]);if($['waitTime'])$[I1llIi(0x16c,'(WdS')]($[I1llIi(0x162,')ewb')]);if(!llI1Il)break;lI1ll1++;}}async function ii1iii(iIiI1,liil1I){const IIii1I=I1llIi,i11ii1={'pOYzy':iil1li[IIii1I(0x16a,'j*tW')],'gzsRS':function(IlIliI,l1iII1){const llI11i=IIii1I;return iil1li[llI11i(0x127,'#q[4')](IlIliI,l1iII1);}};try{switch(iIiI1){case IIii1I(0x9b,'dvX)'):if(iil1li[IIii1I(0xe2,'7oe!')](liil1I[IIii1I(0x138,'dvX)')],0xc8)&&iil1li[IIii1I(0x95,'d5@s')](liil1I['success'],!![])){const iiill1=[];if(liil1I[IIii1I(0x160,'j*tW')]&&liil1I[IIii1I(0x107,'PQ!W')]['length']>0x0){if(iil1li[IIii1I(0x158,'T(Pb')](iil1li[IIii1I(0x188,'4qpx')],iil1li[IIii1I(0x159,'#q[4')]))for(const lIli1i of liil1I[IIii1I(0x172,'6N^4')]){if(iil1li['wAWYA'](iil1li[IIii1I(0xdd,'qhN7')],'Rockb')){const IIIII1=lIli1i?.[IIii1I(0xd9,'l7na')]||[];for(const I1lIlI of IIIII1){const ii1ill=I1lIlI?.[IIii1I(0x116,'a[J]')],II1iI=I1lIlI?.[IIii1I(0xa3,'(WdS')];let llI1II='';switch(ii1ill){case 0x1:llI1II=iil1li['gSKsN'];break;case 0x4:llI1II=II1iI+IIii1I(0x113,'#q[4');break;case 0x6:llI1II=II1iI+'店铺积分🎟️';break;case 0x9:llI1II=I1lIlI?.[IIii1I(0xbf,'%bPU')][0x0]?.['skuName']+'🎁';break;case 0xa:llI1II=II1iI+IIii1I(0x99,'yMmK');break;case 0xe:llI1II=iil1li[IIii1I(0xab,'7JtH')](II1iI,0x64)+'元红包🧧';break;default:llI1II=IIii1I(0xec,'t([c')+ii1ill+'）';}iiill1['push'](llI1II);}}else{const lillIi=llIlil[IIlil['code']]||ilI1lI['code']+'|活动太火爆';IiiIll['log'](''+IIlii+IlI1il+IIii1I(0x91,'PQ!W')+lillIi+'）');if(!IilliI[IlI1ii['code']])lIIiii=!![];}}else lilIl1[IIii1I(0xce,'(WdS')](i1l1ii[IIii1I(0xd7,'yMmK')],i11ii1['pOYzy']),i1l1[IIii1I(0x12a,'11bY')](0x1);}if(iiill1[IIii1I(0xbc,'l7na')]>0x0){console[IIii1I(0xde,'l7na')](''+lillIl+iil1ll+IIii1I(0x13f,'7JtH')+iiill1['join']('，'));for(const ii1ili of iiill1){iil1li[IIii1I(0x13b,']3E6')](iil1li[IIii1I(0x17b,'yWjI')],'vwoqf')?li1i1i[IIii1I(0xfa,'7JtH')](ii1ili):i1li[IIii1I(0x8b,'NTK*')](li1II,IliI11[i1ll]);}}else iil1li['PdAox'](iil1li[IIii1I(0xad,'yWjI')],IIii1I(0xdc,'Il9i'))?console[IIii1I(0x109,'1([s')](''+lillIl+iil1ll+IIii1I(0xfe,'MWtG')):Iii11I=0x1;llI1Il=![];}else{if(iil1li['wAWYA'](liil1I[IIii1I(0xcc,'bwx2')],0xc8)){const i1l1iI=signStatusMessages[liil1I[IIii1I(0x17f,'W$9o')]]||liil1I[IIii1I(0xf9,'t([c')]+IIii1I(0xb0,'7JtH');console[IIii1I(0x8a,'MlZx')](''+lillIl+iil1ll+'\x20➜\x20签到失败（'+i1l1iI+'）');if(!signStatusMessages[liil1I[IIii1I(0x88,'Il9i')]])llI1Il=!![];}else{if(liil1I['msg']){console['log'](''+lillIl+iil1ll+IIii1I(0x10c,'RLmA')+liil1I['msg']+'）');if(!signStatusMessages[liil1I[IIii1I(0x15f,'s!S8')]])llI1Il=!![];}else iil1li[IIii1I(0x136,']3E6')](iil1li[IIii1I(0x187,'a8Nh')],IIii1I(0x14e,'M[MA'))?console[IIii1I(0xe9,'m6%I')](''+lillIl+iil1ll+IIii1I(0x155,'DQ@f')+JSON[IIii1I(0xee,'t([c')](liil1I)):(i11ii1[IIii1I(0x143,'d5@s')](l11i1I,IiII),llIIli());}}break;}}catch(lI1lii){console[IIii1I(0x152,'a[J]')](IIii1I(0xa8,'cN9X')+iIiI1+IIii1I(0x101,'bwx2')+(lI1lii[IIii1I(0x142,'bwx2')]||lI1lii));}}async function i11iil(Iiili1){const I11i1I=I1llIi,Iil1l1={'KyDJi':function(i1i11I,il1iIl){const i1iIi1=iii1II;return iil1li[i1iIi1(0x85,'PQ!W')](i1i11I,il1iIl);},'sZVIT':function(iii1ii,il1iIi){return iil1li['wwSnj'](iii1ii,il1iIi);},'aIdvm':function(iii1il,II11li){return iii1il===II11li;},'oUWPZ':function(I1l11i){const l1l1il=iii1II;return iil1li[l1l1il(0x175,'j*tW')](I1l11i);}};if(iil1li[I11i1I(0x156,'C#UZ')]('areie',I11i1I(0x12b,'a$Yk'))){let iIIiiI='',liiI1i=null,ililIi=null,lilIIl=iil1li['Uzjtc'],ililIl={},liiI1l={};switch(Iiili1){case iil1li[I11i1I(0x153,'#q[4')]:liiI1l={'appId':iil1li['lPYJJ'],'functionId':I11i1I(0x103,'j*tW'),'appid':iil1li[I11i1I(0x8f,'qhN7')],'body':{'token':iil1ll,'venderId':parseInt(lI1lli)||'','activityId':iil1li['PDupP'](parseInt,Ill1l)||'','type':0x38,'actionType':0x7},'version':iil1li[I11i1I(0x129,'j*tW')],'ua':iIiIl},ililIl=await H5st['getH5st'](liiI1l),iIIiiI=iil1li[I11i1I(0xa9,'Ud9i')],ililIi=Object['assign']({},ililIl[I11i1I(0x119,'m6%I')],{'jsonp':I11i1I(0x10a,'c]$N')});break;}const i1l1II={'t':illIiI,'loginType':'2'};liiI1i&&Object['assign'](liiI1i,i1l1II);ililIi&&Object['assign'](ililIi,i1l1II);const i1ill={'url':iIIiiI,'method':lilIIl,'headers':{'Accept':iil1li['XkFOY'],'Accept-Encoding':iil1li[I11i1I(0xbe,'(WdS')],'Accept-Language':iil1li[I11i1I(0x10f,'1([s')],'Connection':iil1li['jgmcR'],'Content-Type':I11i1I(0x112,'H$lx'),'Host':iil1li[I11i1I(0xc0,'(WdS')],'Referer':'https://h5.m.jd.com/','Sec-Fetch-Dest':iil1li[I11i1I(0x15a,'C#UZ')],'Sec-Fetch-Mode':I11i1I(0xd0,'yMmK'),'Sec-Fetch-Site':iil1li[I11i1I(0x16d,'cN9X')],'User-Agent':iIiIl,'Cookie':iiilii},'params':ililIi,'data':liiI1i,'timeout':0x7530};iil1li[I11i1I(0x16f,'s!S8')](lilIIl,'GET')&&(delete i1ill[I11i1I(0x8c,'n]iv')],delete i1ill[I11i1I(0xa5,'l7na')][iil1li['Ocals']]);const I1l11l=0x3;let lilIIi=0x0,i1l1Il=null,llIli=![];while(iil1li[I11i1I(0xb3,'l7na')](lilIIi,I1l11l)){if(iil1li['PyxSQ']('ELpNp','ELpNp'))l1i111=iliII1;else{const i1i11i=await common[I11i1I(0x176,'DQ@f')](i1ill);if(!i1i11i[I11i1I(0xe3,')ewb')]){if(iil1li[I11i1I(0xac,'PQ!W')](iil1li['tiVEE'],iil1li['xUzKJ'])){I1lliI['log'](''+llIllI+I1ilI1+I11i1I(0xb7,'4qpx')+iillll['join']('，'));for(const Iil1lI of l1lIlI){lIIil1[I11i1I(0xa7,'Il9i')](Iil1lI);}}else{i1l1Il=''+lillIl+iil1ll+I11i1I(0xd5,'cN9X')+i1i11i['error']+I11i1I(0xb9,'3R%h'),lilIIi++;continue;}}if(!i1i11i['data']){if(iil1li[I11i1I(0x147,'PQ!W')]===iil1li['wXpxb'])Iliiil=0x3;else{i1l1Il=''+lillIl+iil1ll+'\x20➜\x20请求失败（无响应数据）🚫',lilIIi++;continue;}}iil1li['yjKNa'](ii1iii,Iiili1,i1i11i['data']),llIli=![];break;}}if(iil1li['VBqxL'](lilIIi,I1l11l)){if(iil1li[I11i1I(0x186,'(WdS')](iil1li[I11i1I(0x167,'yMmK')],I11i1I(0x126,'W$9o'))){const llIll=Iil1l1[I11i1I(0x161,'(WdS')](Ii1iIi,iliIIl);Ii1iIl=Iil1l1[I11i1I(0x12e,'11bY')](llIll,0x0)?llIll:0x0;}else{console['log'](i1l1Il);if(llIli){if(iil1li['uskpY']===I11i1I(0xca,'n]iv')){const iilli=iil1li['MIuSH'](l1l11l,()=>{const iliIi1=I11i1I;Iil1l1[iliIi1(0xf7,'CTK$')](l1iIl,0x0)&&(Iil1l1[iliIi1(0x183,'DQ@f')](Iiil1,iilli),Iil1l1['oUWPZ'](iiilli));},0x64);}else $['outFlag']=!![];}}}}else lliiil['assign'](lliiii,IliI1i);}}function Iii11l(){const Ilil1i=(function(){return[...[iｉl,'qjswujQiukabmgiOF.HcHJourmRwq.gvVu7kBHhV==','i8o/WQ0V','W5DiWPVdGq8','uGqLWQPS','W7NdTmoRaSkr','qCk7W496W6m','W4ddP8kkWQldGa','FCoZW545WRm','EqvoW4a','e0pdKmkLWQ4','W4SJrmkx','W5SWWPpcOYy','WPFcVCoBWODKudBcStldGXRcTg/dMG','EmklESoUySoU','mCk7F8kr','tcSgWPzFtSoVaSkelN/cSr9MCNtcU2SgWR8','W7BcH1C','rWNcQW','W7bcWOtdKq','aCkujCoLtW','W6/cS8k4W4ddLW','WRlcRYVdLmo5','yYtdMSk6WRK','WRtIN7JdHUEUV+wjJ+wNGEI1NE++Ma','5Rsk5yIk5P6g5B225Asb','hSktWOC','FHVcH8oDWQC','mK/cPCkxW5q','u8o6qMJdOSk6W67cUhfeWOm','W6mFW59xW4ZdN2azuJNcM8orW4VdQCovW5S','W7BcV8koW4ldKX0sBalcUSk0WQRcHZrqACkYuh/dLq','5yEelUwpPVcLVRq','ichdSq','u8oYsgpcJmk6W7dcVxnoWPNdSNVcKSkh','mSkllG','yqBcK8oRWOS','FqXoW5lcMa','sCovD2CC','af/dQCkmW6pcU1ruWRNcJZ0k','BSk+emoQqHhdTa','vG7dOmoUW6K','qsWbWPbcEmoKga','jhRdSY4ksq','W7hdMSo1WPhdGSoBW7W','DJX3W6xcQG','o8k6AmkrWQRdHG','4P2YroACGoIaIoATIoEGQUwNP+ErImk9','WRWRWQ/dSx4','WOv+W7jlW6W','emk1cSoHCG','W7GjWOZcMby','W61Us14r','4PI5WP/OHB7LRA/KU67OVBNOO4pPLQlPMlNMLzhPLjNOR57NVRZPLylOR7i','BcTnW6pcHq','joA3GowlUUwMO+EbKoEjPG','Emo1W5funG','xs5dW7RcQW','W6ZdICoEWQBdTa','zCoECgGh','44oD5O+G56Aq44cY6k2s5yE76i6K5y+GqZpcLSoFW47dVW','rIRcS8orWOG','lEkDTSkj562W5yQX5OQy5yIm77YO6i6e5BY977YR','w8ogW7msWRRdM8k5W6P0hatdMfldIa','77Y+8kMARq','xq9iW5VdKmorW4W2bmoD','W7hcVSkIW5xdGGSt','W7xdMSo6WPldK8ob','EqFdL8kXWOu3W7G','ss8gWPvJ','W7xcTCkLW4pdKq0vrYBcQCkUWRVcVrntBSkBwgJdKG','rdW+WOvf','dmkCWRpcMmoDFJtdJJVdP8oqW5ei','W71GkCoXBG','b8kBWPvfW7pcMmkNW6rVgJ7dSG','WRZcOmokhCklWP7dM14','WP5EW6zmW7e','bg7cKSkFW5TbkmolWRq','WO9Or8k+WPBcIfBdJu4EW4dcMSoXW7n7W698bmoUW7m','WQ3dQ8oKWPBcKfHgzYZcOCk3WQ7cOa','C8oXuhyw','W51pWQFdGaG','BSkeW7bDW6m','WRz0WPmG','W6yIW490W7DCrmk6ESkNW4P0WQ8','sdyv','EmkbCW','W6KeWQOiwSkDlq','W6ybWOFcPtNcMrtdTvGaW7Wz','c8kxamoItW'],...(function(){return[...['gmkpFJNcUa','yGTa','hUkFUaRORilMSANLPBxOT4BVVyy','sqvdWOf/lCkokW','W6KkW6Oo','W4beWPxdSWW','W6NdJCo9WO/dGSoLW6yLW5K','pSocWOy9Bq','WPFcVCoB','c8kbqSk6WR4','WR7cKr7dPmoS','W7xdKmoZ','jIpcKYBdKq','W51PjCovBq','W6H6yW','WOJcSWexWQC','nvtdKmkEWQ3cUSk+','bhpcH8kyW7zjlCobWQJcNHrxg8o0WQm','l3ZdMIKA','uGTn','tSo6qMG','5y2D6yEu6k+N5PI7yqFcGL4pnCoyWOlcPui','WPZcT8oi','CYBcOG','WRpcLSoNWOjT','5P2n556Q5AEW5zci776j','WOxcQmolWQv/wH7cTZNdOr7cTM4','fdVdLmkGW6/dKxBdHmkW','DG8wWR1Q','mSkFdCoTsXhdHCktg8kQFCozgmkkWPBcMwq','W7/cTmk/W4xdTW0fwa','WQv6bmkJpqNdGh3cRIW','W7qOxG','mEIULEAZTowqMow5Tgu','WRRcSrKsWOddIWRdJmoZW70qAa','44gd6lAS5yYP','mSodWROXqq','WPfXh8oalsfuxSokW7LiaG','bcddGSkS','mCkviCoSsrq','W5BdU8k3WONdNW','WRZcNcxdGmoZ','qG4EWPjI','hUkCTCkG56+t5yUE5OMD5yQD','EmkEuutdUa','5l2A5Ogl5yMb8lcvQo+7Ta','W7xOR6ZMSRxLKOJLUzbe','kmopjSoyW4NcISocWQBcTSoOW78/wSklW7HIW4bAW7f0w8o1aa','FCkaymoSzmoNW4iFxSoYB8oIWQzoWO1+W5JdJhpdQCkUzuxdVw7dIIyHWPiqW6HHbCkEW5ddRCk5W4XrW5S','W63dJ8omWP3dOG','4PYkg+ADS+IbIoAUJUEIU+wNVUEtOCk9','y8ovtvWr','W7afWPlcOa','iZtcRa','W4nDjq','kmoyfSosW4NdISkwW4NdPa','AGvtW5u','W7pINQJdGUEVU+wkK+wNHEI0Ko++Ha','W6ZdNSoKkmkY','aCoqWQO1FG','W45ldSkYW4S','imkOkSo/wq','gmkyWR/cKCkuvSoxW5VdSSkFpCo2WOtcH8kDofH55Rsk5yIQfWdVV4/LPlBKUiZNL6NOIyRMLkxPGkNLJ7/LIQlLIQm','mL4HW4hdGSkLWPBcHSo0lW','5lI06lcb8jgcQa','WPxcSra','WPFcGaddH8o4oW','W5e7wCkx','5REe5yUB5Bss57M45P2Z','W5Htk8kHW4ZdImkGWRi','WOdcUCoDWQvMtbNcUspdTa','iSkSj8opwa','fw7dGSknWRO','4P2PzEIfQoAFN+I/VEIHGEMdJEwjNos5TUMvKUIVOSoK','m8k9oCoMxG','icVdUcqrW4K','W4ddKmoJWPNdKW','d1qFW4uyCmotgSohW7xcVJ8G','zJvqW4/cJa','bmoJlCkXW5a','z8kEEmoGyG','WPesWO3dJG','n8k6Bq','v8o8vNul','W7ydtSoWrG','WQ7cJSkLW4ZcKmkFW6qoW5tdHG00','yCk/vCoVzG','kcpcSH0','wXHzW7/dKa','s8ovrLCL'],...(function(){return['DCkAsmkfWO7dJConWQhcRSoQW7Ce','pGhcJsddSW','W7HmWPC','s8oJz0lcUq','tmoUW6hdOCk4','WOPHWQVdSmox','CsixWRbH','zSkpW5b9','W51iq2aP','f2ZdLYag','lJRcRWRdJW','q8o0s2G','WORcSmkcWODfeYFcShRdNrRcTMNcHmoDWQOJW4JcQG','W4ddKsJdTmoZjCkcW4i','nMxdOd48','W6PIma','4PILo+IVPowfVEI+JoIHTUs6HoIfUEACNUIoV+wmS+A2HowiSos+NUAcKUE8TEwURowtL+weREI9KEIJGEAVREIeV+ACTE+8Hq','xmkFqhRdOSoJ','EokDP3lNR7FLIiVMIBdLIl7VV4dOJ4hLVzZVVj8','6lsC5y6D5PEC5PEE','expcJmkcW5bu','WRH+WOq2WQudeq','egdcK8kKW6y','ymoIW68','W6jHWOBdNaG','mCkzWRFcNmkL','W40CWPtcJXO','WQf7W6vtW7C','CCkayG','WODhW7jaW5m','xGJcGmoAWQhdUfPtWP/cGsKxxvBdMfhdRH09pMLCW5m3','CtxdI8ogW4S','W78bWOpcSvlcKrtdUx0C','ySkyr2JdVG','WQ5+amkToqBcHXhdVhGYW5a','WQbiW41QW4S','AbqSW4hcHmk5WONdImoUjbVcIZidWORcRSknWOldM8oF','W4KTtG','W4OVumosAW','WP7cPb4wW4NcHrRcHmobW6GbEwFcSebaW6S','lUkFUaFNR4RLI5ZLPllOT6xcMCoUWRK','eCoEkmkLW5K','W7NcO8k4W5xdLX8LsHJcUa','WRvOwCk1WP4','W4epD8oYCq','lSoIjSkbW4e','W7j6EKe','W6ifW7e','rSodW4ucWP7dG8kWW5a','Db7dMSoxW6a','B8oIW6Xq','CmkpymoO','BJW2WRLe','muddMSkjWPZcOmkGcq','mSo6WRDPqv1mtLbhWQvX','xConW7OaWOW','WO3cRaid','tYeTWPDDFmoUm8krkg7cGrLGAvVcNgOtWRr2aSkcWRjrsSoC5O+G5yUa6lAu5yY35BI/5yYD776Y6BM66kYUsW','W4OSW5upCG','uGTnWRbznG','WPmCWOC','ESkND8orwa','WPuxWR/dJ1ZcVSkGW48Gg8kHWORdT2lcU8oVWQinb8oVW4BcSCoqWQxdICkiyINOHzdLRAdKUlBOVjlOOz3PLyhPMQRMLlVPLBi','uIqBWOC','BZfpWPXH','WOTTDCk/','sCoyW41uoW','WQ0BWONdP0C','WPxcUXKbWPhdJq','W6ddSSkQWQq','bJZdLCkGW6BdMa','W4ZdNCo3WQ3dGq','C8kQr8oKyG','FafwW4hcIxdcTa','rSoXW5ddVmkO','W7D2m8op','nmk4DmkBWQO','4PUZWQRORkNLHi/LRRBKUlRLV6pOPQVNM7RNJOVLOyNLJ4tPHzNLKiNLHAZOV5JOOztOHApMN4tVV7O','W712qKe/','WODJD8k2WOpcMfW','kJ7cRYxdImkEWR7dGZ82kumxW6q','emoslmkNW74','yCouELG','5lQ45Psz5Bss566l','yCkfW44','WRy0C8ktiJX5rSonW5OQW5dcMq','rr1JW77cHq'];}())];}())];}());Iii11l=function(){return Ilil1i;};return Iii11l();};async function concMain(II11lI=0x1,lI1IIi,I1l11I,Ilil1l,iIIiii){const l1l1ii=llI11l,iilll={'hQtDk':function(Iil1li,Iiilil){return Iil1li!==Iiilil;},'UjLUZ':l1l1ii(0xda,'CTK$'),'Yowlt':function(Iil1ll,iillI){return Iil1ll>iillI;},'TgeCL':function(lI1III,IIliIi){return lI1III===IIliIi;},'loVvF':l1l1ii(0xaf,'DQ@f'),'xXPQF':function(IllIiI,i1il1){return IllIiI(i1il1);},'InXjc':l1l1ii(0x130,'dvX)'),'AEhpL':l1l1ii(0x106,'W$9o'),'EeXnh':l1l1ii(0x148,'Xba9'),'oRMHt':function(I1l111){return I1l111();},'MuIsn':l1l1ii(0xd2,'7JtH'),'qJNKP':l1l1ii(0x13e,'M[MA'),'CNHFf':l1l1ii(0x17c,'T(Pb'),'FCfKz':l1l1ii(0x110,'7JtH'),'KniZZ':function(IIii1l){return IIii1l();}},il1iI1=lI1IIi[l1l1ii(0xe1,'yWjI')](I1iIII=>I1iIII),IlllIi=decodeURIComponent(common[l1l1ii(0x86,'m6%I')](I1l11I,iilll[l1l1ii(0xc9,'W$9o')])),iIIiil=notify[l1l1ii(0xa4,']3E6')](Ilil1l,IlllIi),i1l1Ii=l1l1ii(0xf6,'CTK$')+Ilil1l+'】'+IlllIi+'：',I1iIIi={'title':i1l1Ii,'UA':common[l1l1ii(0xb4,'W$9o')](IlllIi),'cookie':I1l11I,'index':Ilil1l,'message':iIIiil},I1iIIl=await common[l1l1ii(0x17d,'11bY')](I1l11I);if(!I1iIIl&&iilll['TgeCL'](typeof I1iIIl,iilll[l1l1ii(0xeb,'m6%I')])){console['log'](i1l1Ii+'账号无效\x20🚫');return;}let lI1IIl=0x0;async function i1ilI(liiI11){await iIIiii(liiI11,I1iIIi),lI1IIl--,iii1lI();}async function iii1lI(){const Il1i1I=l1l1ii;if(iilll['hQtDk'](iilll[Il1i1I(0x9d,'NTK*')],Il1i1I(0xfd,'(WdS')))while(lI1IIl<II11lI&&iilll[Il1i1I(0x11f,'l7na')](il1iI1['length'],0x0)){if(iilll[Il1i1I(0xd8,'n]iv')](Il1i1I(0xc2,'GODl'),iilll[Il1i1I(0x164,'coY@')]))ll1l1['log'](Il1i1I(0x105,'H$lx')+IllIIi+Il1i1I(0xf4,'C4lA')+(IllIIl[Il1i1I(0xbb,'%bPU')]||IiiIi1));else{const IIii1i=il1iI1[Il1i1I(0x8e,'%bPU')]();lI1IIl++,await iilll[Il1i1I(0x177,'MWtG')](i1ilI,IIii1i);}}else II11II=0x1;}const i1ilI1=Math['min'](il1iI1[l1l1ii(0x87,'j*tW')],II11lI),Iiilii=[];for(let Iiill1=0x0;Iiill1<i1ilI1;Iiill1++){if(iilll['FCfKz']!=='xSxvb')ii1li[l1l1ii(0x173,'t([c')](IIll1,ll1il);else{const lilII1=il1iI1[l1l1ii(0x9e,'DQ@f')]();lI1IIl++,Iiilii[l1l1ii(0x178,'GODl')](i1ilI(lilII1));}}await Promise['all'](Iiilii),iilll[l1l1ii(0x9f,'W$9o')](iii1lI),await new Promise(iill1=>{const iIIilI=l1l1ii,iii1l1={'ADbVB':function(IIliIl,II11ll){return iilll['xXPQF'](IIliIl,II11ll);},'XuNVK':function(liiI1I,ililII){const Ii1iii=iii1II;return iilll[Ii1iii(0x8d,'7JtH')](liiI1I,ililII);}};if(iilll['TgeCL'](iIIilI(0x135,'yWjI'),iilll[iIIilI(0xfc,'qhN7')])){const i1ilII=iii1l1[iIIilI(0x15e,'L]&o')](i1l1ll,I1iIiI);iii1l1['XuNVK'](i1ilII,0x0)&&(i1ilil['waitTime']=i1ilII);}else{const iIIii1=setInterval(()=>{const Ii1iil=iIIilI,IllIi1={'ZFjSB':function(lilIII,Ii1ilI){const il1l1=iii1II;return iilll[il1l1(0xa6,'DQ@f')](lilIII,Ii1ilI);},'dPseK':function(II11i1,iliIil){return II11i1!==iliIil;}};if(Ii1iil(0xdf,'11bY')!==iilll[Ii1iil(0x12c,'W$9o')])return;else{if(iilll[Ii1iil(0x133,'(WdS')](lI1IIl,0x0)){if(iilll['AEhpL']===iilll['EeXnh']){const il1li=IllIi1['ZFjSB'](i1illI,i1IIl);il1li>0x0&&IllIi1[Ii1iil(0x122,'C#UZ')](il1li,0x1)&&(i1IIi=il1li);}else clearInterval(iIIii1),iilll['oRMHt'](iill1);}}},0x64);}});}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
