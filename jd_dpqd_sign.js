/*
活动名称：批量店铺签到
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割
        jd_dpqd_task_threads // 控制签到并发线程数（正整数），默认1
        jd_dpqd_account_threads // 控制账号并发线程数（正整数），默认1
        jd_dpqd_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认0
        jd_dpqd_max_retry // 签到火爆时的最大重试次数（整数），默认3
        jd_dpqd_prize_notify // 是否推送中奖信息（true/false），默认不推送

此脚本为高并发签到本，需要读取主脚本生成的活动信息缓存，自动过滤无效活动，签到后如有奖品则自动到账


cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到')
var iｉl='jsjiami.com.v7';const i1iIi1=iii1II;(function(IIii11,iliIl1,Ii1il1,iii1ll,IIliI1,il1lI,IliIIl){return IIii11=IIii11>>0x4,il1lI='hs',IliIIl='hs',function(I1il1l,lI1l1l,IIliII,iiliI,Ill11I){const llI11i=iii1II;iiliI='tfi',il1lI=iiliI+il1lI,Ill11I='up',IliIIl+=Ill11I,il1lI=IIliII(il1lI),IliIIl=IIliII(IliIIl),IIliII=0x0;const I1il1i=I1il1l();while(!![]&&--iii1ll+lI1l1l){try{iiliI=parseInt(llI11i(0x1b4,'$)br'))/0x1+-parseInt(llI11i(0x193,'XjKv'))/0x2+parseInt(llI11i(0x1af,'c$Le'))/0x3+-parseInt(llI11i(0x15e,'%wAj'))/0x4+-parseInt(llI11i(0xf0,'^*Jp'))/0x5*(parseInt(llI11i(0x14b,'%sVK'))/0x6)+parseInt(llI11i(0xb1,')wO['))/0x7*(-parseInt(llI11i(0x102,'38&h'))/0x8)+parseInt(llI11i(0xf7,'R*(l'))/0x9;}catch(IliIIi){iiliI=IIliII;}finally{Ill11I=I1il1i[il1lI]();if(IIii11<=iii1ll)IIliII?IIliI1?iiliI=Ill11I:IIliI1=Ill11I:IIliII=Ill11I;else{if(IIliII==IIliI1['replace'](/[gKktHAqnUGylRwCJbDr=]/g,'')){if(iiliI===lI1l1l){I1il1i['un'+il1lI](Ill11I);break;}I1il1i[IliIIl](Ill11I);}}}}}(Ii1il1,iliIl1,function(lI1l1i,i1iil,llI11l,I1llIl,i1iii,I1llIi,IIii1I){return i1iil='\x73\x70\x6c\x69\x74',lI1l1i=arguments[0x0],lI1l1i=lI1l1i[i1iil](''),llI11l=`\x72\x65\x76\x65\x72\x73\x65`,lI1l1i=lI1l1i[llI11l]('\x76'),I1llIl=`\x6a\x6f\x69\x6e`,(0x15bd5d,lI1l1i[I1llIl](''));});}(0xc50,0x1b3d1,Iii11l,0xc7),Iii11l)&&(iｉl=Iii11l);function Iii11l(){const II11il=(function(){return[...[iｉl,'RRqjHyKswJjUyliqranmkCiAt.KcomnA.bHvDgG7==','sSo6W4L3wW','CokCP0BNRiVLI5tLP5ROTBtVVBy','eb59WQxcOG','FmoXW5GUWQC','WR7cImozfmkd','C8kTW5C','w2pdKWpcJq','ACkqWO7dNqy','W53dQWddSmk2','W7zdW6vmW5msW7VdOh/dSdW','W7uzW7tdIY/cVgNcN0b4W4pdNZpcRrlcTr/dMSojlmouy8ojW5G','4PQhW7pOR7tLH4JLR7pKUllLVzlOPOlNMOFNJ6lLOl/LJQhPHPJLKi7LHAhOVBVOOApOHiNMNA3VVA0','DYGjEmoY','WOWkbG','v8oyp1ro','W7/cISoBWObCD8o0ogBdHgzYaSk7rG','44kK5O6R56sC44gG6k6g5yEx6i2a5y+LaXZdTSkPBmkK','q0v1bfpcV8ojWOzrWPrUgq','gSoGW6K8uCoX','WQK5WOyKWQe','W4hdLa0','isBcMa','ydq/W7S+WOG','dCkOW7VcHuxcPCkhxa','tSkrWQ7dKXe','bmkev0/cVd0vhCo4W7RcNceho0ndbSooWRBcTa','gCk/W4KyWOtcN8o4WOWbWQOMsfxdPehcGCoDWPrgWRJdVHKz','qSkkW6CwW6a','d8k2W7n9w8oJwZm','g3ldJSovW7K','oUkDVmoc6k2d5RcW5Asa6lwj776T','WQqsWQ4g','gSkZWRLryCoZW5xcHSoIWQa','D8oEEfKF','W7/cNCofkmkEWRnXrejpWQZdUSorqmoXW5Ll','qfZdKqi','W5uWytK/','rColdhXT','vc/cUCkb','BZq2','t2S8gtC','i8oucCks','WODjhKneWQ/cUh0qp8osWRu','xCksW5m/W7G','emk7w8oxf0a','bCkhW6iD','WORcKf8','W7xdM8obW5JcOYtcU8k+WOrNW5dcOYTrW5FdTSkYv8kLW5C','vH5jf3e','5Rs75yQc5BEP57QJ5P2P','aCoRW6SSrSo2W6O','vmkrpSk3W4i','DvTbcfe','zCk3W5msW5S1W5K+mW','WQNcISkVWQKy','W6FdOCklxM98W4JcM8o9o8kq','WRtINjZdHUETHEwjSUwKOUI2N++/UG','W7JdR8kb','gCk/W4KyWOtcN8o4WOWbWQOMsfxdPehcOW','W6JcISopWO1WBCo2ia','bSo/W4aHra','je7dSq','5yAI57Mk5y+78ywMLG','wIhcPmko','qmokW4ykWRq','WQXJfb54','5RAp5yUt5PYm5B2X5AA6','F8kAW6WyW7K','xcBcHmkfzG','W7VdK8osW67cMW','fSoGmCkYxepdR0LUpSoXma','pmo2ndVcPq','W4yjesRdOq','WQRcUhCEda','W4hdRXZdPmkNW6u','DmkbvSooe8kDW6NcLJldPGi','vuxdLYJcMW','f8oDW40T','lmogf8kErmkd','y8oBW4O1WPG','WOGeWQm3WOq','yCkkv0FdNmoBeYzIWOqIjG','zHmJzSoDWO8nW6VcPW','WRhcRCovW5hdOSo/','jColaHtcKmkoeHf1WR4VjSkP','W5ldKqW','wCkNW7m+W4C','oCkCW7W6bG','qH5uae3dTmkcfa','j8kVW5ldPwG','oCkMzgxcHq','W5RMTzZLI5/LPQ7NGi7NIAe'],...(function(){return[...['WPJdKYf4qW','W5mpdSokkq','qSkeWOL6WQ4PW7HLWOFdIq','sfH5hLe','ECoXjgq','sh3dMI7cMq','W7NdM8od','jvldSq','vfiNmbe','nUkDN8kb56Yf5yQf5AwJ6lAv772q','v8kWlCkCW6j4xa','CmoMkG','ox7dKSo0W5m','j8oAdWhcSmkcpbS','D8ksW4a9W7G','5y+V6ywF6k2i5PMIW5ddJSk2WP5UW7j5eatcQG','WOisgSoreW','pSopW5SbzW','BCoeW7v6sG','n8kHWOnjFq','u8oDnrBdSxfmF8k1WRu','4PQvx+IVIUweVoI/IEIJKEs7LoIfQ+ADLUIpPUwmPoA3OEwjGUs9O+AdK+E/N+wSQowtM+whRoI9HEIHIEATJUIgPUACN++9JG','W5FdR8kitYD9W47dN8ook8koiG','5lQz6lc58jcbGG','vmkQpG','pLZdV8ofW4ddOZea','FWmoA8odWPKaW5lcQSojWQddL2tcIHddKCkfjSkoWPK','t8o2W78zoW','cLpdRSoJW7a','r8oLW48e','rJH9WO82','WQHUpb9hr8kC','CCkkiCkvW60','AhumlG4dmmo/WQ0FlSkprmo7vH9un8kVsCouWRvA','b8oxcSk1vW','wdRcUCkqt8oZvMDdoCojWRLDyXS2rKpcO8kAW57dUSkcma','xmowB28','FCkMW4qlWPGZW5WXpmoZ','jCkbWPbwW6W','rgNdVHBcTq','emoYW50dWPa','eSopW4OLWOia','W6NcM8ovWPO','WQdcSmoEa3SLWOVcK8oahSkWmCob','tLBdHHtcLHvE','pslcJmo6W6m','WQJcT8k4eIu','eComW40Hza','jmojeXa','ksNcNG','imk6suhcOq','4P6wWRVOHAhMNl7OV7tOO43PGB3LI77KUP7PLPBOR5vw','lLJdOSo9W7VdRtula8okW651qIu','ycJcGCkvCq','oYBcGCoFW47cN8kRWQW','WR7cI8oxW53dMG','m2TH','WPqHimoPpa','uCo3W7frAq','fSo0mqpcJa','WOiTdmooeq','aCknW4C','W4ddJCkGtXC','bqP5WPNcKW','ESkSW4y','w8otoXVdUtKfjmoLW6ZcUW','qbabW5up','WRRcLSoCnW','WR/dQqL9vG','WO3INkDk566y5yQx5OI35yM2','WQnfotrx','vSoBW7SKWQm','vCowWQ5ewcRcIZu4WOrPDmkP','W7a+oJVdSK0','bmkcySopjq','DvjUnhu','WRv/fdrn','omo3lmkFEW','amkSW4tdHuK','vSoTW74','44ga6lAD5y6r','zXG1W5CL','iSoZpIlcOa','WQhcUCoFctbvW63cNSoQnG','W4hINypdMEESJUwjVoAjTEwlI++9T+IpJow9G++9VG','ueLIkMe','W5ucaW','CJPP','fJ5A','amkrW4C','DfXkWRXJcd7dNq','WQNcVCo0fCk5','W4hdQY7cISoY','WRvjfrn6'],...(function(){return['W5KAvG','xSoJW61v','4P6QW5/MNjlOGQJMRiNNOyBLP5dNKjPJ','C09kWRjsltRdI1C','W6VcHSoiWQ1WD8oZpwBdSxnzhSk4','vmoEBN4YW60','zxqN','W4hdPru','WQJcLNmMkq','W50vvrqdW6S','FWmoA8odWPKaW5lcQSojWQddL2tcIHddKCkfjSkoWPNdU8o4W43cVEAnTowlHEEULEwlK+w4U+wmOo+9HoM5REIUVSoJ','WOOvaSoiha','rMmFW5/dRCk1W6WrmCk4oW','WQz7nXD1','WOZcJfC7gHNdPcXW','fmo8i8kasa','WR/dTq0','44gJ5O2E56AG44gi6k+u5yEn6iYP5y+mn37cNXuqyq','q1jteLi','r8o8W4GbWPS','W7hdRSkq','5yE3pUwnH/cJN7a','vSoNW7DtD8oP','r3f1WQ51','dCkjW7e','W6SIbmoXjW','W47dHcpdICkP','mEkFLaZORjRMSl/LP7VOTztVVjdML5FLKlhLUlRMLl3MJ5/VVz/WMlM+','f+kCJmkC56Ys5yUD5AEc6lAUWOn+W68','uanlWOu0','vCosW6SuWQO','W7NdJmoxW4JcIa','gmo9W60yWOe','jIpcT8opW6RcH8kIWPBcJCodWQyWWR8CpmkJWRxcHWfMW6RdRdNdR8oJW4tcVoAnR+wjOoI1TowoSow6UEwoNE+/U+M6I+ITKfK','W6dcGSoSWQfg','6lEA5y6m5PEz5PwY','ztC+W7iL','aCozW5GOWQmhW4nnWRRdGmo+W4u','WQP9WORdHH8','Dh1tp3C','dCk5rmoB','W6/dGmowW57cTdBcQW','WPddRdvhxq','AK5efeBcOmozW7rOWOXMi3pcN8ozhci','W6CQpZxdGq','AmoWpxu','W7e6BqaZ','rCowA34dW7yuW7S','Fs1cWOOjWQi','WRrcWQ/dQZBcS20','WRlcU8oIiCk9','WOlcH8kAWO0','rmk8z8oL','s8k8zmofgWK','W5WpuGecWQxdMbWOrSk3WQ8RWQSrmuDGWRddTW','WQRcNmkwaG0','i1NdICovW6tdUZG6mCoDW6XUqJGLiSk3WPFcGCk/iSkmsrS','mGutW758jGtdTu3dRq','ut3cVSkjw8kN','WOpdJrniuW','WRNdTb93','ht9B','smoIWQDvxmoIW67cLW','BwRdVbpcJq','4PMgW5/OH5lLR4/KUkpOV7JOOPJPL6JPM5FMLkRPL5/OR6tNV6FPLBxORjS','WP9gWRBdJGK','w8omgq','WPZcK8oeW7FdHW','W4uZst47','WQXKoG','zCoXBKqE','nmkgW5ldKKC','W4BdUclcK8oU','WRZORylMS7FLKBdLUyvL','W78Qvdu8','BSozW7SBWOy','BZ4/W7OJWOC','WPDWWPtdPJW','tmk5WPpdGGC','W6JcGSoiWO8','W7VINQVdU+EVK+wjQUAlGUwkLE+/P+IoNUw+Go++TW','uSoPgmkmxWrIWOziF0jk','lLJdOSo5WQhdUsG','BwrXWOnb','WOxcKfWW','WOlcVfWFga','A8oOjgrxcgxcOa','WPBcVSkqbbGmor4','6lE95y+a5Ps75PELEVglUQe','pdhcNmo/W5m','ovZdPmoqW7NdUrGejmoF','C8oZW6GoWOS'];}())];}())];}());Iii11l=function(){return II11il;};return Iii11l();};const jdCookie=require('./jdCookie'),notify=require(i1iIi1(0x173,'arw]')),common=require(i1iIi1(0x183,'*t5e')),{H5st}=require(i1iIi1(0x1a3,'*t5e'));console[i1iIi1(0x114,'m))S')](''),console[i1iIi1(0x108,'lY9F')]('=========='+$[i1iIi1(0x135,'%wAj')]+i1iIi1(0xbe,'*t5e')),console[i1iIi1(0x190,'OHhJ')]('jd_dpqd_tokens\x20//\x20活动ID，多个用英文逗号分割'),console['log'](i1iIi1(0x117,'Ke&0')),console[i1iIi1(0xfe,'fIes')](i1iIi1(0x12e,'Gqsa')),console[i1iIi1(0xc7,'b5SG')]('jd_dpqd_account_interval\x20//\x20自定义运行间隔时长'),console[i1iIi1(0x1a2,'38&h')](i1iIi1(0xc3,'^*Jp')+$['name']+'提示结束=========='),console[i1iIi1(0x152,')0W%')]('');let tokensList=(process[i1iIi1(0xb5,'F]Jf')]['jd_dpqd_tokens']||'')[i1iIi1(0x170,'NcKz')](/[,@&|\n]+/g)['filter'](Boolean),taskThreads=process[i1iIi1(0x121,'38&h')][i1iIi1(0xc9,'Ke&0')]||'1',accountThreads=process[i1iIi1(0x11d,'(6dP')][i1iIi1(0xd0,'jOdG')]||'1';function iii1II(_0x47f1f3,_0x1e7547){const _0x5e8b24=Iii11l();return iii1II=function(_0x4e645e,_0xe764f1){_0x4e645e=_0x4e645e-0x9f;let _0x58674b=_0x5e8b24[_0x4e645e];if(iii1II['QzIhmt']===undefined){var _0x36a87d=function(_0x3179d7){const _0x4c4901='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x959d73='',_0x2e8d76='';for(let _0x44a50b=0x0,_0x13b410,_0x4a1d20,_0xc5a68c=0x0;_0x4a1d20=_0x3179d7['charAt'](_0xc5a68c++);~_0x4a1d20&&(_0x13b410=_0x44a50b%0x4?_0x13b410*0x40+_0x4a1d20:_0x4a1d20,_0x44a50b++%0x4)?_0x959d73+=String['fromCharCode'](0xff&_0x13b410>>(-0x2*_0x44a50b&0x6)):0x0){_0x4a1d20=_0x4c4901['indexOf'](_0x4a1d20);}for(let _0x3961ae=0x0,_0xff191d=_0x959d73['length'];_0x3961ae<_0xff191d;_0x3961ae++){_0x2e8d76+='%'+('00'+_0x959d73['charCodeAt'](_0x3961ae)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2e8d76);};const _0x433e9b=function(_0x1b0beb,_0x45ab72){let _0x52f974=[],_0x46efec=0x0,_0x218e05,_0x264eac='';_0x1b0beb=_0x36a87d(_0x1b0beb);let _0x4b59f2;for(_0x4b59f2=0x0;_0x4b59f2<0x100;_0x4b59f2++){_0x52f974[_0x4b59f2]=_0x4b59f2;}for(_0x4b59f2=0x0;_0x4b59f2<0x100;_0x4b59f2++){_0x46efec=(_0x46efec+_0x52f974[_0x4b59f2]+_0x45ab72['charCodeAt'](_0x4b59f2%_0x45ab72['length']))%0x100,_0x218e05=_0x52f974[_0x4b59f2],_0x52f974[_0x4b59f2]=_0x52f974[_0x46efec],_0x52f974[_0x46efec]=_0x218e05;}_0x4b59f2=0x0,_0x46efec=0x0;for(let _0x18c985=0x0;_0x18c985<_0x1b0beb['length'];_0x18c985++){_0x4b59f2=(_0x4b59f2+0x1)%0x100,_0x46efec=(_0x46efec+_0x52f974[_0x4b59f2])%0x100,_0x218e05=_0x52f974[_0x4b59f2],_0x52f974[_0x4b59f2]=_0x52f974[_0x46efec],_0x52f974[_0x46efec]=_0x218e05,_0x264eac+=String['fromCharCode'](_0x1b0beb['charCodeAt'](_0x18c985)^_0x52f974[(_0x52f974[_0x4b59f2]+_0x52f974[_0x46efec])%0x100]);}return _0x264eac;};iii1II['KkSvJB']=_0x433e9b,_0x47f1f3=arguments,iii1II['QzIhmt']=!![];}const _0x5f3531=_0x5e8b24[0x0],_0x5a62de=_0x4e645e+_0x5f3531,_0xe2804b=_0x47f1f3[_0x5a62de];return!_0xe2804b?(iii1II['xkiMAy']===undefined&&(iii1II['xkiMAy']=!![]),_0x58674b=iii1II['KkSvJB'](_0x58674b,_0xe764f1),_0x47f1f3[_0x5a62de]=_0x58674b):_0x58674b=_0xe2804b,_0x58674b;},iii1II(_0x47f1f3,_0x1e7547);}const runInterval=process[i1iIi1(0x107,'7Cbv')][i1iIi1(0x145,'21cL')]||'',isNotify=process[i1iIi1(0xe0,'Gqsa')][i1iIi1(0x182,'^*Jp')]===i1iIi1(0xdf,'%Q%U');let signHotMaxRetryTimes=process[i1iIi1(0x16e,'eVDb')][i1iIi1(0x138,'AeMF')]||'0',TokensMap=null;const signStatusMessages={0x1805c007:'今日已签',0x1843da61:i1iIi1(0x1ab,'XjKv'),0x1843da62:i1iIi1(0x19a,'AeMF'),0x184253c7:i1iIi1(0x130,'&igR')},CacheFile=__dirname+i1iIi1(0x18b,'6IE^'),cookiesArr=Object[i1iIi1(0x188,'J&f%')](jdCookie)[i1iIi1(0x10d,'XjKv')](lllili=>jdCookie[lllili])[i1iIi1(0x112,'v[8I')](IliiiI=>IliiiI);!cookiesArr[0x0]&&($[i1iIi1(0xec,'lY9F')]($[i1iIi1(0x192,'$)br')],i1iIi1(0x179,'XjKv')),process[i1iIi1(0xd9,'WD5d')](0x1));!(async()=>{const l1l1il=i1iIi1,Ill11={'YBAln':function(liiIII,li1i11,iI11I1,il1i1l,IlIlll,IIIl1I){return liiIII(li1i11,iI11I1,il1i1l,IlIlll,IIIl1I);},'Hrbng':l1l1il(0x11e,'u79%'),'hEfKB':'eTeqf','DLVfB':l1l1il(0x15b,'NcKz'),'uBHhX':function(iil1ii,IlIlli){return iil1ii>IlIlli;},'JtPbD':l1l1il(0x174,'c$Le'),'LGOKf':function(il1i1i,lil111){return il1i1i(lil111);},'HbQAi':l1l1il(0xc4,'we*v'),'nYRKv':function(i11ilI,ii1ii1){return i11ilI>ii1ii1;},'uxuDC':function(llllI,lllil1){return llllI>lllil1;},'fpjlW':'Ropay','TqLgc':function(iil1il,ilil1I){return iil1il!==ilil1I;},'CnxRd':l1l1il(0x191,'jOdG'),'MEsuB':function(i11il1,ii1iiI){return i11il1!==ii1iiI;},'nqlMy':l1l1il(0x184,'eVDb')};try{if(Ill11['hEfKB']===Ill11[l1l1il(0x124,'zaq(')])llIli1[l1l1il(0x13c,'v[8I')]=iliIII;else{notify[l1l1il(0x17f,'OHhJ')]({'title':$[l1l1il(0xd3,'v[8I')]});if(Ill11[l1l1il(0x10c,')0W%')](tokensList['length'],0x0))tokensList=[...new Set(tokensList['filter'](illlI1=>illlI1!==''))];if(tokensList[l1l1il(0x1b3,'m))S')]<=0x0){console['log'](Ill11['JtPbD']);return;}const ilil11=Ill11[l1l1il(0x1b2,'[M6b')](require,'fs');if(ilil11['existsSync'](CacheFile)){if(l1l1il(0x11f,'AeMF')!==l1l1il(0x118,'dkI[')){const IIIl11=ilil11[l1l1il(0x132,')wO[')](CacheFile,l1l1il(0xca,'fIes')),I1lIi1=JSON[l1l1il(0x171,'m))S')](IIIl11);TokensMap=new Map();for(const liiIIi in I1lIi1){TokensMap[l1l1il(0x105,'tRW2')](liiIIi,I1lIi1[liiIIi]);}}else{I1lliI[l1l1il(0xc7,'b5SG')](''+llIllI+I1ilI1+l1l1il(0x103,')U9T')+iillll[l1l1il(0xf2,'6IE^')]('，'));for(const Iliii1 of l1lIlI){lIIil1[l1l1il(0x17b,'u79%')](Iliii1);}}}else{console[l1l1il(0x114,'m))S')](Ill11[l1l1il(0x19f,'Cn$O')]);return;}$[l1l1il(0x164,')U9T')]=null;if(runInterval)try{const iIiIi=Ill11[l1l1il(0x15a,'arw]')](parseInt,runInterval);Ill11[l1l1il(0xfc,'$)br')](iIiIi,0x0)&&($[l1l1il(0xbc,'%Q%U')]=iIiIi);}catch{console[l1l1il(0xfe,'fIes')](l1l1il(0x14d,'[M6b'));}try{const iil1ll=parseInt(signHotMaxRetryTimes);signHotMaxRetryTimes=Ill11[l1l1il(0x160,'zaq(')](iil1ll,0x0)?iil1ll:0x0;}catch{signHotMaxRetryTimes=0x3;}try{const iiilil=Ill11[l1l1il(0x1b2,'[M6b')](parseInt,taskThreads);if(Ill11[l1l1il(0xfa,'AeMF')](iiilil,0x0)&&iiilil!==0x1){if(Ill11[l1l1il(0x11a,')0W%')]!==Ill11['fpjlW']){I1l1I1[l1l1il(0x197,'[M6b')](''+I1i111+ilI1li+l1l1il(0xb8,'eVDb')+IIliI['msg']+'）');if(!ilI1ll[Iillii['code']])IlI1iI=!![];}else taskThreads=iiilil;}}catch{taskThreads=0x1;}try{const lillIl=parseInt(accountThreads);Ill11[l1l1il(0xe8,'dkI[')](lillIl,0x0)&&Ill11[l1l1il(0x181,'NcKz')](lillIl,0x1)&&(Ill11[l1l1il(0xcb,'21cL')]!=='IkFlx'?accountThreads=lillIl:ii1li[l1l1il(0xd8,')wO[')](IIll1,ll1il));}catch{accountThreads=0x1;}await common[l1l1il(0x180,'HM^b')](accountThreads,cookiesArr,async(iiilii,li1i1i)=>{const I11i1I=l1l1il;await Ill11[I11i1I(0x18e,'5IO[')](concMain,taskThreads,tokensList,iiilii,li1i1i,Main);if($[I11i1I(0x163,'5IO[')])$['wait']($[I11i1I(0x109,'zaq(')]);}),isNotify&&notify[l1l1il(0x189,'%sVK')]()&&(Ill11[l1l1il(0x126,'tRW2')]('FWcHq',Ill11[l1l1il(0x16d,'6IE^')])?(notify[l1l1il(0xa7,'%Q%U')](notify['content']),await notify['push']()):(lilIl1['msg'](i1l1ii['name'],Ill11[l1l1il(0xb2,'AeMF')]),i1l1[l1l1il(0xb3,'5IO[')](0x1)));}}catch(illIiI){console['log'](l1l1il(0xe2,'(6dP')+illIiI);}})()[i1iIi1(0x199,'we*v')](lI1lli=>$[i1iIi1(0x142,'c$Le')](lI1lli))['finally'](()=>$['done']());async function Main(Ill1l,llI1Il){const iliIi1=i1iIi1,ii1iii={'WFlNI':function(iil1lI,iiiliI){return iil1lI(iiiliI);},'gZKqB':function(li1i1I,illIii){return li1i1I>illIii;},'PcyZW':'⚠\x20请先定义必要的环境变量后再运行脚本！','bBWxG':function(ii1il1,lI1llI){return ii1il1(lI1llI);},'xVzVo':function(illIil){return illIil();},'cNQJz':'⚠\x20自定义运行间隔时长设置错误','vvbOl':iliIi1(0x1ae,'F]Jf'),'WqWKL':iliIi1(0x186,'21cL'),'cNdOu':iliIi1(0x178,'WD5d'),'KQrDM':function(Ill1I,i11iiI){return Ill1I===i11iiI;},'fbFhV':iliIi1(0x13b,'XjKv'),'zWCrH':iliIi1(0xee,'7Cbv'),'KCorA':function(lIli11,lllI1I){return lIli11===lllI1I;},'CKPHX':iliIi1(0x1b0,'%Q%U'),'WDXxt':iliIi1(0x168,'*t5e'),'aQaFM':iliIi1(0x134,'AeMF'),'PfLuM':'优惠券🗑️','aKGHN':function(lillI1,IlIlii){return lillI1!==IlIlii;},'lTgmL':'DxQUe','UjKAH':function(i1l1i1,liil11){return i1l1i1!==liil11;},'XzjFg':iliIi1(0xcf,'b5SG'),'XNTOb':iliIi1(0x1ac,'eVDb'),'qkzRQ':iliIi1(0x175,'Ke&0'),'wZzfY':function(iiillI,l1l111){return iiillI>l1l111;},'fNQQB':iliIi1(0x106,'we*v'),'MLrkX':'4da33','JbnBt':'interact_center_shopSign_signCollectGift','pvtTI':'interCenter_shopSign','WpQbK':iliIi1(0xd2,'#3ql'),'ttweP':iliIi1(0x11b,'[M6b'),'lRddl':'Vcndn','Xxrsb':iliIi1(0xbb,'21cL'),'EizSH':iliIi1(0x158,'*t5e'),'NZAjm':'*/*','pxPCX':'gzip,\x20deflate,\x20br','OYXIZ':'zh-CN,zh-Hans;q=0.9','FOWvh':iliIi1(0xd4,'eVDb'),'ySzNu':'text/plain','DFzZk':'api.m.jd.com','cSKAx':iliIi1(0x143,'XjKv'),'laPOY':iliIi1(0x195,'%wAj'),'IhAbi':iliIi1(0x1a0,'38&h'),'JwNUy':function(l1iIII,llI1I1){return l1iIII===llI1I1;},'kNoIn':iliIi1(0xfb,')0W%'),'qHoOJ':iliIi1(0xc5,'38&h'),'qJQkE':function(IlIlil,lIli1I){return IlIlil<lIli1I;},'NatOy':iliIi1(0x1aa,')0W%'),'iXJur':function(II1il,lllI11,I1lIll){return II1il(lllI11,I1lIll);},'PrhVh':function(I1lIli,II1ii){return I1lIli>=II1ii;},'YxyiQ':'mdIjZ','kATTd':function(IIIIII,lillII){return IIIIII/lillII;},'SbTAt':function(ii1ilI,lI1ll1){return ii1ilI||lI1ll1;},'ZjKCy':iliIi1(0x16f,'2kR9'),'cQrJf':iliIi1(0xb0,'tRW2'),'NYItz':function(iIiI1,liil1I){return iIiI1<liil1I;},'lPDlU':function(i11ii1,IlIliI){return i11ii1!==IlIliI;},'OdREr':'ywQyF','OUSCs':iliIi1(0xdc,'Gqsa')},{title:i11iil,UA:Ill1i,cookie:ii1iil,message:lllI1l}=llI1Il,i11iii=TokensMap[iliIi1(0x113,'jOdG')](Ill1l);if(!i11iii)return;const llI1Ii=Math[iliIi1(0x131,'OHhJ')](ii1iii[iliIi1(0x12d,')wO[')](Date[iliIi1(0x14a,'7Cbv')](),0x3e8))+iliIi1(0xe7,'OHhJ'),{venderId:lllI1i,activityId:li1i1l}=i11iii;if(ii1iii['SbTAt'](!lllI1i,!li1i1l))return;let II1i1=![];await ii1iii[iliIi1(0x13f,'6IE^')](iIiII,ii1iii[iliIi1(0xd7,')wO[')]);if($[iliIi1(0xe5,'Gqsa')])$['wait']($[iliIi1(0xab,'we*v')]);if(II1i1&&signHotMaxRetryTimes>0x0){if(ii1iii['ZjKCy']!==ii1iii['cQrJf']){let l1iII1=0x0;while(ii1iii[iliIi1(0x14c,'2kR9')](l1iII1,signHotMaxRetryTimes)){if(ii1iii[iliIi1(0x10b,'hlfk')](ii1iii[iliIi1(0xa9,'eVDb')],ii1iii['OUSCs'])){await ii1iii[iliIi1(0xde,'u79%')](iIiII,ii1iii[iliIi1(0xf5,')0W%')]);if($['waitTime'])$['wait']($['waitTime']);if(!II1i1)break;l1iII1++;}else Iil1I1=Ii1iII;}}else{const IIIII1=ii1iii[iliIi1(0x153,'v[8I')](Ii1iIi,iliIIl);Ii1iIl=ii1iii[iliIi1(0xd6,'2kR9')](IIIII1,0x0)?IIIII1:0x0;}}async function lI1lll(I1lIlI,ii1ill){const l1l1ii=iliIi1,II1iI={'DqmcS':ii1iii[l1l1ii(0x104,'AeMF')],'NiKsC':function(llI1II,lIli1l){return llI1II===lIli1l;},'TMFtU':function(lillIi,illIi1){const Il1i1I=l1l1ii;return ii1iii[Il1i1I(0x12b,'*t5e')](lillIi,illIi1);},'NLtGQ':function(ii1ili){return ii1iii['xVzVo'](ii1ili);},'eybuY':ii1iii[l1l1ii(0x127,'m))S')]};if(ii1iii['vvbOl']!==ii1iii[l1l1ii(0x9f,'2kR9')]){Iiii1[l1l1ii(0xb6,'21cL')](lIIili+'账号无效\x20🚫');return;}else try{if('bImdL'!==ii1iii['WqWKL'])switch(I1lIlI){case ii1iii[l1l1ii(0xd7,')wO[')]:if(ii1ill['code']===0xc8&&ii1iii[l1l1ii(0x157,'XjKv')](ii1ill[l1l1ii(0x136,'F]Jf')],!![])){if(ii1iii['fbFhV']===ii1iii['zWCrH']){IiilI1['log'](II1iI[l1l1ii(0x14e,'arw]')]);return;}else{const i1l1iI=[];if(ii1ill[l1l1ii(0x15c,'WD5d')]&&ii1iii[l1l1ii(0xf9,'%wAj')](ii1ill[l1l1ii(0x196,'R*(l')]['length'],0x0)){if(ii1iii[l1l1ii(0x144,')U9T')](l1l1ii(0x12a,'tXTG'),'JyphI'))Iii11I=0x1;else for(const lI1lii of ii1ill[l1l1ii(0x18f,'#3ql')]){if(ii1iii[l1l1ii(0x194,'eVDb')](ii1iii[l1l1ii(0xf1,'OHhJ')],ii1iii[l1l1ii(0x1b1,'z*P*')]))II1lii[l1l1ii(0x125,'R*(l')](''+lIIii1+ll1i1+l1l1ii(0x129,'*t5e')+IIli1i[l1l1ii(0xa5,'Ke&0')](I1iIi1));else{const Iil1l1=lI1lii?.[l1l1ii(0x110,'zaq(')]||[];for(const i1i11I of Iil1l1){if(ii1iii[l1l1ii(0x177,'5IO[')](l1l1ii(0xe9,'fIes'),ii1iii[l1l1ii(0xbd,'eVDb')]))l1i111=iliII1;else{const iii1ii=i1i11I?.[l1l1ii(0x13a,'5IO[')],il1iIi=i1i11I?.[l1l1ii(0x1a4,'WD5d')];let iii1il='';switch(iii1ii){case 0x1:iii1il=ii1iii[l1l1ii(0xe4,'#3ql')];break;case 0x4:iii1il=il1iIi+l1l1ii(0xc6,'we*v');break;case 0x6:iii1il=il1iIi+'店铺积分🎟️';break;case 0x9:iii1il=i1i11I?.[l1l1ii(0x198,'F]Jf')][0x0]?.['skuName']+'🎁';break;case 0xa:iii1il=il1iIi+l1l1ii(0x122,'XjKv');break;case 0xe:iii1il=il1iIi/0x64+l1l1ii(0x1a7,'Cn$O');break;default:iii1il='未知奖品（'+iii1ii+'）';}i1l1iI['push'](iii1il);}}}}}if(i1l1iI[l1l1ii(0x123,'fIes')]>0x0){console['log'](''+i11iil+Ill1l+l1l1ii(0x15d,'arw]')+i1l1iI[l1l1ii(0x1a8,'#3ql')]('，'));for(const II11li of i1l1iI){ii1iii[l1l1ii(0x18d,'XjKv')](ii1iii[l1l1ii(0x19c,'b5SG')],ii1iii[l1l1ii(0xe6,'@dfn')])?II1iI[l1l1ii(0x115,'[M6b')](IilIl1,0x0)&&(II1iI[l1l1ii(0xed,'38&h')](l1l11I,lilIl),II1iI[l1l1ii(0x150,'@dfn')](IilIlI)):lllI1l[l1l1ii(0x116,'XjKv')](II11li);}}else console[l1l1ii(0x17d,'hlfk')](''+i11iil+Ill1l+l1l1ii(0xf4,'hlfk'));II1i1=![];}}else{if(ii1ill[l1l1ii(0x140,'Cn$O')]!==0xc8){if(ii1iii['UjKAH'](ii1iii['XzjFg'],ii1iii[l1l1ii(0xaa,'R*(l')]))llIlli[l1l1ii(0x13e,'arw]')]=!![];else{const liiI1i=signStatusMessages[ii1ill[l1l1ii(0x141,'c$Le')]]||ii1ill[l1l1ii(0x149,'(6dP')]+'|活动太火爆';console['log'](''+i11iil+Ill1l+l1l1ii(0x1a1,'38&h')+liiI1i+'）');if(!signStatusMessages[ii1ill['code']])II1i1=!![];}}else{if(ii1ill[l1l1ii(0x1a6,'21cL')]){console['log'](''+i11iil+Ill1l+l1l1ii(0x16a,'%Q%U')+ii1ill['msg']+'）');if(!signStatusMessages[ii1ill[l1l1ii(0x161,'[M6b')]])II1i1=!![];}else console['log'](''+i11iil+Ill1l+'\x20➜\x20签到失败\x20-\x20'+JSON[l1l1ii(0x19e,'eVDb')](ii1ill));}}break;}else I1lllI[l1l1ii(0xef,'eVDb')](II1iI[l1l1ii(0x12c,'F]Jf')]);}catch(lilIIl){ii1iii[l1l1ii(0xd5,'[z4G')]!==ii1iii['qkzRQ']?console[l1l1ii(0x17d,'hlfk')](l1l1ii(0x10f,'[M6b')+I1lIlI+'\x20请求响应\x20'+(lilIIl['message']||lilIIl)):Iliiil=0x3;}}async function iIiII(liiI1l){const Ii1iii=iliIi1,i1l1II={'JbhBr':function(il1iII,iilli){return il1iII(iilli);},'cqrPw':function(IlllIl,II11lI){return IlllIl>II11lI;}};let i1ill='',I1l11l=null,lilIIi=null,i1l1Il=ii1iii[Ii1iii(0x17c,'J&f%')],llIli={},i1i11l={};switch(liiI1l){case ii1iii[Ii1iii(0xeb,'dkI[')]:i1i11l={'appId':ii1iii['MLrkX'],'functionId':ii1iii[Ii1iii(0xd1,'$)br')],'appid':ii1iii[Ii1iii(0x166,'Gqsa')],'body':{'token':Ill1l,'venderId':ii1iii[Ii1iii(0xc1,'fIes')](parseInt,lllI1i)||'','activityId':ii1iii['bBWxG'](parseInt,li1i1l)||'','type':0x38,'actionType':0x7},'version':Ii1iii(0xa8,'[M6b'),'ua':Ill1i},llIli=await H5st[Ii1iii(0x15f,'21cL')](i1i11l),i1ill=ii1iii[Ii1iii(0xcd,'tXTG')],lilIIi=Object[Ii1iii(0xf8,'z*P*')]({},llIli[Ii1iii(0x167,'21cL')],{'jsonp':ii1iii['ttweP']});break;}const i1i11i={'t':llI1Ii,'loginType':'2'};if(I1l11l){if(ii1iii[Ii1iii(0xac,'lY9F')](ii1iii[Ii1iii(0xfd,'lY9F')],ii1iii[Ii1iii(0x154,'lY9F')]))try{const I1l11I=ii1iii[Ii1iii(0xad,'^*Jp')](iii1Ii,iii1Il);ii1iii[Ii1iii(0x1a9,'*t5e')](I1l11I,0x0)&&(i1lI[Ii1iii(0xc8,'21cL')]=I1l11I);}catch{lilIil[Ii1iii(0xc7,'b5SG')](ii1iii[Ii1iii(0x16b,'7Cbv')]);}else Object['assign'](I1l11l,i1i11i);}if(lilIIi){if(ii1iii[Ii1iii(0x18a,'v[8I')]===Ii1iii(0x11c,'$)br'))Object[Ii1iii(0x147,'#3ql')](lilIIi,i1i11i);else{const iIIiii=llIlil[IIlil['code']]||ilI1lI[Ii1iii(0x18c,'2kR9')]+Ii1iii(0xae,'tRW2');IiiIll[Ii1iii(0x125,'R*(l')](''+IIlii+IlI1il+'\x20➜\x20签到失败（'+iIIiii+'）');if(!IilliI[IlI1ii['code']])lIIiii=!![];}}const II11l1={'url':i1ill,'method':i1l1Il,'headers':{'Accept':ii1iii[Ii1iii(0xe1,'^*Jp')],'Accept-Encoding':ii1iii[Ii1iii(0x169,'fIes')],'Accept-Language':ii1iii['OYXIZ'],'Connection':ii1iii[Ii1iii(0xea,'%Q%U')],'Content-Type':ii1iii['ySzNu'],'Host':ii1iii['DFzZk'],'Referer':ii1iii['cSKAx'],'Sec-Fetch-Dest':ii1iii[Ii1iii(0x12f,'WD5d')],'Sec-Fetch-Mode':'no-cors','Sec-Fetch-Site':ii1iii[Ii1iii(0xdd,')U9T')],'User-Agent':Ill1i,'Cookie':ii1iil},'params':lilIIi,'data':I1l11l,'timeout':0x7530};ii1iii[Ii1iii(0xc2,'%sVK')](i1l1Il,Ii1iii(0x14f,'5IO['))&&(Ii1iii(0xfb,')0W%')!==ii1iii[Ii1iii(0xb4,'2kR9')]?ll1l1['log']('❌\x20未能正确处理\x20'+IllIIi+Ii1iii(0x156,'F]Jf')+(IllIIl[Ii1iii(0xdb,'2kR9')]||IiiIi1)):(delete II11l1['data'],delete II11l1['headers'][ii1iii[Ii1iii(0x151,'XjKv')]]));const Iil1lI=0x3;let IiiliI=0x0,iii1iI=null,llIll=![];while(ii1iii[Ii1iii(0x133,'arw]')](IiiliI,Iil1lI)){const il1iI1=await common[Ii1iii(0x19b,'u79%')](II11l1);if(!il1iI1['success']){iii1iI=''+i11iil+Ill1l+Ii1iii(0x187,'NcKz')+il1iI1[Ii1iii(0xf3,'(6dP')]+'）🚫',IiiliI++;continue;}if(!il1iI1[Ii1iii(0x10e,'fIes')]){if(ii1iii[Ii1iii(0xf6,'*t5e')](Ii1iii(0x1ad,'#3ql'),ii1iii['NatOy'])){const iIIiil=i1l1II['JbhBr'](i1l1ll,I1iIiI);i1l1II[Ii1iii(0xbf,'dkI[')](iIIiil,0x0)&&(i1ilil[Ii1iii(0x13c,'v[8I')]=iIIiil);}else{iii1iI=''+i11iil+Ill1l+Ii1iii(0x128,'tXTG'),IiiliI++;continue;}}ii1iii['iXJur'](lI1lll,liiI1l,il1iI1[Ii1iii(0xa0,')wO[')]),llIll=![];break;}ii1iii['PrhVh'](IiiliI,Iil1lI)&&(console[Ii1iii(0xba,'5IO[')](iii1iI),llIll&&(ii1iii[Ii1iii(0x137,'(6dP')](ii1iii['YxyiQ'],ii1iii['YxyiQ'])?$[Ii1iii(0xb9,'b5SG')]=!![]:lliiil[Ii1iii(0xa1,'$)br')](lliiii,IliI1i)));}}async function concMain(I1iIIi=0x1,I1iIIl,lI1IIl,i1ilI,iii1lI){const iIIilI=i1iIi1,i1ilI1={'TKvYu':function(I1iIII,liiI11){return I1iIII!==liiI11;},'YVhZw':iIIilI(0xb7,'jOdG'),'cfByy':iIIilI(0x17a,'AeMF'),'xLRsv':function(ililI1,IIii1i){return ililI1<IIii1i;},'GstBg':function(i1ili,Iiill1){return i1ili>Iiill1;},'iZCIS':function(I1iII1,lilII1){return I1iII1!==lilII1;},'MAAXD':iIIilI(0x155,'hlfk'),'vgvgT':function(iill1,iii1l1){return iill1(iii1l1);},'uqZxg':function(IIliIl){return IIliIl();},'rHXWD':function(II11ll,liiI1I,ililII){return II11ll(liiI1I,ililII);},'dCdJr':function(lI1II1,i1ilII){return lI1II1(i1ilII);},'yDALC':'pt_pin','esIAh':function(iIIii1,IllIi1){return iIIii1===IllIi1;},'BHZjg':'boolean'},Iiilii=I1iIIl[iIIilI(0x17e,'Gqsa')](lilIII=>lilIII),Iil1li=i1ilI1[iIIilI(0x162,'[M6b')](decodeURIComponent,common[iIIilI(0x111,'WD5d')](lI1IIl,i1ilI1[iIIilI(0x10a,'6IE^')])),Iiilil=notify[iIIilI(0xa6,'@dfn')](i1ilI,Iil1li),Iil1ll=iIIilI(0xff,'%Q%U')+i1ilI+'】'+Iil1li+'：',iillI={'title':Iil1ll,'UA':common['genUA'](Iil1li),'cookie':lI1IIl,'index':i1ilI,'message':Iiilil},lI1III=await common[iIIilI(0xe3,'21cL')](lI1IIl);if(!lI1III&&i1ilI1['esIAh'](typeof lI1III,i1ilI1[iIIilI(0xaf,'(6dP')])){console[iIIilI(0x125,'R*(l')](Iil1ll+iIIilI(0x165,'arw]'));return;}let IIliIi=0x0;async function IllIiI(Ii1ilI){const il1l1=iIIilI;if(i1ilI1[il1l1(0xa2,'*t5e')](i1ilI1['YVhZw'],i1ilI1[il1l1(0x148,'(6dP')]))return;else await iii1lI(Ii1ilI,iillI),IIliIi--,i1il1();}async function i1il1(){const Ii1iil=iIIilI;while(i1ilI1['xLRsv'](IIliIi,I1iIIi)&&i1ilI1[Ii1iil(0xa3,'J&f%')](Iiilii[Ii1iil(0x159,'OHhJ')],0x0)){if(i1ilI1['iZCIS'](i1ilI1[Ii1iil(0xc0,'u79%')],'kCHuI'))delete l1iiI[Ii1iil(0xa0,')wO[')],delete ll1li[Ii1iil(0xce,')0W%')][i1ilI1['cfByy']];else{const iliIii=Iiilii['shift']();IIliIi++,await IllIiI(iliIii);}}}const I1l111=Math[iIIilI(0x176,'dkI[')](Iiilii[iIIilI(0x13d,'tXTG')],I1iIIi),IIii1l=[];for(let lill1i=0x0;lill1i<I1l111;lill1i++){const il1li=Iiilii['shift']();IIliIi++,IIii1l[iIIilI(0xcc,'*t5e')](i1ilI1[iIIilI(0x100,'OHhJ')](IllIiI,il1li));}await Promise['all'](IIii1l),i1ilI1[iIIilI(0x1a5,'u79%')](i1il1),await new Promise(iIIill=>{const II11ii=iIIilI,iilii={'KadBJ':function(iilil,Ill11l){const Ilil1i=iii1II;return i1ilI1[Ilil1i(0x139,'z*P*')](iilil,Ill11l);},'pltmv':function(il1ll){const iili1=iii1II;return i1ilI1[iili1(0x19d,'AeMF')](il1ll);}},Ill11i=i1ilI1[II11ii(0x101,'%Q%U')](setInterval,()=>{const Iil1iI=II11ii;IIliIi===0x0&&(iilii[Iil1iI(0x16c,'*t5e')](clearInterval,Ill11i),iilii[Iil1iI(0x120,'*t5e')](iIIill));},0x64);});}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
