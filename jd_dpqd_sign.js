/*
活动名称：批量店铺签到
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割
        jd_dpqd_task_threads // 控制签到并发线程数（正整数），默认1
        jd_dpqd_account_threads // 控制账号并发线程数（正整数），默认1
        jd_dpqd_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认0
        jd_dpqd_max_retry // 签到火爆时的最大重试次数（整数），默认0
        jd_dpqd_prize_notify // 是否推送中奖信息（true/false），默认不推送

此脚本为高并发签到本，需要读取主脚本生成的活动信息缓存，自动过滤无效活动，签到后如有奖品则自动到账


cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到')
var iｉl='jsjiami.com.v7';const llI11i=iii1II;function Iii11l(){const Ii1iil=(function(){return[...[iｉl,'MjsyFjfiwJaeVmbifd.WcxMoYmAG.vQw7MANkhDW==','WR/cHmoZWOqT','md3dQJ0','isJdUhew','aYvYW4ZcUa','yH3cH8ojW5a','W4ldLfC','6lEz5yYB5Pwn5PER','WQ8WiHvDbf7cQ8oqj8om','E0XZjW','4P6hioIeLUAEIoI/U+IISoMbREwiIUs6IUMxPoITJ8o5','WQjUEmobwCk/t1r4WPJdKSkSW7NdTrL7g14QW6i','WRJcJ8k/bSkZx8k6r2ThoSkaWRacs8kggqddUmkc','W6xcQfbJW7W','ya0zWQxdSmkHl8oizae','qCkZiCoEnq','FcKzW7/cUCkxqq7dICoVWRKh','6lE95yYV5PsT5PsnuVglQ5S','tConw8o4','WR8apbO7','WR/cUCk5ja','W7ZdI8kNyCozW77dRaHx','W6xdNCk8','k+kEGJ3INRz+56YB5yIq5AEP6lsYemkWW7C','W73dJNC1','WORdSSoz','4PQfgoIVREweLUI/JEIJTos4O+IfIUAFJoInREwmO+A3V+wlSEs+IUAdQUE/TowUUEwtQowgQUI+PoIIPUASLEIeIoACRE+9UW','qNvpdK0','W4RdRYlcQCoC','WO3cICoCW5BdPSkYeq','bmogwCkUWO8','5lUw5PsH5Bs556Yh','W5NcImocW44DiSozegn2W51vWQS','odpdUq','DhtcGCofnG','vc7cHmocW4mz','W49mw8kmW7TF','pdxdQwxdVW','W5RcSNSZfG','W5JcRh1OW6u','hbJdRhFdL3FcGCoNiZnfWOZdVCoHWOOwnurSW7zzkcRcLa','lmocWOqjBa','WQBcLCkMWPrT','pmkOW6S6WR0','WOJdHSoyW4im','W7JcTN5/W5W','W7dcOfHl','WRK/oq','WO7cKmowWOuS','WRPOE8oMyW','WOZcVSkjWRfm','5P6v55Y/5AwJ5zk4772V','44gA5OYx56wM44kH6k225yE76iYa5y+sW79lofZdQZa','WQHjq8oPFG','WQG0W59fWOBcQguItW3dRSojWQCSWOWL','5P6Y5yM75zMD57I45B6+','lSodBCkIWPhcQJdcQq','ihvFWRJdQCoiBq','4PMYW4VORjFLHkRLRzNKUAFLVjVOPPNNMPVNJONLO4RLJlpPHkdLKBJLHQ7OVktOOldOHBVMNRdVV7a','W7tdJGpcVmobW5i','W5JcV0e','WQJcSmkKiWy','f+kFGmob4P6MWPFNRilLI6RMI7pLIQq','WQr1EmoIr8kDtq','W7/dHhbmW4aQWR0cW4FdLxRdNL8cW7hcSmkKWRmSj1iBW7VcGdVdU2m3WOldTCkElSoUaSo/WRvLW5CAW5lcNKJdJsrFfraeW5dcOX9bW5ddQZKDWQKaWOFcQITtWQxcI8ofCHpdQGhdH8oMmmkC','ENpdTdHThu9lWQpdRq','sCkkaa','WP7cN8oEW4RdPmkV','hrNdIMa','W6NcUKTeW4i','WOtdHSoqW4eu','W4P1s8keW40','WP7cN8kaWRXdymknf8k3W6Tcp28tta','W5nQW5nBWQK','zvruWR0B','oCkVnCowW7u','WO/cMCoEW4S','x1lcOCoSW7K','rKZcS8ohjG','Cv/cU8oinW','5RAO5yMN5PEC5PwM','WPdcPCkU','W5DqttrF','quJcP8ocW4O','uSkOWOWwyG','WOZORi/MS6tLKAlLU71N','W73dJN0ZywWVW5K','imoVA8krWO4','4PQRpUIVQUwgSUwVHos4Row/PEILMEEAK+EoN+wGNUwmJ+MgPowqJ+weREI/RUIJGoIeT+AFUo+/Iq','hq7dSd55','t8ooWQStWOy','WQRdK8ke','W7pdKNq'],...(function(){return[...['E8o+ACkeWRdcI8o+tSoLsan8','W6xcJCkvqM7dNW','gHNdNxtdK24','BLtcMCoWjG','WRe3g1iIi8oFW48VW6JdU8krWOG','vSodvq','W73dJN0KugmO','wUkDVmkA4P2pW77NRiZLI4BMI5dLI4C','gSopkNpcNsXXW6ZdRYpdOSkz','W5tcIMG','W77dNMDqW4z0W7DE','W5RcQmohW6Km','WQRdMCknWOqBW7K','nCosWQrwW5a','usvWW53dQW','W4ZcV0e','FW0eWQhdSSkWl8oaEWO','p3vnWQ/dJSogzchdG8o6WOmV','5yYu6ywZ6k2Q5PQ7FaJcL8kJW6FcJmoQAmkUW4i','WR7cHSoHW6ZdPq','zdzoW4/dTa','B8kVWR43CSoNWOi','WOJdKmkKWOWE','WQFdOqG','W4ddNSkMtSot','WOpcL8kkWRC','gGNdQ0RdTa','W5hcNLy9ia','WQG+ra','rUA2L+wkMUwMPUEaUoEjLa','W7G2nCkqgColg2HOWPldQmkDW6i','W63cV8o8W6mR','yMRcR2SFrhD1WQNdQ8olWOq','5RAv5yIt5BcQ5P+u5B2i5AAk','fWGQBs/cJc85WO3cQ8kpWQ0p','jdpdRZTF','WOJcS8k5W6m','A0X2j8kCzG','W4xcS8orW7WL','FIT1W4pdVG','lCkImSoLW4a','WRVdNCo3W4evxmohW7S','W7berSkOW7m','5yEvW73LJQNWNlYO','W43cNCofW6q5','W6ZdOGRcSmoA','WOVdUCok','iSopF8kLWPVcRs0','W7FcQxvaW6O','A8kLWQinr8oJWORdNa','EaJcNfpdPW','WPVcR8k9W4uLiCknWQ1nWOVcTfKHEW','grldMqXJ','zWCB','WQFcISo5oCkEW77dRGaiW6bicgPy','gaZdMcLR','aaP8W77cVCk7WRFcOL5ZWPtcLeVcVJfcW5ajWPZdRSk8W6RdLCoVW68qemkb6iAt5A2F5lM16lYf6kkj6zwu6zMI5PED6zs2','hsVdUr13','nXBdV1ZdGq','WQi8BCozsW','WR/dImoSW5WVuSodW7JcOW','WQJdK8ooWOaaW6pdVW','uv/cV8oyW4/dVr9lBZldS8kLi180jHpdLCorWRRcOfBcK00','vfJcRa','WQRcKvxdJCklWPb3x1BcQSkuWOGq','W6P+vSoGD8o1hgRcGLmbW73cJ8kVwSklsmkwW6fac8ozW5XPWPFdOCoc','FSkRWQqvDSoRWOK','hCogWQvpW4C','WQddMSk4wCoFWOVcQa','W5OTW4dcSSk7W51xW5LkamkanIRcOW','W5SHW5JcISkXW4G','W4dcNCoiW4GDlW','BfdcISoNbxLLW4SiWQrfW7a','W7xcONjJW50','4PY6xoAEMEIdRUAVHoEHQowNOEEsVMi','gCkpW54V','WP8AoYuL','WQtcRSkVaCkK','WQ41FmoWBSoOcXRcPfKiW73cJCkVjCoxaSoy5RA+5yQIbSot776/5Ash5lUu55AV6iMk5PEJ6yc15y+K5yUS5yMN','WRFcT8kQ','W73dJXi','omodWOK+','B8kzW55UagtcRmoNeLZcULRcTG','WOJcUmk8W6m','W6zTtai','udNcLq','WPxcQCoyW7pdSW','BsxcNv/dVa','svD9','WQBINOFcIUkDVCop56665yIM5As86ls4772G','WPRcU8o5','zeXdn0O','WR7INl0Z4PYCfEETS+wjRowMG+I3Po++GW','W7hdJXdcNmobW4eGB2tcKmk+WQaGCSk+yx3cNZ4nWR96sCoctmkCWRTGWRWOqfBcGmonW7yIbSoSlJi'],...(function(){return['5l605Ocy5yQE8lsMUo+5Ia','WO3dQGvkvCkyWPhcG8kuwSklWR02','WRxcU8oWWQy8vCoQymkgdwfW','WOKMjZyL','W5xdU2qKxa','jrpdG3JdIG','W5VdMaRcRSo2','776m8j+6GW','W7zUW5Lz','FYaDW7/cSmkFpaddVCoAWQikWQO','yamRWP7cJa','WPhcOmoWWPm2','WO9Rx8oDEq','DuZcN8olW6O','rg9Xeu0','emoSot7cMG','pCkMnCoeW5xdMSoAyq','E0jPiW','W53dNKq','rIy9WPhcJa','W5GWW53cIG','xuRcV8oj','kCofESkK','xtzLW4/dIG','5BQG6zkM56so5yQL8lk/O++7Lq','WQJcRCkUjHFcOam','mYBdTYWcuKrfWQZdPmoJWRJcNdpdQXic','WPJcICoz','kerLWOxdGa','qeej','h8oEnZW','WP3IN5tcLoISIEAYLUwMI+I0M+++V+AxUEwsUEw5TEAuSUAmSE+/MFgpUl4','W7/dMSkdrmoI','xxXscwG','W7bstCkaW4tdM2X5W7CrW7jlzL0oW4ddUCoDCSkq','W74NW7dcTmk9','cCoFWQexEG','W69MDWnMz8koW7ONW4ZdSmkrWPldMmolfW9/mc0tW7tdLuDhBSo35OYn5yIw6lE75yYc5BI45y64776U6BIX6kY9sG','Duf9l2u','tConw8o4bZVcNsy','WQCll8ozWONcLZuBWRPE','5OYC56Ag57Mn5P+QFaJcL8kJW6FcJmoQAmkUW4i','WR3cUmklomk2','mspdOr5S','WOFcKSk4WRzWFSkfjmk/W6Loj3qqtmogca','EcCMWOlcRa','zmkfA8k1WPFcSY3dSL/cUCk5W4v8xshcSGdcNcDjW57cLZC','W5xcGCotW6Oi','W4BdQxy1rq','uYVcLgtdVa','xexcVq','W5RcTem','eH3dH3i','z3f6','pcJdQIXDsa8pWQlcVCkSWQhdL3xcR14tjCoYsG','WOlcS8kMeGq','WQKIra','AgxcISofjG','WQm0v8ozE8oQhctcT1m','Aej0nSkMmSkUWPi','W7VdN2m','WO/dK8oWW4eKw8oEWRpcJSoiWQCW','WRxcJSkukSo2xCkQ','WQe/vq','j8olBG','W5O8W7BcRSk4','4P2qW6tMN6hOGOtMRBdNO6tLP6pNKR/cQG','qd3cImoxW6mvWRFcHG','WRBcM8okW6ldMG','FCkCp8oynG','W4HOyCkUW4W','dW1qW4dcUW','W7zStc1A','WQlcISkseCkM','tSkpWROEyq','W5eNW5m','W5RdIvf7W7K','W6jYwSkZW4e','WRddISolgdRcG8kY','W4xcSHG6kCkaW5ZcGSouy8kqWROtpczsWQSgrq','5REG5yMW5Bs/57Qk57QH5P6m','6lAi5y2m5PEq5PA2ApcVI7e','W4jdxmki','mttdKbzF','W4BcNmo5W4SznSo+ihLTW5nEWRfX','F05/WOao','W7b2tKOU','dSoUWPWjzq','WRa+ka','W5ZdKSkPrmog','vWJcOKhdOa','wcpcOq'];}())];}())];}());Iii11l=function(){return Ii1iil;};return Iii11l();};(function(Iil1i1,IIii11,iliIl1,Ii1il1,iii1ll,IIliI1,il1lI){return Iil1i1=Iil1i1>>0x9,IIliI1='hs',il1lI='hs',function(IliIIl,I1il1l,lI1l1l,IIliII,iiliI){const IIii1I=iii1II;IIliII='tfi',IIliI1=IIliII+IIliI1,iiliI='up',il1lI+=iiliI,IIliI1=lI1l1l(IIliI1),il1lI=lI1l1l(il1lI),lI1l1l=0x0;const Ill11I=IliIIl();while(!![]&&--Ii1il1+I1il1l){try{IIliII=parseInt(IIii1I(0x215,'R6u&'))/0x1+parseInt(IIii1I(0x235,'ndBM'))/0x2+-parseInt(IIii1I(0x274,'b([2'))/0x3+-parseInt(IIii1I(0x27c,'X$eK'))/0x4+-parseInt(IIii1I(0x219,'Nv@i'))/0x5+parseInt(IIii1I(0x259,'kqWO'))/0x6*(parseInt(IIii1I(0x233,'ZS6o'))/0x7)+parseInt(IIii1I(0x24b,'kqWO'))/0x8;}catch(I1il1i){IIliII=lI1l1l;}finally{iiliI=Ill11I[IIliI1]();if(Iil1i1<=Ii1il1)lI1l1l?iii1ll?IIliII=iiliI:iii1ll=iiliI:lI1l1l=iiliI;else{if(lI1l1l==iii1ll['replace'](/[GDwQVWFNAMxbdfYhyJke=]/g,'')){if(IIliII===I1il1l){Ill11I['un'+IIliI1](iiliI);break;}Ill11I[il1lI](iiliI);}}}}}(iliIl1,IIii11,function(IliIIi,lI1l1i,i1iil,llI11l,I1llIl,i1iii,I1llIi){return lI1l1i='\x73\x70\x6c\x69\x74',IliIIi=arguments[0x0],IliIIi=IliIIi[lI1l1i](''),i1iil=`\x72\x65\x76\x65\x72\x73\x65`,IliIIi=IliIIi[i1iil]('\x76'),llI11l=`\x6a\x6f\x69\x6e`,(0x15bfbc,IliIIi[llI11l](''));});}(0x19200,0x792fb,Iii11l,0xcb),Iii11l)&&(iｉl=0x3f42);const jdCookie=require(llI11i(0x1f9,'ndBM')),notify=require(llI11i(0x256,'0jv!')),common=require(llI11i(0x18b,'V&9x')),{H5st,jsTk}=require(llI11i(0x1ee,'i3eQ'));console[llI11i(0x21a,'bs(a')](''),console[llI11i(0x1b5,'4^#9')](llI11i(0x185,'@^E9')+$['name']+llI11i(0x227,'PETL')),console['log'](llI11i(0x263,'0jv!')),console['log']('jd_dpqd_task_threads\x20//\x20控制签到并发，默认1'),console[llI11i(0x24a,'lwSy')](llI11i(0x182,'Nv@i')),console[llI11i(0x1be,'[U2j')](llI11i(0x24d,'Yo(o')),console[llI11i(0x199,'kD2z')]('=========='+$['name']+llI11i(0x186,'PETL')),console[llI11i(0x209,'kcwP')]('');let tokensList=(process[llI11i(0x1b8,'0S4W')][llI11i(0x1b1,'RQaA')]||'')['split'](/[,@&|\n]+/g)[llI11i(0x216,'rOI[')](Boolean),taskThreads=process[llI11i(0x1e7,'4^#9')][llI11i(0x1c4,'M]gz')]||'1',accountThreads=process[llI11i(0x18f,'wuFY')]['jd_dpqd_account_threads']||'1';const runInterval=process[llI11i(0x265,'35n@')][llI11i(0x1e0,'3WI0')]||'',isNotify=process[llI11i(0x190,'b([2')][llI11i(0x17f,'@^E9')]===llI11i(0x268,'kcwP');let signHotMaxRetryTimes=process[llI11i(0x19c,'0jv!')][llI11i(0x189,'#WWy')]||'0',TokensMap=null;const signStatusMessages={0x1805c007:llI11i(0x1d7,'021W'),0x1843da61:llI11i(0x236,'[U2j'),0x1843da62:llI11i(0x1ad,'gJs@'),0x184253c7:llI11i(0x1bf,'1]8W'),0x192:llI11i(0x208,'AeW)'),'-1':llI11i(0x1ef,'b([2')},invalidTokensMap=new Map(),CacheFile=__dirname+'/rs_dpqd_tokens.json',cookiesArr=Object[llI11i(0x1fc,'3WI0')](jdCookie)['map'](iI11I1=>jdCookie[iI11I1])[llI11i(0x25b,'aKsC')](il1i1l=>il1i1l);function iii1II(_0xf51d9c,_0x438f3f){const _0x54c199=Iii11l();return iii1II=function(_0x341677,_0xb415c8){_0x341677=_0x341677-0x16a;let _0x857749=_0x54c199[_0x341677];if(iii1II['jdmTQi']===undefined){var _0x3b531b=function(_0xc3e9ed){const _0x3607aa='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x27723b='',_0x20083a='';for(let _0x44a140=0x0,_0x3a5797,_0x26a08c,_0x50ede6=0x0;_0x26a08c=_0xc3e9ed['charAt'](_0x50ede6++);~_0x26a08c&&(_0x3a5797=_0x44a140%0x4?_0x3a5797*0x40+_0x26a08c:_0x26a08c,_0x44a140++%0x4)?_0x27723b+=String['fromCharCode'](0xff&_0x3a5797>>(-0x2*_0x44a140&0x6)):0x0){_0x26a08c=_0x3607aa['indexOf'](_0x26a08c);}for(let _0x5409b8=0x0,_0x34b50c=_0x27723b['length'];_0x5409b8<_0x34b50c;_0x5409b8++){_0x20083a+='%'+('00'+_0x27723b['charCodeAt'](_0x5409b8)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x20083a);};const _0x330619=function(_0x30dbb2,_0x1a8450){let _0x5acdbd=[],_0x16b697=0x0,_0x5df10a,_0x4070e2='';_0x30dbb2=_0x3b531b(_0x30dbb2);let _0x462e92;for(_0x462e92=0x0;_0x462e92<0x100;_0x462e92++){_0x5acdbd[_0x462e92]=_0x462e92;}for(_0x462e92=0x0;_0x462e92<0x100;_0x462e92++){_0x16b697=(_0x16b697+_0x5acdbd[_0x462e92]+_0x1a8450['charCodeAt'](_0x462e92%_0x1a8450['length']))%0x100,_0x5df10a=_0x5acdbd[_0x462e92],_0x5acdbd[_0x462e92]=_0x5acdbd[_0x16b697],_0x5acdbd[_0x16b697]=_0x5df10a;}_0x462e92=0x0,_0x16b697=0x0;for(let _0x4a03e4=0x0;_0x4a03e4<_0x30dbb2['length'];_0x4a03e4++){_0x462e92=(_0x462e92+0x1)%0x100,_0x16b697=(_0x16b697+_0x5acdbd[_0x462e92])%0x100,_0x5df10a=_0x5acdbd[_0x462e92],_0x5acdbd[_0x462e92]=_0x5acdbd[_0x16b697],_0x5acdbd[_0x16b697]=_0x5df10a,_0x4070e2+=String['fromCharCode'](_0x30dbb2['charCodeAt'](_0x4a03e4)^_0x5acdbd[(_0x5acdbd[_0x462e92]+_0x5acdbd[_0x16b697])%0x100]);}return _0x4070e2;};iii1II['lgFkyu']=_0x330619,_0xf51d9c=arguments,iii1II['jdmTQi']=!![];}const _0x33ab5d=_0x54c199[0x0],_0x385962=_0x341677+_0x33ab5d,_0x5ae0bc=_0xf51d9c[_0x385962];return!_0x5ae0bc?(iii1II['gwcQdG']===undefined&&(iii1II['gwcQdG']=!![]),_0x857749=iii1II['lgFkyu'](_0x857749,_0xb415c8),_0xf51d9c[_0x385962]=_0x857749):_0x857749=_0x5ae0bc,_0x857749;},iii1II(_0xf51d9c,_0x438f3f);}!cookiesArr[0x0]&&($[llI11i(0x195,'0jv!')]($[llI11i(0x22e,'#WWy')],llI11i(0x1ec,'R6u&')),process[llI11i(0x171,'aKsC')](0x1));!(async()=>{const i1iIi1=llI11i,IlIlll={'Pygqx':i1iIi1(0x210,'h4tC'),'iXKhq':function(IIIl1I,iil1ii){return IIIl1I>iil1ii;},'xDHWu':function(IlIlli,il1i1i){return IlIlli!==il1i1i;},'NlGoq':function(lil111,i11ilI){return lil111(i11ilI);},'sndJL':function(ii1ii1){return ii1ii1();},'UwhFU':function(llllI,lllil1,iil1il,ilil1I,i11il1,ii1iiI){return llllI(lllil1,iil1il,ilil1I,i11il1,ii1iiI);},'Sopkm':function(lllilI,ilil11){return lllilI(ilil11);},'KHkVY':function(illlI1,IIIl11){return illlI1<=IIIl11;},'aecKP':i1iIi1(0x1e5,'AeW)'),'iKQVu':i1iIi1(0x18e,'0S4W'),'ojPKt':i1iIi1(0x1b3,'Nv@i'),'ehNJq':function(I1lIi1,liiIIi){return I1lIi1===liiIIi;},'poqgq':'eaLBk','RvaJA':i1iIi1(0x279,'35n@'),'vmFyE':i1iIi1(0x1d2,'An(k'),'AjLOf':function(lil11I,Iliii1){return lil11I(Iliii1);},'wniRX':function(iIiIi,iil1ll){return iIiIi>iil1ll;},'IPmVt':'⚠\x20自定义运行间隔时长设置错误','kSzcj':i1iIi1(0x1a2,'$CkC'),'RKqgr':'zvpdX','QuKsg':'mfqpb','jAjFu':i1iIi1(0x187,'M]gz')};try{notify['config']({'title':$['name']});if(tokensList[i1iIi1(0x217,'3WI0')]>0x0)tokensList=[...new Set(tokensList['filter'](iil1li=>iil1li!==''))];if(IlIlll['KHkVY'](tokensList['length'],0x0)){console['log'](i1iIi1(0x1f2,'M]gz'));return;}const iiilil=require('fs');if(iiilil['existsSync'](CacheFile)){if(IlIlll[i1iIi1(0x241,'RQaA')]===IlIlll[i1iIi1(0x1bc,'Yo(o')]){l1l11l[i1iIi1(0x1d9,'ndBM')](IilIil+i1iIi1(0x1c9,'gJs@'));return;}else{const iIiIl=iiilil[i1iIi1(0x226,'X$eK')](CacheFile,IlIlll[i1iIi1(0x207,'a0Gw')]),iiilii=JSON[i1iIi1(0x218,'a0Gw')](iIiIl);TokensMap=new Map();for(const li1i1i in iiilii){if(IlIlll[i1iIi1(0x1de,'b([2')](IlIlll[i1iIi1(0x238,'ndBM')],IlIlll['RvaJA'])){IiilI1[i1iIi1(0x264,'gJs@')](IlIlll[i1iIi1(0x183,'An(k')]);return;}else TokensMap[i1iIi1(0x16f,'[U2j')](li1i1i,iiilii[li1i1i]);}}}else{console['log'](IlIlll['vmFyE']);return;}$[i1iIi1(0x184,'bs(a')]=null;if(runInterval)try{const illIiI=IlIlll[i1iIi1(0x24f,'3WI0')](parseInt,runInterval);IlIlll[i1iIi1(0x1e1,'!01T')](illIiI,0x0)&&($[i1iIi1(0x1a0,'!!j0')]=illIiI);}catch{console[i1iIi1(0x1fa,'$CkC')](IlIlll[i1iIi1(0x1b9,')iRe')]);}try{const lI1lli=IlIlll[i1iIi1(0x20c,'021W')](parseInt,signHotMaxRetryTimes);signHotMaxRetryTimes=IlIlll['wniRX'](lI1lli,0x0)?lI1lli:0x0;}catch{signHotMaxRetryTimes=0x3;}try{if(IlIlll[i1iIi1(0x1b0,'ndBM')](i1iIi1(0x206,'a0Gw'),IlIlll[i1iIi1(0x16c,'n[T8')])){const Ill1l=IlIlll[i1iIi1(0x22b,'nacw')](parseInt,taskThreads);if(Ill1l>0x0&&IlIlll[i1iIi1(0x1aa,'@^E9')](Ill1l,0x1)){if(IlIlll['ehNJq'](IlIlll[i1iIi1(0x1a7,'021W')],IlIlll['RKqgr']))taskThreads=Ill1l;else{const ii1iii=Iliill(IIII11);IlIlll[i1iIi1(0x211,'D8e#')](ii1iii,0x0)&&IlIlll[i1iIi1(0x1e8,')iRe')](ii1iii,0x1)&&(i1illl=ii1iii);}}}else llIli1['waitTime']=iliIII;}catch{taskThreads=0x1;}try{const Ill1i=IlIlll[i1iIi1(0x228,'1]8W')](parseInt,accountThreads);Ill1i>0x0&&IlIlll[i1iIi1(0x17e,'An(k')](Ill1i,0x1)&&(IlIlll['QuKsg']!=='pOttX'?accountThreads=Ill1i:liIiI===0x0&&(IlIlll[i1iIi1(0x1d6,'V&9x')](li1,illIl1),IlIlll[i1iIi1(0x1a5,'Nv@i')](l1llII)));}catch{accountThreads=0x1;}await common[i1iIi1(0x20e,'SeVv')](accountThreads,cookiesArr,async(lllI1l,i11iii)=>{const l1l1il=i1iIi1;await IlIlll[l1l1il(0x276,'4^#9')](concMain,taskThreads,tokensList,lllI1l,i11iii,Main);if($['waitTime'])$['wait']($[l1l1il(0x23e,'PETL')]);}),isNotify&&notify[i1iIi1(0x197,'0jv!')]()&&(notify[i1iIi1(0x1d8,'RQaA')](notify[i1iIi1(0x21b,'SeVv')]),await notify[i1iIi1(0x27b,'i3eQ')]());}catch(llI1Ii){IlIlll[i1iIi1(0x17e,'An(k')](IlIlll['jAjFu'],IlIlll[i1iIi1(0x1da,'a0Gw')])?(IlIlll[i1iIi1(0x278,'3WI0')](l11i1i,lI11I1),l1il11()):console['log'](i1iIi1(0x1c2,'ZS6o')+llI1Ii);}})()['catch'](li1i1l=>$[llI11i(0x1f3,'35n@')](li1i1l))['finally'](()=>$[llI11i(0x1c1,']tSH')]());async function Main(II1i1,lI1lll){const I11i1I=llI11i,iIiII={'qhwBH':function(IlIlii,i1l1i1){return IlIlii(i1l1i1);},'JIZvX':function(liil11,iiillI){return liil11>iiillI;},'luXYS':I11i1I(0x1bb,'ndBM'),'jEuPp':'signCollectGift','DzFwM':function(l1l111,l1iIII){return l1l111===l1iIII;},'vPaFe':function(llI1I1,IlIlil){return llI1I1===IlIlil;},'kJpST':I11i1I(0x19e,'aKsC'),'EuZHd':I11i1I(0x273,'RQaA'),'xcljv':function(lIli1I,II1il){return lIli1I/II1il;},'sOZWq':function(lllI11,I1lIll){return lllI11>I1lIll;},'VfnAz':function(I1lIli,II1ii){return I1lIli!==II1ii;},'RsLLN':I11i1I(0x20a,'Nv@i'),'DnsGy':I11i1I(0x1ea,'#WWy'),'Kydnz':I11i1I(0x26c,'0S4W'),'tPbzP':'cQkme','ykYWa':'zECVL','gtnAo':I11i1I(0x242,'35n@'),'gbSDl':I11i1I(0x21e,'AeW)'),'HzNtU':I11i1I(0x212,'x@%0'),'iKwSL':I11i1I(0x272,'35n@'),'dVFBf':I11i1I(0x22c,'AeW)'),'yyuEa':I11i1I(0x253,'wuFY'),'vglMt':I11i1I(0x1cd,'kqWO'),'LgTcV':function(IIIIII,lillII){return IIIIII!==lillII;},'ecsZv':I11i1I(0x1a3,'1bNd'),'AtYiW':'Owryv','wZTWU':I11i1I(0x17a,'Yo(o'),'UwhQd':I11i1I(0x177,'ndBM'),'lUrpn':I11i1I(0x1ac,'b([2'),'Wmitc':I11i1I(0x1c6,'lwSy'),'WqMRd':I11i1I(0x225,'lwSy'),'eTINH':I11i1I(0x193,'ndBM'),'UAfjg':'script','znpmT':I11i1I(0x252,'nacw'),'MNGPM':I11i1I(0x1c0,'4^#9'),'dfInb':I11i1I(0x275,')iRe'),'JjaKo':'tdqrf','XHeep':function(ii1ilI,lI1ll1){return ii1ilI!==lI1ll1;},'fyjDE':I11i1I(0x174,']Vy*'),'lWcmD':function(iIiI1,liil1I){return iIiI1>=liil1I;},'ibKKK':I11i1I(0x25e,'AeW)'),'VUMmf':function(i11ii1,IlIliI){return i11ii1||IlIliI;},'CKtUU':function(l1iII1,iiill1){return l1iII1>iiill1;},'kkWKQ':I11i1I(0x170,'lwSy'),'LPFuE':I11i1I(0x16b,'An(k'),'vEOcg':function(lIli1i,IIIII1){return lIli1i!==IIIII1;},'KZwti':I11i1I(0x24e,'ndBM')},{title:iil1lI,UA:iiiliI,cookie:li1i1I,message:illIii,jsToken:ii1il1}=lI1lll;if(invalidTokensMap['get'](II1i1))return;const lI1llI=TokensMap[I11i1I(0x1f4,'b([2')](II1i1);if(!lI1llI)return;const illIil=Math[I11i1I(0x258,'x@%0')](iIiII[I11i1I(0x20b,'wuFY')](Date[I11i1I(0x1d1,'mQUa')](),0x3e8))+'000',{venderId:Ill1I,activityId:i11iiI}=lI1llI;if(iIiII['VUMmf'](!Ill1I,!i11iiI))return;if(invalidTokensMap[I11i1I(0x178,'1]8W')](II1i1))return;let lIli11=![];await iIiII[I11i1I(0x1e9,'ZS6o')](lillI1,I11i1I(0x200,'#WWy'));if($[I11i1I(0x16d,'R6u&')])$[I11i1I(0x1ca,'bs(a')]($['waitTime']);if(lIli11&&iIiII[I11i1I(0x261,'4^#9')](signHotMaxRetryTimes,0x0)){if(iIiII[I11i1I(0x27d,'lwSy')]===iIiII[I11i1I(0x24c,'ndBM')])i1li[I11i1I(0x1ce,'kqWO')](li1II,IliI11[i1ll]);else{let ii1ill=0x0;while(ii1ill<signHotMaxRetryTimes){if(iIiII[I11i1I(0x262,'M]gz')](iIiII[I11i1I(0x277,'SeVv')],I11i1I(0x1a1,'1]8W'))){const llI1II=iIiII['qhwBH'](i1l1ll,I1iIiI);iIiII[I11i1I(0x1dd,'3WI0')](llI1II,0x0)&&(i1ilil['waitTime']=llI1II);}else{if(invalidTokensMap[I11i1I(0x26a,'!!j0')](II1i1))return;await lillI1(iIiII[I11i1I(0x1b7,'0S4W')]);if($[I11i1I(0x198,']tSH')])$['wait']($[I11i1I(0x246,'021W')]);if(!lIli11)break;ii1ill++;}}}}function lllI1I(lIli1l,lillIi){const iliIi1=I11i1I;try{switch(lIli1l){case iIiII[iliIi1(0x20f,'V&9x')]:if(iIiII['DzFwM'](lillIi[iliIi1(0x173,'V&9x')],0xc8)&&iIiII[iliIi1(0x220,'RQaA')](lillIi[iliIi1(0x176,'gJs@')],!![])){const illIi1=[];if(lillIi[iliIi1(0x1cc,'gJs@')]&&lillIi[iliIi1(0x1ba,'ndBM')][iliIi1(0x25c,'RQaA')]>0x0)for(const ii1ili of lillIi[iliIi1(0x1af,'1bNd')]){const liil1i=ii1ili?.['prizeList']||[];for(const lI1lil of liil1i){if('Nejnc'!==iIiII['kJpST']){const i1l1iI=lI1lil?.[iliIi1(0x239,'kcwP')],liil1l=lI1lil?.[iliIi1(0x1f0,'V&9x')];let lI1lii='';switch(i1l1iI){case 0x1:lI1lii=iIiII[iliIi1(0x188,'D8e#')];break;case 0x4:lI1lii=liil1l+'京豆🐶';break;case 0x6:lI1lii=liil1l+iliIi1(0x175,'!!j0');break;case 0x9:lI1lii=lI1lil?.['interactPrizeSkuList'][0x0]?.[iliIi1(0x22a,'021W')]+'🎁';break;case 0xa:lI1lii=liil1l+iliIi1(0x240,'kqWO');break;case 0xe:lI1lii=iIiII[iliIi1(0x223,']Vy*')](liil1l,0x64)+'元红包🧧';break;default:lI1lii=iliIi1(0x1eb,'b([2')+i1l1iI+'）';}illIi1['push'](lI1lii);}else Iliiil=0x3;}}if(iIiII[iliIi1(0x18a,'lwSy')](illIi1[iliIi1(0x221,'nacw')],0x0)){if(iIiII[iliIi1(0x23f,'1bNd')](iIiII[iliIi1(0x181,'!01T')],iIiII['RsLLN']))Illl1l[iliIi1(0x26f,')iRe')](''+Illl1i+lIIiil+iliIi1(0x1f6,'!!j0'));else{console['log'](''+iil1lI+II1i1+'\x20➜\x20✅\x20签到成功（'+illIi1['join']('，')+'）');for(const i1i11I of illIi1){illIii['insert'](i1i11I);}}}else iIiII['VfnAz'](iIiII['DnsGy'],iIiII['DnsGy'])?ll1il[iliIi1(0x192,'h4tC')](iliIi1(0x25f,'3WI0')+IiiIiI+iliIi1(0x20d,'RQaA')+(lilii['message']||l1iiI)):console['log'](''+iil1lI+II1i1+iliIi1(0x21c,'EyP]'));lIli11=![];}else{if(iIiII[iliIi1(0x22d,'kqWO')](lillIi[iliIi1(0x266,'!01T')],0xc8)){const iii1ii=signStatusMessages[lillIi[iliIi1(0x173,'V&9x')]]||lillIi[iliIi1(0x1d0,'SeVv')]+iliIi1(0x232,'bs(a');[0x1843da61,0x1843da62,0x192][iliIi1(0x21f,'kD2z')](lillIi[iliIi1(0x1e6,'AeW)')])&&invalidTokensMap['set'](II1i1,!![]),console['log'](''+iil1lI+II1i1+iliIi1(0x271,'SeVv')+iii1ii+'）'),(lillIi[iliIi1(0x269,'Nv@i')]==='-1'||iIiII[iliIi1(0x1e4,'PETL')](lillIi[iliIi1(0x1d0,'SeVv')],-0x1))&&(lIli11=!![]);}else{if(lillIi[iliIi1(0x254,'wuFY')]){console[iliIi1(0x1a8,'aKsC')](''+iil1lI+II1i1+iliIi1(0x26e,'i3eQ')+lillIi[iliIi1(0x214,'SeVv')]+'）');if(!signStatusMessages[lillIi[iliIi1(0x260,'EyP]')]])lIli11=!![];}else console['log'](''+iil1lI+II1i1+iliIi1(0x1cf,'h4tC')+JSON[iliIi1(0x251,'PETL')](lillIi));}}break;}}catch(il1iIi){if(iIiII['Kydnz']!==iIiII[iliIi1(0x1b2,'h4tC')])console[iliIi1(0x231,'0jv!')](iliIi1(0x19f,'021W')+lIli1l+'\x20请求响应\x20'+(il1iIi[iliIi1(0x1f1,'X$eK')]||il1iIi));else{const II11li=IlI11[iliIi1(0x25d,'a0Gw')](iIIIIl,iIiII[iliIi1(0x22f,'3WI0')]),I1l11i=II1Il[iliIi1(0x1a6,'M]gz')](II11li);lilIlI=new iIIIIi();for(const iIIiiI in I1l11i){i1ii[iliIi1(0x224,'b([2')](iIIiiI,I1l11i[iIIiiI]);}}}}async function lillI1(liiI1i){const l1l1ii=I11i1I,ililIi={'Nxnve':function(lilIIl,ililIl){return lilIIl>ililIl;},'RNFPo':function(liiI1l,i1l1II){return iIiII['VfnAz'](liiI1l,i1l1II);}};if(iIiII['ykYWa']!==iIiII[l1l1ii(0x27e,')iRe')]){let i1ill='',I1l11l=null,lilIIi=null,i1l1Il=iIiII['gbSDl'],llIli={},i1i11l={};switch(liiI1i){case iIiII[l1l1ii(0x26b,'1]8W')]:i1i11l={'appId':iIiII[l1l1ii(0x1fe,'PETL')],'functionId':iIiII[l1l1ii(0x23b,'RQaA')],'appid':l1l1ii(0x1c3,'ZS6o'),'body':{'token':II1i1,'venderId':parseInt(Ill1I)||'','activityId':iIiII['qhwBH'](parseInt,i11iiI)||'','type':0x38,'actionType':0x7},'version':iIiII[l1l1ii(0x1c7,'$CkC')],'ua':iiiliI},llIli=await H5st[l1l1ii(0x19b,'M]gz')](i1i11l),i1ill=iIiII[l1l1ii(0x18c,'RQaA')],lilIIi=Object[l1l1ii(0x1fb,'1]8W')]({},llIli['paramsData'],{'jsonp':iIiII[l1l1ii(0x1c5,'AeW)')]});break;}const i1i11i={'t':illIil,'loginType':'2','x-api-eid-token':ii1il1};if(I1l11l){if(iIiII[l1l1ii(0x16a,'wuFY')](l1l1ii(0x202,'h4tC'),iIiII[l1l1ii(0x1a4,'Yo(o')])){const iilli=i1illI(i1IIl);ililIi[l1l1ii(0x222,'x@%0')](iilli,0x0)&&ililIi[l1l1ii(0x1d4,'35n@')](iilli,0x1)&&(i1IIi=iilli);}else Object['assign'](I1l11l,i1i11i);}lilIIi&&(iIiII['LgTcV'](l1l1ii(0x247,'0S4W'),iIiII[l1l1ii(0x270,'An(k')])?Object['assign'](lilIIi,i1i11i):l1lIl1[l1l1ii(0x1dc,'1bNd')](IiiIlI));const II11l1={'url':i1ill,'method':i1l1Il,'headers':{'Accept':iIiII['wZTWU'],'Accept-Encoding':iIiII['UwhQd'],'Accept-Language':iIiII['lUrpn'],'Connection':iIiII[l1l1ii(0x23c,']Vy*')],'Content-Type':iIiII['WqMRd'],'Host':l1l1ii(0x21d,'n[T8'),'Referer':iIiII[l1l1ii(0x179,'X$eK')],'Sec-Fetch-Dest':iIiII[l1l1ii(0x1bd,'!!j0')],'Sec-Fetch-Mode':iIiII['znpmT'],'Sec-Fetch-Site':iIiII[l1l1ii(0x249,'ndBM')],'User-Agent':iiiliI,'Cookie':li1i1I},'params':lilIIi,'data':I1l11l,'timeout':0x7530};i1l1Il===l1l1ii(0x243,'PETL')&&(delete II11l1[l1l1ii(0x172,'wuFY')],delete II11l1['headers'][iIiII[l1l1ii(0x245,'AeW)')]]);const Iil1lI=0x3;let IiiliI=0x0,iii1iI=null,llIll=![];while(IiiliI<Iil1lI){const II11lI=await common[l1l1ii(0x1d5,'1]8W')](II11l1);if(!II11lI['success']){if(iIiII['LgTcV'](iIiII['JjaKo'],iIiII[l1l1ii(0x1b6,'kqWO')]))ll1lI['log'](l1iii),IIlli&&(ii1l1['outFlag']=!![]);else{iii1iI=''+iil1lI+II1i1+'\x20➜\x20请求失败（'+II11lI['error']+l1l1ii(0x27a,'Nv@i'),IiiliI++;continue;}}if(!II11lI[l1l1ii(0x17b,'n[T8')]){if(iIiII[l1l1ii(0x18d,'SeVv')](l1l1ii(0x1d3,'An(k'),iIiII[l1l1ii(0x205,'wuFY')])){iii1iI=''+iil1lI+II1i1+l1l1ii(0x17c,'aKsC'),IiiliI++;continue;}else Iii11I=0x1;}lllI1I(liiI1i,II11lI[l1l1ii(0x16e,']tSH')]),llIll=![];break;}iIiII[l1l1ii(0x1ff,'1bNd')](IiiliI,Iil1lI)&&(console[l1l1ii(0x26d,'An(k')](iii1iI),llIll&&(iIiII[l1l1ii(0x196,'a0Gw')](l1l1ii(0x250,'0jv!'),iIiII[l1l1ii(0x17d,'kqWO')])?$[l1l1ii(0x1f7,'ZS6o')]=!![]:(delete Iiii1[l1l1ii(0x191,'3WI0')],delete lIIili[l1l1ii(0x244,'V&9x')][l1l1ii(0x19a,'PETL')])));}else I1iIli[l1l1ii(0x213,'nacw')]('❌\x20脚本运行遇到了错误\x0a'+lI1Ill);}}async function concMain(iilll=0x1,il1iI1,IlllIi,iIIiil,i1l1Ii){const Il1i1I=llI11i,I1iIIi={'TQybT':function(i1il1,I1l111){return i1il1(I1l111);},'Wqmto':function(IIii1l,I1iIII){return IIii1l!==I1iIII;},'cLAqr':Il1i1I(0x180,'aKsC'),'KcAFm':function(liiI11,ililI1,IIii1i){return liiI11(ililI1,IIii1i);},'AGZLB':function(i1ili){return i1ili();},'DkSyR':function(Iiill1,I1iII1){return Iiill1<I1iII1;},'nDcDG':function(lilII1,iill1){return lilII1>iill1;},'UqyjF':function(iii1l1,IIliIl){return iii1l1(IIliIl);},'MpRxi':'pt_pin','hvnzQ':Il1i1I(0x1f8,'kD2z'),'FHQpc':'SJHT-DPQDH5','YkkWv':function(II11ll,liiI1I){return II11ll===liiI1I;},'bduMz':Il1i1I(0x257,'021W'),'UBqRQ':function(ililII,lI1II1){return ililII===lI1II1;},'zuwjJ':'lvjdR','cQsjK':function(i1ilII){return i1ilII();}},I1iIIl=il1iI1[Il1i1I(0x19d,'V&9x')](iIIii1=>iIIii1),lI1IIl=decodeURIComponent(common[Il1i1I(0x248,'kcwP')](IlllIi,I1iIIi[Il1i1I(0x229,']Vy*')])),i1ilI=notify[Il1i1I(0x1db,'!!j0')](iIIiil,lI1IIl),iii1lI='【账号'+iIIiil+'】'+lI1IIl+'：',i1ilI1=common[Il1i1I(0x23d,'R6u&')](lI1IIl),{jsToken:Iiilii}=await jsTk(i1ilI1,I1iIIi['hvnzQ'],{'bizId':I1iIIi[Il1i1I(0x1e3,'EyP]')],'v':Il1i1I(0x1ab,'rOI['),'qs':Il1i1I(0x23a,']tSH')+il1iI1[0x0]}),Iil1li={'title':iii1lI,'UA':i1ilI1,'cookie':IlllIi,'index':iIIiil,'message':i1ilI,'jsToken':Iiilii},Iiilil=await common[Il1i1I(0x25a,'aKsC')](IlllIi);if(!Iiilil&&I1iIIi[Il1i1I(0x194,'gJs@')](typeof Iiilil,I1iIIi['bduMz'])){if(I1iIIi['UBqRQ'](Il1i1I(0x1a9,'kD2z'),Il1i1I(0x1ed,'ZS6o'))){const lilIII=I1iIIi['TQybT'](Ii1iIi,iliIIl);Ii1iIl=lilIII>0x0?lilIII:0x0;}else{console[Il1i1I(0x1be,'[U2j')](iii1lI+Il1i1I(0x1ae,'[U2j'));return;}}let Iil1ll=0x0;async function iillI(Ii1ilI){const Ii1iii=Il1i1I;I1iIIi['Wqmto'](I1iIIi['cLAqr'],'muNcb')?(await I1iIIi[Ii1iii(0x1e2,'#WWy')](i1l1Ii,Ii1ilI,Iil1li),Iil1ll--,I1iIIi[Ii1iii(0x234,'RQaA')](lI1III)):l1i111=iliII1;}async function lI1III(){const iIIilI=Il1i1I;while(I1iIIi['DkSyR'](Iil1ll,iilll)&&I1iIIi[iIIilI(0x230,'b([2')](I1iIIl['length'],0x0)){const iliIil=I1iIIl[iIIilI(0x1f5,'gJs@')]();Iil1ll++,await I1iIIi['UqyjF'](iillI,iliIil);}}const IIliIi=Math['min'](I1iIIl['length'],iilll),IllIiI=[];for(let iliIii=0x0;I1iIIi[Il1i1I(0x27f,'ZS6o')](iliIii,IIliIi);iliIii++){if(I1iIIi[Il1i1I(0x1b4,'!01T')](I1iIIi['zuwjJ'],I1iIIi[Il1i1I(0x1fd,'AeW)')])){const lill1i=I1iIIl[Il1i1I(0x203,'R6u&')]();Iil1ll++,IllIiI[Il1i1I(0x204,'1]8W')](I1iIIi[Il1i1I(0x201,'i3eQ')](iillI,lill1i));}else II11II=0x1;}await Promise['all'](IllIiI),I1iIIi[Il1i1I(0x1cb,'4^#9')](lI1III),await new Promise(iIIill=>{const il1l1=Il1i1I,iilii={'KjHWd':function(iilil,Ill11l){return iilil===Ill11l;},'wwCFq':function(il1ll){return il1ll();}},Ill11i=I1iIIi[il1l1(0x1df,'AeW)')](setInterval,()=>{iilii['KjHWd'](Iil1ll,0x0)&&(clearInterval(Ill11i),iilii['wwCFq'](iIIill));},0x64);});}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
