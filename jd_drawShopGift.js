/*
活动名称：店铺关注有礼
活动链接：店铺首页关注按钮
环境变量：jd_drawShopGift_argv // 活动参数，支持三种格式：”<shopId(店铺id)>_<venderId(店主id)>“ 或 ”<venderId(店主id)>“ 或 ”<活动店铺首页链接>“
        jd_drawShopGift_threads // 控制并发线程数（正整数），默认1
        jd_drawShopGift_interval // 自定义运行间隔时长（整数，单位毫秒），默认1000
        jd_drawShopGift_notify // 是否推送通知（true/false），默认不推送

高并发脚本，黑号领不到奖品
活动限制IP严重，建议使用代理，谨慎使用并发

cron:1 1 1 1 *

*/

const $ = new Env('店铺关注有礼')
var iｉl='jsjiami.com.v7';const lllI11=iii1II;(function(iil1lI,iiiliI,li1i1I,illIii,ii1il1,lI1llI,illIil){return iil1lI=iil1lI>>0x2,lI1llI='hs',illIil='hs',function(Ill1I,i11iiI,lIli11,lllI1I,lillI1){const II1il=iii1II;lllI1I='tfi',lI1llI=lllI1I+lI1llI,lillI1='up',illIil+=lillI1,lI1llI=lIli11(lI1llI),illIil=lIli11(illIil),lIli11=0x0;const IlIlii=Ill1I();while(!![]&&--illIii+i11iiI){try{lllI1I=-parseInt(II1il(0x1ea,'*eAf'))/0x1*(parseInt(II1il(0x1dc,'Ck6q'))/0x2)+-parseInt(II1il(0x10a,'SfMX'))/0x3*(-parseInt(II1il(0x1b0,'Vs$D'))/0x4)+parseInt(II1il(0x107,'6%I%'))/0x5+-parseInt(II1il(0x142,'rSCg'))/0x6+-parseInt(II1il(0x1fb,'d6l*'))/0x7+-parseInt(II1il(0x1ff,'Cx5G'))/0x8+parseInt(II1il(0x156,'mGec'))/0x9;}catch(i1l1i1){lllI1I=lIli11;}finally{lillI1=IlIlii[lI1llI]();if(iil1lI<=illIii)lIli11?ii1il1?lllI1I=lillI1:ii1il1=lillI1:lIli11=lillI1;else{if(lIli11==ii1il1['replace'](/[PpAHBXUWDVtNwCLTyhYG=]/g,'')){if(lllI1I===i11iiI){IlIlii['un'+lI1llI](lillI1);break;}IlIlii[illIil](lillI1);}}}}}(li1i1I,iiiliI,function(liil11,iiillI,l1l111,l1iIII,llI1I1,IlIlil,lIli1I){return iiillI='\x73\x70\x6c\x69\x74',liil11=arguments[0x0],liil11=liil11[iiillI](''),l1l111=`\x72\x65\x76\x65\x72\x73\x65`,liil11=liil11[l1l111]('\x76'),l1iIII=`\x6a\x6f\x69\x6e`,(0x15eb78,liil11[l1iIII](''));});}(0x328,0xb61c7,Iii11l,0xcc),Iii11l)&&(iｉl=0x13a);function iii1II(_0x279134,_0x22551b){const _0x3edf9b=Iii11l();return iii1II=function(_0x4d0456,_0x2ee0d2){_0x4d0456=_0x4d0456-0xd6;let _0x43b932=_0x3edf9b[_0x4d0456];if(iii1II['BCeijR']===undefined){var _0x13db6c=function(_0x4e1aaf){const _0x2f37ac='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5133e8='',_0x263073='';for(let _0x1d3594=0x0,_0x7e0172,_0x1594bf,_0x537363=0x0;_0x1594bf=_0x4e1aaf['charAt'](_0x537363++);~_0x1594bf&&(_0x7e0172=_0x1d3594%0x4?_0x7e0172*0x40+_0x1594bf:_0x1594bf,_0x1d3594++%0x4)?_0x5133e8+=String['fromCharCode'](0xff&_0x7e0172>>(-0x2*_0x1d3594&0x6)):0x0){_0x1594bf=_0x2f37ac['indexOf'](_0x1594bf);}for(let _0x3586a4=0x0,_0x2a7cdc=_0x5133e8['length'];_0x3586a4<_0x2a7cdc;_0x3586a4++){_0x263073+='%'+('00'+_0x5133e8['charCodeAt'](_0x3586a4)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x263073);};const _0x440103=function(_0xeb91be,_0x3fe147){let _0x365059=[],_0x501913=0x0,_0x99d73c,_0xc4a05e='';_0xeb91be=_0x13db6c(_0xeb91be);let _0x57b3ce;for(_0x57b3ce=0x0;_0x57b3ce<0x100;_0x57b3ce++){_0x365059[_0x57b3ce]=_0x57b3ce;}for(_0x57b3ce=0x0;_0x57b3ce<0x100;_0x57b3ce++){_0x501913=(_0x501913+_0x365059[_0x57b3ce]+_0x3fe147['charCodeAt'](_0x57b3ce%_0x3fe147['length']))%0x100,_0x99d73c=_0x365059[_0x57b3ce],_0x365059[_0x57b3ce]=_0x365059[_0x501913],_0x365059[_0x501913]=_0x99d73c;}_0x57b3ce=0x0,_0x501913=0x0;for(let _0x2dcdd5=0x0;_0x2dcdd5<_0xeb91be['length'];_0x2dcdd5++){_0x57b3ce=(_0x57b3ce+0x1)%0x100,_0x501913=(_0x501913+_0x365059[_0x57b3ce])%0x100,_0x99d73c=_0x365059[_0x57b3ce],_0x365059[_0x57b3ce]=_0x365059[_0x501913],_0x365059[_0x501913]=_0x99d73c,_0xc4a05e+=String['fromCharCode'](_0xeb91be['charCodeAt'](_0x2dcdd5)^_0x365059[(_0x365059[_0x57b3ce]+_0x365059[_0x501913])%0x100]);}return _0xc4a05e;};iii1II['nrgLmt']=_0x440103,_0x279134=arguments,iii1II['BCeijR']=!![];}const _0x39e094=_0x3edf9b[0x0],_0x20a563=_0x4d0456+_0x39e094,_0x2a68a2=_0x279134[_0x20a563];return!_0x2a68a2?(iii1II['avMibh']===undefined&&(iii1II['avMibh']=!![]),_0x43b932=iii1II['nrgLmt'](_0x43b932,_0x2ee0d2),_0x279134[_0x20a563]=_0x43b932):_0x43b932=_0x2a68a2,_0x43b932;},iii1II(_0x279134,_0x22551b);}const jdCookie=require(lllI11(0x1c2,'9)SJ')),notify=require('./utils/Rebels_sendJDNotify'),common=require(lllI11(0xeb,'X[B*'));console[lllI11(0x106,'*9$9')](''),console['log'](lllI11(0x1c6,'mGec')+$[lllI11(0x1d8,'5OCM')]+lllI11(0x1ce,'FWgq')),console[lllI11(0x153,']&]N')]('jd_drawShopGift_argv\x20//\x20活动参数'),console[lllI11(0x14d,'Vs$D')](lllI11(0xf6,'WBW8')),console['log'](lllI11(0xf4,'Ck6q')),console[lllI11(0x1b3,'Dajv')](lllI11(0x124,'dOyz')),console[lllI11(0x13c,'q3G*')](lllI11(0x1f7,'LDO5')+$['name']+lllI11(0x112,'*eAf')),console[lllI11(0x186,'6%I%')]('');const activityArgv=process[lllI11(0x16f,'5OCM')][lllI11(0x171,'dOyz')]||'';let taskThreads=process[lllI11(0x161,'LOGe')]['jd_drawShopGift_threads']||'1';const runInterval=process[lllI11(0x132,']&]N')]['jd_drawShopGift_interval']||lllI11(0x18a,'*9$9'),isNotify=(process['env'][lllI11(0x1dd,'jH)L')]||process[lllI11(0x17d,'Mo^b')][lllI11(0x16d,'X[B*')])===lllI11(0x191,'kMFk'),cookiesArr=Object['keys'](jdCookie)[lllI11(0x1cd,'dOyz')](l1il1i=>jdCookie[l1il1i])['filter'](ll1=>ll1);!cookiesArr[0x0]&&($['msg']($[lllI11(0x128,'FWgq')],lllI11(0x1e2,'rMj#')),process[lllI11(0x1f1,'B5XD')](0x1));!(async()=>{const I1lIll=lllI11,iI1llI={'aQjoN':function(llliii,IllI11){return llliii(IllI11);},'TMgRS':function(l1llIi,II1llI){return l1llIi>II1llI;},'QJPeB':function(i11I11){return i11I11();},'PDbCc':function(l1llIl,ii1I1l){return l1llIl!==ii1I1l;},'HOCKY':I1lIll(0x1e6,'VspI')};notify[I1lIll(0x130,'kMFk')]({'title':$['name']}),await iI1llI['QJPeB'](Main);if(isNotify&&notify[I1lIll(0x123,'*eAf')]()){if(iI1llI[I1lIll(0x1de,'Q4]Y')]('EWtZj',iI1llI[I1lIll(0x14e,'B(t(')]))await notify['push']();else{const llI=iI1llI[I1lIll(0x1d3,'Mo^b')](l1i11I,II11II);iI1llI['TMgRS'](llI,0x0)&&(lilIli[I1lIll(0x175,'9)SJ')]=llI);}}})()[lllI11(0x154,'bIY2')](llliI=>$[lllI11(0xee,'ORAP')](llliI))['finally'](()=>$[lllI11(0xfe,'rSCg')]());async function Main(){const I1lIli=lllI11,iI1li1={'mfEcy':I1lIli(0x101,'5OCM'),'xnuaB':I1lIli(0x1be,'WBW8'),'MEZOm':function(lllii1,liIli){return lllii1(liIli);},'uCJUi':function(liIll,IilIi1){return liIll>IilIi1;},'duqkf':function(iI1liI,l1lIiI){return iI1liI!==l1lIiI;},'xINiy':I1lIli(0xde,'dOyz'),'qWSPI':'EYRDo','bWlnr':function(llliiI,IilIiI){return llliiI===IilIiI;},'wTfao':I1lIli(0x1da,']&]N'),'HDLED':I1lIli(0x1c3,'B5XD'),'BsWUy':'CXsgF','hEZVF':'uqNDn','enRKJ':function(i1i1I1,IlII1){return i1i1I1||IlII1;},'ZxkKS':function(IiI11,lli){return IiI11+lli;},'CRgoK':function(liIlI,lll){return liIlI(lll);},'DmYVS':'SfNiD','QXucR':I1lIli(0x1b1,'5OCM'),'CfRlm':I1lIli(0xe0,'B(t('),'uYJiB':I1lIli(0x127,'&Iuj')};try{if(iI1li1[I1lIli(0x159,'LDO5')]('CJZRJ',I1lIli(0x1ab,'57wv'))){if(!activityArgv){if('sGmPH'!==iI1li1[I1lIli(0x1d6,'LOGe')]){console[I1lIli(0x14b,'VspI')](I1lIli(0x19e,'pe*e'));return;}else lI1Iil[I1lIli(0x1f9,'Q4]Y')]=lilIiI[0x0];}try{if(activityArgv[I1lIli(0x168,'mGec')](I1lIli(0x14c,'CD6W'))){if(iI1li1['duqkf'](iI1li1[I1lIli(0xe9,'Cx5G')],I1lIli(0x1c7,'9)SJ'))){const {shopId:l1lIi1,venderId:iIli1l,vendorId:i1i1II}=common[I1lIli(0x117,'Dajv')](activityArgv);$['shopId']=l1lIi1,$[I1lIli(0x163,'FgI(')]=iIli1l||i1i1II;}else i1ll[I1lIli(0x12a,'Dajv')]=i1l1lI[0x0],i1iliI['venderId']=I1iIii[0x1];}else{if(iI1li1[I1lIli(0x147,'rMj#')](iI1li1['wTfao'],'pegfD')){const iil1iI=activityArgv[I1lIli(0x1eb,'VspI')]('_');iI1li1[I1lIli(0x145,'bm6(')](iil1iI[I1lIli(0x182,'Mo^b')],0x2)?($[I1lIli(0xfc,'B5XD')]=iil1iI[0x0],$[I1lIli(0x196,')Z&B')]=iil1iI[0x1]):$[I1lIli(0x15b,'pe*e')]=iil1iI[0x0];}else{IiilIi[I1lIli(0x16a,'FgI(')](iI1li1[I1lIli(0x140,'z^I^')]);return;}}}catch{if(iI1li1[I1lIli(0x1ba,'6%I%')]!==iI1li1['BsWUy']){console['log'](I1lIli(0x141,'*9$9'));return;}else{iIIII1[I1lIli(0x1c1,'5OCM')](iI1li1['xnuaB']);return;}}finally{if(iI1li1['hEZVF']!==iI1li1[I1lIli(0x1ec,'bIY2')])I1l1Ii[I1lIli(0x1a1,'B5XD')](I1lIli(0x1e7,'X[B*')+I1i11i+'）');else{if(!$[I1lIli(0x184,'Vs$D')]&&!$[I1lIli(0x12e,'*eAf')]){console['log'](iI1li1[I1lIli(0xd6,'*9$9')]);return;}}}const llli1=await common['getShopDetail']({'venderId':''[I1lIli(0x12b,'CD6W')]($['venderId']||''),'shopId':''['concat']($[I1lIli(0x146,'bIY2')]||'')}),{shopName:iIli1i,shopId:iI1lii,venderId:IilIii}=llli1?.['shopBaseInfo'];if(iI1li1[I1lIli(0x1d1,'Q4]Y')](!iI1lii,!IilIii)){console['log'](iI1li1['xnuaB']);return;}$[I1lIli(0x1d4,'Ixs3')]=iI1lii,$[I1lIli(0xe1,'p7#5')]=IilIii,console[I1lIli(0x1f5,'9)SJ')]((iIli1i&&I1lIli(0x114,'CD6W')+iIli1i+'\x0a')+I1lIli(0x176,'z^I^')+$[I1lIli(0xe5,'VspI')]+I1lIli(0x178,'d6l*')+$['venderId']+'\x0a'),notify[I1lIli(0x105,'Vs$D')](iI1li1[I1lIli(0x1a6,'URrO')](notify[I1lIli(0x200,'Dajv')],(iIli1i&&'\x0a【店铺名称】'+iIli1i)+I1lIli(0x17e,'jH)L')+$[I1lIli(0x1f4,'WBW8')]+I1lIli(0xd8,'*2O2')+$[I1lIli(0xdc,'mGec')]));try{const iI11II=iI1li1[I1lIli(0x17b,'kMFk')](parseInt,taskThreads);iI1li1['uCJUi'](iI11II,0x0)&&iI11II!==0x1&&(iI1li1[I1lIli(0x181,'bm6(')](iI1li1[I1lIli(0x1a0,'bIY2')],iI1li1['QXucR'])?taskThreads=iI11II:i1illi['waitTime']=i1illl);}catch{taskThreads=0x1;}$[I1lIli(0x1cb,'k&#F')]=null;if(runInterval)try{const ilil1i=parseInt(runInterval);if(ilil1i>0x0){if(iI1li1[I1lIli(0x15a,'6%I%')]!==iI1li1['CfRlm'])return I1l1Il[I1lIli(0x148,'^M%%')](llIll1[I1lIli(0x1ee,'Q4]Y')]()),{'runEnd':!![]};else $[I1lIli(0x150,'YsC^')]=ilil1i;}}catch{console['log'](iI1li1[I1lIli(0x113,'FWgq')]);}await common[I1lIli(0x1c8,'jH)L')](taskThreads,cookiesArr,taskFnc);}else try{const illlII=iI1li1[I1lIli(0x100,'FgI(')](Iliiii,i1illI);iI1li1[I1lIli(0x1af,'p7#5')](illlII,0x0)&&(I1lll1[I1lIli(0x1cc,'X[B*')]=illlII);}catch{IIII1I['log'](I1lIli(0x13b,')Z&B'));}}catch(iIII11){console[I1lIli(0x195,'B5XD')](I1lIli(0xf0,'6%I%')+iIII11);}}async function taskFnc(IiI1i,llll1){const II1ii=lllI11,lil11l={'SAKJh':'未知活动状态','vUfJu':II1ii(0x122,'YsC^'),'BrCOI':II1ii(0xf2,'FgI('),'ELtid':II1ii(0x1d2,'WBW8'),'hlYOE':II1ii(0x137,'D)5!'),'SiPPM':function(iil1i1,il1i11){return iil1i1===il1i11;},'maesE':II1ii(0x19f,'X[B*'),'NZMkf':II1ii(0x116,'q3G*'),'EFAcq':II1ii(0x19b,'z^I^'),'Ikbtz':'200','evVuc':function(IlIll1,IlIII){return IlIll1===IlIII;},'tsUPl':II1ii(0x151,'k&#F'),'YJona':'402','HVTIy':'405000001','zuGUD':II1ii(0x1df,'4joD'),'cbFaG':'未知奖品领取状态','vgghZ':'F0402','zMAGo':'XDjRQ','EPvST':II1ii(0xe7,'B(t('),'zvUJi':II1ii(0xd7,'Vs$D'),'eWBhy':function(ilil1l,illlIi){return ilil1l!==illlIi;},'LmzDn':'bDGso','aqUVp':'kPWpe','tsOLV':II1ii(0x1e9,'Ck6q'),'OPOem':II1ii(0x11a,'ORAP'),'kJjFM':'app-shop','bWQKa':'shop_app_home_home','OzyLL':function(I1lIii,IiI1I){return I1lIii||IiI1I;},'XWKJk':II1ii(0xfa,'CD6W'),'dYgoO':II1ii(0x11b,')Z&B'),'rqWIS':'gzip,\x20deflate,\x20br','Hgyno':'keep-alive','fBhbp':'application/x-www-form-urlencoded','tuaFS':II1ii(0x1e3,'D)5!'),'KvRis':'cors','YmwVu':II1ii(0x174,'z^I^'),'knzEN':II1ii(0x1b7,'&Iuj'),'ZGNXY':'ios_4.0.0','tdaKx':function(illlIl,i11ill){return illlIl!==i11ill;},'ZrVtu':II1ii(0x133,'URrO'),'FbKZe':function(IIIIIi,IIIIIl){return IIIIIi!==IIIIIl;},'IBGoI':'XPMbn','nMKvl':function(I1lIil,IIIl1i,liiII1){return I1lIil(IIIl1i,liiII1);},'kbNEX':function(IIIl1l,lllll){return IIIl1l>=lllll;},'IhlKb':'pt_pin','dIgDU':'boolean','aqlvc':function(i11ili,iil1l1){return i11ili+iil1l1;},'VIdfy':II1ii(0x201,'dOyz'),'dvYoI':function(lllli,iiili1){return lllli-iiili1;},'tHZWI':function(ill11i,lllill){return ill11i*lllill;},'yYJcl':function(ill11l,I1lIiI){return ill11l(I1lIiI);},'FCQkx':II1ii(0x139,'LDO5'),'bhLed':II1ii(0xf9,'z^I^'),'QoXhj':function(lllili,IliiiI){return lllili!==IliiiI;},'tJwPR':II1ii(0x103,'q3G*'),'qkvLw':'活动不存在或已领过','nfoLa':'dkiVN','gLhKn':function(Ill11,liiIII){return Ill11===liiIII;},'jQfbX':II1ii(0x199,'FWgq'),'SkSLJ':function(li1i11,iI11I1){return li1i11(iI11I1);},'roxdO':function(il1i1l,IlIlll){return il1i1l!==IlIlll;}};if($[II1ii(0x104,'LDO5')])return{'runEnd':!![]};const i1i1Il=decodeURIComponent(common[II1ii(0xda,'Vs$D')](IiI1i,lil11l[II1ii(0xf7,'qAjK')])),I1lIl1=notify[II1ii(0xf3,'dOyz')](llll1,i1i1Il),lil11i=await common[II1ii(0x144,'mGec')](IiI1i);if(!lil11i&&lil11l[II1ii(0x1b8,'bIY2')](typeof lil11i,lil11l['dIgDU'])){I1lIl1['fix'](II1ii(0xf1,'Xws!')),console['log'](I1lIl1[II1ii(0x19a,'6%I%')]());return;}const IlIIl=common[II1ii(0xea,'LOGe')](i1i1Il),lI1liI=lil11l[II1ii(0x1c0,')Z&B')](lil11l[II1ii(0x1a7,'dOyz')],Math[II1ii(0x198,'Mo^b')](Math['random']()*lil11l[II1ii(0x165,'Xws!')](0x2710,0x1869f)))+0x1869f,i1i1Ii=lil11l[II1ii(0x1a3,'rMj#')](lil11l['aqlvc'](II1ii(0x1f6,'Mo^b'),Math[II1ii(0x14a,'&Iuj')](lil11l[II1ii(0x162,'^M%%')](Math[II1ii(0x183,'CD6W')](),0x2710-0x1869f))),0x1869f),lllii=common[II1ii(0x194,'p7#5')]($['UserName']),iI11Ii=common[II1ii(0x1aa,'LOGe')]();let iIII1l='',lllil='';await lil11l['yYJcl'](iIII1i,lil11l[II1ii(0x188,'YsC^')]);if(!lllil){if(lil11l[II1ii(0x190,']&]N')](lil11l[II1ii(0x192,'6%I%')],lil11l[II1ii(0x1db,'9)SJ')])){I1lIl1['fix'](lil11l[II1ii(0x13e,'pe*e')]),console[II1ii(0x1bf,'B(t(')](I1lIl1[II1ii(0x13d,'qAjK')]());return;}else l1lIil[II1ii(0x11c,'rMj#')](lil11l[II1ii(0x158,'ORAP')]);}if($['runEnd'])return{'runEnd':!![]};iIII1l=lllil?.[II1ii(0x12f,'z^I^')];if(!iIII1l){if(lil11l[II1ii(0x15f,'CD6W')](lil11l[II1ii(0x138,'mGec')],lil11l[II1ii(0x1ac,'WBW8')])){IiilI1[II1ii(0x1f5,'9)SJ')](lil11l[II1ii(0xf5,'q3G*')]);return;}else{I1lIl1[II1ii(0x19d,'mGec')](lil11l[II1ii(0x1d5,'Vs$D')]),console[II1ii(0x17a,'rMj#')](I1lIl1['getInlineContent']());return;}}if(lllil[II1ii(0x164,']&]N')]){if(lil11l[II1ii(0xfb,'SfMX')]!==II1ii(0x125,'B5XD')){const IlIlli=await common[II1ii(0x10e,'d6l*')](![],$[II1ii(0xfd,'bm6(')]);if(!IlIlli&&lil11l[II1ii(0x1bd,'pe*e')](typeof IlIlli,lil11l[II1ii(0x152,'VspI')])){if(lil11l[II1ii(0xef,'FgI(')]===lil11l[II1ii(0x189,'bIY2')]){I1lIl1['fix'](II1ii(0x135,'B5XD')),console['log'](I1lIl1[II1ii(0x13f,'^M%%')]());return;}else{lIIilI[II1ii(0x173,'Ck6q')](II1ii(0x1ad,']&]N')),II1li1[II1ii(0xdb,'Q4]Y')](l1lIlI[II1ii(0x13f,'^M%%')]());return;}}}else IIliI['log'](II1ii(0x155,'6%I%')+ilI1ll+II1ii(0x102,'*9$9')+(Iillii['message']||IlI1iI));}if($['waitTime'])$[II1ii(0x11e,'FgI(')]($['waitTime']);await lil11l[II1ii(0x167,'bm6(')](iIII1i,lil11l[II1ii(0x1e8,'Xws!')]);if($['runEnd']){if(lil11l[II1ii(0x166,'6%I%')](II1ii(0x1e5,'CD6W'),'UCgIL'))return console[II1ii(0x1b3,'Dajv')](I1lIl1[II1ii(0x160,'FWgq')]()),{'runEnd':!![]};else{i1l1li[II1ii(0x121,'4joD')](lil11l[II1ii(0x1e4,'SfMX')]);return;}}if($['waitTime'])$['wait']($[II1ii(0x1b9,'d6l*')]);console['log'](I1lIl1[II1ii(0xe8,'*eAf')]());function iI11Il(ii1ii1,llllI){const IIIIII=II1ii,lllil1={'WZueU':lil11l[IIIIII(0x1d9,'qAjK')],'GPwFP':'账号无效'};try{switch(ii1ii1){case lil11l[IIIIII(0x134,'kMFk')]:lil11l['SiPPM'](llllI[IIIIII(0xdd,'Q4]Y')],'0')&&llllI['isSuccess']&&llllI['result']?lil11l[IIIIII(0x1f3,'4joD')]===lil11l['maesE']?lllil=llllI['result']:(delete lIIiiI['data'],delete II1lil[IIIIII(0x1a9,'k&#F')][lllil1['WZueU']]):I1lIl1[IIIIII(0x1f0,'*eAf')](IIIIII(0xe2,'D)5!'));break;case lil11l[IIIIII(0x126,'k&#F')]:if(lil11l[IIIIII(0x202,'jH)L')](llllI[IIIIII(0x169,'pe*e')],'0')&&llllI[IIIIII(0x17f,'FWgq')]&&llllI[IIIIII(0xff,'z^I^')]){const {followCode:ilil1I,followDesc:i11il1,giftCode:ii1iiI,giftDesc:lllilI,alreadyReceivedGifts:ilil11}=llllI[IIIIII(0x185,'d6l*')];switch(ilil1I){case lil11l[IIIIII(0x1fd,'Q4]Y')]:switch(ii1iiI){case lil11l[IIIIII(0x1e1,'4joD')]:for(const illlI1 of ilil11){if(lil11l[IIIIII(0x11f,'5OCM')](lil11l[IIIIII(0x1c5,'^M%%')],lil11l[IIIIII(0x10b,'57wv')])){let IIIl11=[illlI1?.[IIIIII(0x18c,'57wv')],illlI1?.['rearWord']]['join']('');switch(illlI1?.['prizeType']){case 0x1:case 0x2:case 0x3:I1lIl1[IIIIII(0x1b2,'Mo^b')](IIIl11+IIIIII(0x136,'4joD'));break;case 0x4:I1lIl1[IIIIII(0x1c4,'URrO')](IIIl11+'🐶');break;case 0x6:I1lIl1['insert'](IIIl11+IIIIII(0xec,'rMj#'));break;default:I1lIl1['insert'](IIIl11);break;}}else{II1liI['fix'](IIIIII(0x172,'Mo^b')),IlI1i1[IIIIII(0x14b,'VspI')](l1lIl1[IIIIII(0x15d,']&]N')]());return;}}break;case lil11l[IIIIII(0x119,'SfMX')]:console[IIIIII(0x14b,'VspI')](lllilI);for(let liiIIi of['抢完']){if(lllilI[IIIIII(0x10c,'p7#5')](liiIIi)){$[IIIIII(0x110,'LOGe')]=!![],I1lIl1['insert'](lllilI);break;}}break;case lil11l['HVTIy']:I1lIl1[IIIIII(0x18f,'^M%%')](lil11l[IIIIII(0x1f2,'^M%%')]);break;default:!ilil11?I1lIl1[IIIIII(0x1c9,'&Iuj')](IIIIII(0x13a,'CD6W')+ii1iiI+'）'):(console[IIIIII(0x1a2,'SfMX')](IIIIII(0x157,'*2O2')+JSON[IIIIII(0x1ef,'CD6W')](llllI[IIIIII(0x187,'kMFk')])),I1lIl1[IIIIII(0x170,'Dajv')](lil11l[IIIIII(0x177,'q3G*')]));break;}break;case lil11l[IIIIII(0x1ae,']&]N')]:I1lIl1['fix'](i11il1);break;default:console[IIIIII(0x14b,'VspI')]('未知活动状态\x20'+JSON[IIIIII(0x115,'LOGe')](llllI[IIIIII(0x193,'6%I%')])),I1lIl1[IIIIII(0x11c,'rMj#')](lil11l[IIIIII(0x10d,'Ck6q')]);}}else{if(lil11l[IIIIII(0x19c,'^M%%')](lil11l['zMAGo'],lil11l['zMAGo']))console[IIIIII(0x1f5,'9)SJ')]('❓'+ii1ii1+'\x20'+JSON[IIIIII(0xf8,'dOyz')](llllI)),I1lIl1[IIIIII(0x15e,'VspI')]('未知奖品领取状态');else{I1iIli[IIIIII(0x18b,'kMFk')](lllil1['GPwFP']),lI1Ill[IIIIII(0x1b3,'Dajv')](lI1Ili['getInlineContent']());return;}}break;}}catch(Iliii1){console['log']('❌\x20未能正确处理\x20'+ii1ii1+'\x20请求响应\x20'+(Iliii1[IIIIII(0x1f8,'CD6W')]||Iliii1));}}async function iIII1i(iIiIi){const lillII=II1ii,iil1ll={'IfMvH':lil11l['zvUJi']};if(lil11l['eWBhy'](lil11l[lillII(0x180,'LDO5')],lil11l['aqUVp'])){if($[lillII(0x179,'YsC^')])return;let iiilil='',iil1li=null,lillIl=null,iIiIl=lil11l[lillII(0xe3,'57wv')],iiilii={};switch(iIiIi){case lil11l['hlYOE']:iiilil=lil11l['OPOem'],iiilii={'shopId':''[lillII(0x1b4,'k&#F')]($[lillII(0x118,'FgI(')]||''),'source':lil11l[lillII(0x197,'d6l*')],'displayWidth':lillII(0x108,'^M%%'),'sourceRpc':lil11l['bWQKa'],'lng':i1i1Ii,'lat':lI1liI,'venderId':''['concat']($['venderId']||'')},lillIl={'functionId':lil11l['hlYOE']},iil1li=common[lillII(0x1a4,'k&#F')](await common[lillII(0x1fe,'kMFk')](lil11l[lillII(0x1bc,'bIY2')],iiilii));break;case lil11l['NZMkf']:iiilil=lil11l[lillII(0x16e,'FWgq')],iiilii={'follow':0x0,'shopId':''[lillII(0x17c,'z^I^')]($['shopId']||''),'activityId':''[lillII(0x16b,'B(t(')](lil11l[lillII(0xe6,'z^I^')](iIII1l,'')),'sourceRpc':lil11l[lillII(0x1fc,')Z&B')],'venderId':''['concat']($[lillII(0x15c,']&]N')]||'')},lillIl={'functionId':lillII(0x14f,'X[B*')},iil1li=common['queryStringToObject'](await common[lillII(0x1fe,'kMFk')](lillII(0x1b6,'^M%%'),iiilii));break;default:console[lillII(0xe4,'*eAf')](lillII(0x1d0,'ORAP')+iIiIi);return;}const li1i1i={'url':iiilil,'method':iIiIl,'headers':{'Accept':lil11l['dYgoO'],'Accept-Encoding':lil11l[lillII(0x131,'URrO')],'Accept-Language':'zh-Hans-CN;q=1,\x20en-CN;q=0.9,\x20zh-Hant-CN;q=0.8','Connection':lil11l[lillII(0x120,'*9$9')],'Content-Type':lil11l[lillII(0x10f,'*9$9')],'Cookie':IiI1i,'J-E-H':iI11Ii,'J-E-C':lllii,'Sec-Fetch-Dest':lil11l[lillII(0xd9,'Ixs3')],'Sec-Fetch-Mode':lil11l['KvRis'],'Sec-Fetch-Site':lil11l[lillII(0x111,'bm6(')],'User-Agent':IlIIl,'x-referer-package':lil11l['knzEN'],'x-rp-client':lil11l[lillII(0x1bb,'Q4]Y')]},'params':lillIl,'data':iil1li,'timeout':0x7530};iIiIl===lillII(0xdf,'qAjK')&&(delete li1i1i['data'],delete li1i1i[lillII(0x12c,'YsC^')][lil11l[lillII(0x1fa,'57wv')]]);const IlIli1=0x1;let illIiI=0x0,lI1lli=null,Ill1l=![];while(illIiI<IlIli1){const llI1Il=await common[lillII(0x1a5,'k&#F')](li1i1i);if(!llI1Il[lillII(0x1b5,'Vs$D')]){if(lil11l[lillII(0x109,'B5XD')](lil11l['ZrVtu'],'IKqTD'))iI1lll['log']('❓'+l1lIll+'\x20'+I1l1II[lillII(0x149,'p7#5')](IIli1I)),I1i11I[lillII(0x1a8,'Vs$D')](lil11l['cbFaG']);else{lI1lli='🚫\x20'+iIiIi+'\x20请求失败\x20➜\x20'+llI1Il['error'],illIiI++;continue;}}if(!llI1Il[lillII(0x1cf,'qAjK')]){if(lil11l['FbKZe'](lillII(0x1d7,'Mo^b'),lil11l[lillII(0x12d,'D)5!')])){lI1lli=lillII(0x1ca,'URrO')+iIiIi+'\x20请求失败\x20➜\x20无响应数据',illIiI++;continue;}else{l1l1I1['fix'](lil11l['EPvST']),I1iIll[lillII(0x106,'*9$9')](I1lliI['getInlineContent']());return;}}lil11l['nMKvl'](iI11Il,iIiIi,llI1Il[lillII(0x18e,'*2O2')]),Ill1l=![];break;}lil11l[lillII(0x129,'Mo^b')](illIiI,IlIli1)&&(console[lillII(0x16a,'FgI(')](lI1lli),Ill1l&&($[lillII(0x1ed,'pe*e')]=!![]));}else I1llii[lillII(0x195,'B5XD')](iil1ll[lillII(0x18d,'6%I%')]);}}function Iii11l(){const ii1ilI=(function(){return[...[iｉl,'hywVjUXsHAjpiXaBNGmCiDW.cPoYmG.vtD7HDTLC==','t8kjqXDDW5hcPSo3fwi','W40GBeHF','W7pdU2hdICocW7O','W5GpiSo4lq','5O+y56w657UW5PY9ECo+WOJdISovFSocW7BdG8oj','bSkwxKVcQW','5BM76zg95zkp56Eb7724WOm','W7ldUN3dPCocW7LQDMe','WPRcNmoQwSkzya3dMwFcTLdcQW','CtRcKcX1dxdcVCktW4ZdNmkHn14udSov','qSkxW7xdQgxcTW','W7DsWODHW70','imkykqZcKmkhWRdcQrldRJlcKCosW4PnW4Grz1CZl8orwYqdW4RdTaqXWO/cOXhdKmo2','WRLxrW','W6m2CW','W5BcKSoxW4n/mSkZhCoXvSkUWRK','rSkEW7pdRa','mhJdQmkKW7S','W6mfFura','WQvJWQm','4PMaAoISTowgLUwSJos7HEw9UoIKPUEAM+EoVUwIQEwoNEMfLEwsL+whHUI9O+IJLEIfJEAEKG','BYvxlYhcSmogWPBcJYy','W40XW6xdUstdLCkNWP/cL8ouW700WO3cJmk2aCoYWQ/dJv5bW6RdUCkksSo45PU85zcZ6ycZ55+KWQ/cUSotBMldThLsW6avWPCr77YB6BI/6k2n5lQZ5OYJ6yg0','WROOWRGFW4K','AmoIFdHE','4PMge+IfO+wSS+s6U+I8LEIINEMwQ+MyJ+AxSEMxH+ISQEE+M+MxN+ISSG','hCkUEuC','wxhdRCk1gW','CJpcJs9zpa','WO/dQmoSuGpdLa','WOGTWQlcUSoZW77dJG','W6tcLmk7z3y','EYHmeG3cPW','fJTsW5XKWOxcQCoXWOlcVG','WOfazHLsaW','cmoAEsJdVq','qfBcJq','m8oGxZxdQG','WOPdutb+','5yYi5ysW5BMl6zks5AAG6lsx','8y2hNE+7IW','W4RcS8kiw1DEW7jiomocxtiBW4GuW5OWz8ozdSo2Esm','W6ZcJmk+W7JdKW','FrFcQmkobW','5yYU5lQj5RA55yQz5OMY5yI/5l2T5P+H6AcW5y2v5yM15Asm5zkk776s','4PIZwoIgH+wUQ+s6NEI+S+IJM+MxL+MzRUAvK+MwI+ITV+E9JoMuIoIVVa','WPlcGCoS','jI4QE8kJWQjlW5BcL8opESkPfmoWtCkg','W5JdPs41fG','ufvtwmkcWQClWPpdGdDgW5SJAuFcHq','gJ5JW5zR','4PIlqUIVS+wHGEwgTUAGUEw/QoAUMoEINEEzU+EoJowHMEwnSEMgMq','csftW4hdMCkbW57dPmo4WRZcUgjQ','amopWQVcRb/dQSotySkqW6Ksxbq','W7/cO8k9W6tdRNtdJmkUcmoFW4Pue8oy','W6m1oCoakG','e8oDW48+xCkX','W6CizWy5','w19a','W49bWP7cHbNcOxKcWOK','WObFW6BdHSka','WOxdQ34','WOtdS8o2qrhcMGtdPa','WRtdNSoy','gfVdLNVcUa','WRFcUmo6hmkWFmkgW5ZdQ8oaxJi','WPCPWQRcQSocW6xdKmoc','uSoxEHjA','WO3dJx5Qlq','svFcNa','a8ouW5qTFa','4P6foUAEPoIcREAUOUEGTowKToEtKSoJ','WQZdSSo6WPhcUsRcNCkJpSoMW45tfW','5P6P55Yj5AEY5zc56AoR5y2M54ID5Ok8aq','g8kTfJBcIW','urFcV8kQeG','WOP8W5W8WQW','W6VdKdycjZ0lla','u13cLCoGCtOxha','qL3cJ8onEIq3fL0kb8kXWRmsW7NdMq','WO/dRwe','WR3dQmoAwqG','fmkQygVcH8kZWQC2WOziWPdcSmoRqIVdTW','W6tdOhK','q3H9rSkL','r8kAW7tdVeNcOCkSqq','q1FcL8oOEZ87ha','yYtcIf3cUq','WRT1W7y0WO4','W5ijbSoIeG','W7hcQmkQW4tdThFdGmkZ','W77dMJWd','xCkqW70','m3VdU1pcGmk5','WQRcGM1sCN93pSkQW7NcLWldRq','WRNcRSoed8krDCkEW7/dHmogsahcTSojW7ZcNxyuD2ldOCow','pmkFw0FcHa','mgddIa','zZlcMG','W40XW6xdUstdLCkNWP/cL8ouW700WO3cJmk2aCo9WRldNKe'],...(function(){return[...['5y+K5ywG5BI06zck5AwY6lsS','W6CWW4C','bdLlW5a/WOpcR8oHWQZcS8oS','vh0Ek1KwqYS','5BUG6zkI5zYw5z+177YiWOtcQCo8WRVcQCk4nSovWPlcHmoaqmoagmkjz291WQquW7eSW5DqtIJcL8khWRTe','WP3cJmontmkn','d8kqsHvwW4pcH8owhI8','WPi9WQ3cM8o4W6G','W6KWBa','WQf9BXbW','fdDiW5zZWPG','v33dLq','D+obMow5JoMrKEwFG+wFSoobL2nEWQftoZaRW7a9WP7dNXZdI8kHWO0gzWxcUL8vWPaQWQhdRw4bueBcUq','gSk8r1FcISk8WQSRWPa','Eq/cTmkfgG','W6uxjmofpG','xNBdJCkxn2e','WP7dPSoSvq3dJq','WQ7dLmorW7xcRMWMW4q','w8kdxa5EW5i','WQv1W6K','WPbkEWPxea','WOGKWPRcKCot','cSoKW4ySta','WPPsnbO','WOrgCa','W6CTW47cNYvgW4C','WOb8W4mMWOK','W6FcJCoqWPK','uvLF','uvZcMSopBa','WPzDFrO','WO9zW587WRK','WRT/W70LWQ0U','W5TqWPJcPZlcHq','WRiSWRS','W6uDa1xcSrhdNKC','qSkSrt1/','vh/dJmkFmq','pmkSx0xcMa','WQ5/W7OzWQ82wCk6WQBdQSo+oxJcMCoatW','mwKwWOuIW5W','zfL3qCkH','W77cR8kX','4PI9WPxORQ/LHk7LR5JKUiBLVOFOP4NNMBtNJl3LOAtLJOVPHyZLKQhLHQBOVP7OOldOHRhMNAu','WR7cRSo8dCk6','jmoyW7KyrW','WRGQWQq','W4j3WO8','W6qUzX4O','v8onvcfbjmo2WPhdI8okv8k6b8oybfJdSmosvW','vmoDqczDbmo2','imotrsRdVq','W7eCW57dUY8','WR7dMmoh','tSoDudDDbCoX','W6BdQ3VdHSoPW5y','W5O7W6pcHay','W61zW798W5q','5RsE5yQq5lU25A+C5zY85OME5BAS6Ao+6l+/','u1/cNmoStG','W4L2WQBcUb4','W6RcICoxW5VcRf8IW6G','ahNdU8keW6K','w33dKmkvmx0','BttcHq','rCoxxZbzaW','WQVdHmoCW7lcRM0C','u0jgzSk/WQmnWO3dOH1pW4e','WOvCW6tcH8obW7pdOt3dRN7cLSo9WPhcQ8kYWQBdTYTU','bCodW7y7DW','xSkhrG9MW4/cMmo6','WOfEW4ivWOu','WRJdPCkUWQSu','cmozW7Kbuq','W7RdUtaTla','5BIo6zoP5lQf5A205z6U','phVdSG','W7ijauFcTW','owhdMq','dtmDo04qqsxdJ8oM','WPyOWOSpW6K','e8ofxqtdNmoA','q0nYqCka','WQxdU8o0WPxcVc7cMmo9zSkw','zg40oMm','hIFcTCoiWQFdKtvG','WObAW7e','8kg4Ga4','uCozwcDShSoVWOy','WQtcQ8oYh8k3FCkeW4K','W4O0W4O','5y6R6ysa6k+G5PISW5tdOSoZzCoEnSocW6pcOHO','jsOQuW','4PYeW4ZMNBFNNPNORjtMS7/cVW','WOFdJmkYWRGh','W5P8W6zyW6nJAcjNWO8roa','u0ldICkFdq','WPDUB8kNWPddGa','WQNdMSojW53cVa','W7NdH0hdPCov','FutdJSkIca'],...(function(){return['o2/dK8k0','baCQw8kP','vv3cNmoIua','qxq7oMK','WRvSWODKWORcSsiKWPeH','fYZcHmopWOhdKtfyqSk6uW9JySkReCkyW58yWOZcQSoA','WRldPSkcWRaU','5lUe56YQ5zom5BU56zgp6k2i5A+j5y6R5lQS5lMc572i','CCovcWRcPCoSW5tdPa','WObNWQyAW48','44kv5O6p56sX44g56k685ysl6iYH5y+fsg7cKCkiwJi','W4JcU8kmFey','W6XQWQTaW5u','WPRdGSomyW8','WOtdJ0HHfW','5yYr5lUe5RAG5yUd5OUZ5yQl5l6V5P6g6AcQ5y2/5yIi5Asq5zcE776N','sqJcNfNcLG','W5ewW6We','mxL1falcKSo+WPu','WPRdThvhda','cmoWW7OyuG','W7ldGcWGlI4L','WOxdH8kuWROJBmkcfCoxECkyWQfDDx8V','WP/dS8oWwaZdH0lcRCop','BILB','WRS7WRuC','tuvGrmkO','WQrTWQeDW7a','W6P7W6DCW49P','t3mq','aYlcL8oE','cf/dS8o8sCkyWQ/cNSk9lG','WOhdOSoXqGpdH04','WPtdH8koWPCOCSkIhW','W5aeW57cOs4','hSorgK8cWPBdGmoPihLHWQ0o','W4SVjNVcVW','WQFdPmkHWPa8','WOvkFcXsaWS','WQZcJwTrb8k+W7q2EwD3dCot','yJtcJcT1nNy','WPrLWPq','lIhcI8o7WR4','W4yequLw','4PM4WPhOHzxLRiVKUOlOV47OOkpPLztPMAZMLiJPLiVORQlNVkhPLl3ORy4','WQxcMSobWPyjW5xdMCo0rri','WPbZyCkrWOO','WR/dLmolW5lcPheeW4NcNCkOfxa6qq','WO7dJCkh','W67cO8kNW4ZdPghdRmkK','WOhdJCkeWPy','W4WZW7VdLbK','bG4k','ow3dO3FcQW','W4PqWOlcIrlcTfKa','5P6h55YZ5REh5yQG54Qj5OcW','W6e7W6xcHbW','zc9e','WPRdRhzEmx0','ocjFW7LE','6i+N5y+c5RAU5yQy5lYa5OkI5AA56lsl','BYvxkYRcR8oCWPNcJqdcKmkLWORcKv8t','W6ZdQW03DG','W6BdQ2hdMCoT','W73dPCoUh8kkEmkAWOpdVSomwIpcS8oCW5FcQfW4BgBdQSoaW70','8l6FGo+4Ha','a8ohW7ldKKVcKSkOBq','jmkdoJNcKCop','w8kUW7ZdUNq','4P6foUIgLoADVoI8KEIGLUMbT+wlPos5HEMwSoITVL0','6lsH5y6L5PsX5Pw6','4PQrW5/ORA3LO7pLHRxMO6/LV6RMRyBNOOtNMi7NJ6/LOQFLJPtPHOW','W4qNW5/dVcldKq','W6S9W6a0WPhcLHe+WPydhCk+CrFdVvlcLmkqWQddUHxcHHFcV050W5mh6iE95A+V5lIw6l+k6kc+6zAc6zQQ5PA06zA277Yx6BQI6k6BnCo9khG','WOJcU8oTz8k/','W7n3W5DiW7rSA1XBWPKrgSoqWRFcHmknWOeEdW5Obmo1W7NcMgTx5O2K5yQo5BUx5y2857MM56Qc5PEd772a6BIH6k+PW6S','ccmYECkV','W5qHW4JdTdJdK8k5WQRcHG','ptfiW7Xh','WP/dR8oTqt3dGvVcU8oPW6SQnY7dHrdcISolA8oVWOK','W4b+WODdW70','WQ0RWRmyW5Hw','W7ikoSoEet8','xh4mWPa','bt1vW4b+WPG','Fmk6W4ddL0e','4PU1lUITIEwIUUweGEAHG+w9GUAUIEEGNUEBGEEoJEwGQUwpLUMeGG','WOVORPxMSyBLK6FLURSL','WOZcO8oGymkP','rXFcOmkegSob','WQ3dGCoBW7dcV3SSW4/cLSkkexi7','W4CnyW','W70TWRTLW7HRbCk3WRldPSoPmeG','bGiwkCocW7TsW43cLuqz','WQONWR0JW6K','WPOOW58/WQ7dTqJdQmombwmT','W6e7W7/cMcy','W5vBWO/cGqlcONux','W5iyW7qAWOS'];}())];}())];}());Iii11l=function(){return ii1ilI;};return Iii11l();};var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
