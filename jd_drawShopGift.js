/*
活动名称：店铺关注有礼
活动链接：店铺首页关注按钮
环境变量：jd_drawShopGift_argv // 活动参数，支持两种格式：”<shopId(店铺id)>_<venderId(店主id)>“ 或 ”<活动店铺首页链接>“
        jd_drawShopGift_threads // 控制并发线程数（正整数），默认1，最大5
        jd_drawShopGift_interval // 自定义运行间隔时长（整数，单位毫秒），默认1000
        jd_drawShopGift_notify // 是否推送通知（true/false），默认不推送

⚠ 请勿滥用自动化工具解析的店铺链接作为变量使用本脚本！请确认活动有效性后再使用！
⚠ 因自动化程序滥用严重导致官方接口受影响，现在必须同时提供店铺和店主id才可运行！

高并发脚本，黑号领不到奖品
活动限制IP严重，建议使用代理，谨慎使用并发

cron:1 1 1 1 *

*/

const $ = new Env('店铺关注有礼')
var iｉl='jsjiami.com.v7';const i11ii1=iii1II;(function(lllI1I,lillI1,IlIlii,i1l1i1,liil11,iiillI,l1l111){return lllI1I=lllI1I>>0x6,iiillI='hs',l1l111='hs',function(l1iIII,llI1I1,IlIlil,lIli1I,II1il){const liil1I=iii1II;lIli1I='tfi',iiillI=lIli1I+iiillI,II1il='up',l1l111+=II1il,iiillI=IlIlil(iiillI),l1l111=IlIlil(l1l111),IlIlil=0x0;const lllI11=l1iIII();while(!![]&&--i1l1i1+llI1I1){try{lIli1I=parseInt(liil1I(0x1fc,'66MK'))/0x1+parseInt(liil1I(0x17d,'F$X#'))/0x2+-parseInt(liil1I(0x223,')i8k'))/0x3*(-parseInt(liil1I(0x1ad,'PREw'))/0x4)+-parseInt(liil1I(0x1de,'[rOU'))/0x5*(-parseInt(liil1I(0x197,'8cZK'))/0x6)+parseInt(liil1I(0x1ff,'7uJi'))/0x7+parseInt(liil1I(0x1fe,'8cZK'))/0x8+-parseInt(liil1I(0x1d9,'oeQ*'))/0x9;}catch(I1lIll){lIli1I=IlIlil;}finally{II1il=lllI11[iiillI]();if(lllI1I<=i1l1i1)IlIlil?liil11?lIli1I=II1il:liil11=II1il:IlIlil=II1il;else{if(IlIlil==liil11['replace'](/[POTHbtxCgBMKEAqReX=]/g,'')){if(lIli1I===llI1I1){lllI11['un'+iiillI](II1il);break;}lllI11[l1l111](II1il);}}}}}(IlIlii,lillI1,function(I1lIli,II1ii,IIIIII,lillII,ii1ilI,lI1ll1,iIiI1){return II1ii='\x73\x70\x6c\x69\x74',I1lIli=arguments[0x0],I1lIli=I1lIli[II1ii](''),IIIIII='\x72\x65\x76\x65\x72\x73\x65',I1lIli=I1lIli[IIIIII]('\x76'),lillII='\x6a\x6f\x69\x6e',(0x16171b,I1lIli[lillII](''));});}(0x3200,0xdbc9c,Iii11l,0xca),Iii11l)&&(iｉl=Iii11l);const jdCookie=require(i11ii1(0x20c,'VJ6!')),common=require(i11ii1(0x271,'Ag7B')),notify=require('./utils/Rebels_sendJDNotify');function iii1II(_0x4c61c6,_0xfa49e1){const _0x5f0a65=Iii11l();return iii1II=function(_0x10b195,_0x4d8d0c){_0x10b195=_0x10b195-0x15a;let _0x2b48ca=_0x5f0a65[_0x10b195];if(iii1II['qugjnL']===undefined){var _0x146113=function(_0x468a64){const _0x3908da='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4a0ddd='',_0x287fe3='';for(let _0x5d7a3e=0x0,_0x2d2625,_0x6fd869,_0x3db6d2=0x0;_0x6fd869=_0x468a64['charAt'](_0x3db6d2++);~_0x6fd869&&(_0x2d2625=_0x5d7a3e%0x4?_0x2d2625*0x40+_0x6fd869:_0x6fd869,_0x5d7a3e++%0x4)?_0x4a0ddd+=String['fromCharCode'](0xff&_0x2d2625>>(-0x2*_0x5d7a3e&0x6)):0x0){_0x6fd869=_0x3908da['indexOf'](_0x6fd869);}for(let _0x29b055=0x0,_0x2cc407=_0x4a0ddd['length'];_0x29b055<_0x2cc407;_0x29b055++){_0x287fe3+='%'+('00'+_0x4a0ddd['charCodeAt'](_0x29b055)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x287fe3);};const _0x43391d=function(_0x1ef735,_0x50a471){let _0x450159=[],_0x46b0cf=0x0,_0x437d1e,_0x555e5c='';_0x1ef735=_0x146113(_0x1ef735);let _0xc4791e;for(_0xc4791e=0x0;_0xc4791e<0x100;_0xc4791e++){_0x450159[_0xc4791e]=_0xc4791e;}for(_0xc4791e=0x0;_0xc4791e<0x100;_0xc4791e++){_0x46b0cf=(_0x46b0cf+_0x450159[_0xc4791e]+_0x50a471['charCodeAt'](_0xc4791e%_0x50a471['length']))%0x100,_0x437d1e=_0x450159[_0xc4791e],_0x450159[_0xc4791e]=_0x450159[_0x46b0cf],_0x450159[_0x46b0cf]=_0x437d1e;}_0xc4791e=0x0,_0x46b0cf=0x0;for(let _0x25e137=0x0;_0x25e137<_0x1ef735['length'];_0x25e137++){_0xc4791e=(_0xc4791e+0x1)%0x100,_0x46b0cf=(_0x46b0cf+_0x450159[_0xc4791e])%0x100,_0x437d1e=_0x450159[_0xc4791e],_0x450159[_0xc4791e]=_0x450159[_0x46b0cf],_0x450159[_0x46b0cf]=_0x437d1e,_0x555e5c+=String['fromCharCode'](_0x1ef735['charCodeAt'](_0x25e137)^_0x450159[(_0x450159[_0xc4791e]+_0x450159[_0x46b0cf])%0x100]);}return _0x555e5c;};iii1II['ZOhTID']=_0x43391d,_0x4c61c6=arguments,iii1II['qugjnL']=!![];}const _0x2691c3=_0x5f0a65[0x0],_0x47034e=_0x10b195+_0x2691c3,_0x39df49=_0x4c61c6[_0x47034e];return!_0x39df49?(iii1II['cTNmVJ']===undefined&&(iii1II['cTNmVJ']=!![]),_0x2b48ca=iii1II['ZOhTID'](_0x2b48ca,_0x4d8d0c),_0x4c61c6[_0x47034e]=_0x2b48ca):_0x2b48ca=_0x39df49,_0x2b48ca;},iii1II(_0x4c61c6,_0xfa49e1);}function Iii11l(){const I1lIlI=(function(){return[iｉl,'eKjKstOBjigtamPbiTXM.EAcBBKoxTRmq.AHvXC7==','wriNW4pcSG','mH3dQLJdLmkB','W5BdHwqkyXG','W6ZcTNldLf4HW6/cJ8oaq8k/W5VdL8kQWPyTpmkCWPFcRI/cV8k7W77dLSoHW7qfpfVcOCk8Bw4sWRWYrdONW4zzWOddGqi','WQiyW69EiudcP8owAuK','vtuLW6BcSW','WPWzbviz','W7ldI8ocW7ZcIG','W47dH0dcT8kz','5P2s556B5Rsv5yMv54Ie5Oc+','4PI5WRhOH6FLRyhKUPROVBVOOktPLlZPMOZMLzlPLRlORA/NV6hPLPBORzi','pSoQW6pcJW43W7q','WRmMzSkGfq','W6LKWQPvW6ldNti','rmohW6GyWQu','qwFdKCoMW6BcR8ommaa','nH3dT0NdNCkDnCk+','WQyuW6nuleNdQ8kKeGf5W7W','44k95OYu56Ev44ko6kYT5ys16i+T5y6AWQpcPmkizZpcNG','iSo8WPXsESosWPRdQHBdNmkU','rmkeWRfDhYdcGvG','qMldQ8oSbSoPcq','v8oxgCkGpCkHEu8','tcm7W4JcK8oBW5lcQIFcQG','C0JcTW','W4ldMxi','lmoIsa0KW5ddJSoXWR5tu8orgIGGjMXid0ZdIL4','ymkbW4mJ','lCo4W4eyWOO','sgldTSokjG','W7LjWR0mBG','gXfdW5pcGqNdSHvtlCoDW4RdQxXQW6/dR8oRFa','W6VcQmkRlmo/nCkuebtdO8oUW7S','BCkwya','yCk5W4TSWOFdJW','g8oIW7FcJI4','WOJdMSk0W7RdVmkTA8o7rMG5W5e','gxefW4rAvq','nSovWObbsG','W7lcVYVdVq','qmotj8oicq','W7/cO8kzlxq','tc9EWPOhcGaivCkvW5bOW6m','4PITzUISJUwfLUwULUs5N+w/I+IMRUEALEEnUowHSUwoGUMeKowrQ+wfIEI/RoIIPEIhKEAFPG','W6eJWPD5Eh4','bYlcISktWRJdUW','cuTAWOWH','dWVdMMFdLW','W4/cG8kje39pW6BdTCkPW7hcPCovwSoCW40T','pZT6','WPqDmNm7WO9tzsJcQv3dQSodsvKe','WRJdK8kBzq','WQ8iCmkRDwbvFXK','r8otb8kyka','cWVdK2ZdOa','5lQL56+a5zo15BUn6zoR6k6D5AYv5y2z5lUc5lIi572U','z8kiW6i','W4qrAN0pfdldGq','omk/W5S/WOq','W4X0WP4fvG','8j+5VCkf','WQBdLL7dTCo1FurpWPFcRdVcMXlcTW','WQVdImk2zMRcUW','WQiqECkZea','qCk9CMNcIG','W5tdVhJcVSkw','DKNcRbxcJmoxtmkjWR7dKG5KWPi','WPFdPCoOW5xdVSo+rSoUW6v3W7DPW7pdGa','C8kYW6CuWOW','zSoPW5iKWOG','WPWhcKiLWR0iWRr0omk2tW','xIGGW5hcUSotW5BcOZhcPG3cMXSuWOLPmeBcVNe','W4tcICkA','k+ISIoAXMUwKTEI3VfZINPuz','BCkoW70','wCoeW5WAWQ3dGrG','qmk+qKdcQG','lhy/W6Ld','WRFdK8ko','W6ePWP4','uSota8kHbCk8','lmoIsa0KW5ddJSoXWR5tu8orgIGGjLzpcuddJunPCgJdVqBMJPtLIlRLUidLJQNNURxNQOZML5/VV4pPUApORjum','5P6l55+c5Rwo5yQI54I+5OcZ','W5VcKSkpm39eW6BdVCk1','W4JdN20kFW4','W4ybqwKot2RcVvFcMCodWPeOW7/cIqpcUXCDWPy','W6xcVSkvp8oEpmkmmZVdPCo4W4HxC8o0WQFdO380wmoeW5NdUNldVSkB5PMT5zg06ycZ5567ecmjWQGKWQVcUSkWWOimFcVVVlhPUk7OR6VKUkRMJ5FPGOW','W58bs0mB','W4rFEdvA','DrquWPVcNCkP','h1FcUCknWOW','n1ybW4T5','FW8dW4FcJq','zWFcTSkL','DSoSWPaeWQK+tgi','n05kW5pdUSo9W7rPmCkHW6K','WQZcOtJdQSoJWPiXWPXxW6BcHmke','WQ8jCmkrmZO','WPKgcuKPWRzEWQv3jCk6yCom','WOBcOd9qW6ldVqddO8oIW5xdULW'].concat((function(){return['5RAI5yI55lIa5A6d5z+75OQ95BAA6Ago6l+F','mw5oWOK2W47dVKqE','nMqHW6rQ','WPNdJSkOv0i','hHfcWPhdNuJcPXm','WPddL8k+W7RcK8kTDmo3Ewm','DWdcVCkWFSoK','W5FdMgu/rbG','W7fEaeldKG','W7/dUghcR8k2W5K','W5dcT8knhge','W5ldOw/cN8kI','kKFcUmkKDmoVd8kfeCob','vSkCWQ4ajsW','W5pcT8kWWPxcNmkMe8k6','W7hcP8ksWQJcSG','f3yyW7TL','W5NdMf0DWRC','gxefW5zwxeq','W6RdUNJcO8kJ','4PUXWPdORidLHyxLRPhKU47LVOlOPPNNM5BNJztLO7pLJ7RPH6/LKOlLHRxOV4/OOA3OHjFMNy8','BmoyW5uoWPO','i8oOyq','W4rvb2xdUG','h3mBW5zk','WPWAsdFcTq/cIdhdISog','W4JcUCk+','aCkXW6O','ASoTWQeeWR4TCLvfaSkYymoIxCoEWONcTSoHWOtcUSkWqdCQiCotWOXb6iA85A215lIs6lYW6kcm6zAW6zQh5PEs6zww772H6BMx6k2hjCkWW50p','ECkcW7qSWRPPFa','W5VcTdNcOmkZ','WRnhWRq','6lE95y2l5Psj5PwE','fNem','aColW4iD','pCkZyxFcLtvL','W4jzwa','WPBdMeS','W6tcUYZdQvm7','amk1W7e','5y+c5lQh5REf5yUi5OUC5yUt5l2d5PYS6AkR5y675yUY5AwX5zgk77YZ','DmoDoSoyfmkWWOWt','eL7cL0G','WRldKSkAC3hcOq','EmkkE2FcVa96','W77dMxKJxq','W5NdShO','tZGvWR/cRG','5y6q5yE15BQa6zkt5AwN6lAu','phpcHSkd','z8kIW49oWRi','F8k3jL5MWOxdImoTWPbjASoo','r8ooW58','WQpdJ8kErwC','vSkKWQGdiG','dHTaWPNdL03cIXm','WP3dMSkqt2a','4P+HW6tMN4xOGAlMRRNNOjpLPz7NKyRdGa','gCogW5qEWPnK','oCoEWRbQW6OImhBdSfpdNmoToa','wwldTSo7aSo8jCoM','ktndWQ3dQa','W57cSmkDW7BcTbOZkSkz','iCoJyYu5W5BdKmomWOviqSoIbJ0','WR7JGOhLUP3PKPpLK5VNPl7JGB/cUG','8kkjP8kl','v8krWRifadW','W5RcQ8kbeSow','W41ieG','sCo0jCk5bq','6i+D5y245RAa5yUg5lY75OgV5AAk6lEH','W63dGmoW','W4ZdVKedza','p3lcH8kcWQGdW5NcPYG','cSkzwG','hmkBW7lcQmk2','hGzsWO5wbW','n8oFWPTQra','edNcKG','W73cVCkAW5FcGa','tCkeW4r4WPu','WOrwpsxcUdOUxCoeW5FdKatcMa','dSkXW6NcVa','W6W3WRHtEW','kM8tW7Hr','cSkZW64','WOJdHSkPW6pdKmkRCCo4DG','cw4hW4Th','WP4rka','sYK3','W6qOWPPYExjRxa','W6uRvhG0','cXzbWO3dU1S','W7RdLxazWPO','W5JdVM0','qSo2W6e/WOO','yrKpWRJcVmkIWRqrBSo8WRW1kW3dUIJdQSkYmmo8WPrzsq','6iYe5y6W5RsW5yQ/5l2H5OgT5AsN6lst','r8omgCkKrCoOCe8ylCkuW4ddOmo7hw97','BCkiW6K1WRbTw1FdIwS','W6XnWR0tuHZdT8ko','hMLiWQSs'].concat((function(){return['4P+dW7ROH5dMNBFOVBZOOjhPGRZLIzdKU5xPLPpORAFcHq','smoNW6i4WOy','W69xWRSzEsNdO8kBmq','W6ZcTCkKomonkq','W64LWRDtzq','cGPz','WQOiza','WOOwASkfjG','W4/dS2/cSmkB','W51EuaTyW6O','W7NcV8kKp8ojl8kYba','lmo5W5b7WO/dLWddTmkvvSk6wSkGDmkuW5dcI8o5kSkwt8oFWPq','cu/cNKXkWQn9CcrsWPquWP4','AaFcTq','gmorWPnyoa','WPddOehdJmoo','i8o8WP9tomoq','5P6h55YH5REu5yI354MS5Og8','o0VcMSkXWRC','W7FdIe4mWQi','BGFcU8kU','j8ovWPLPBSo1dNW','WQOsvCk4iG','WOJdGKldK8oiBa','jhdcN2Hx','fvv3WPuF','jCk9W5pcGmkC','rmoNWRe3WQe','nSovWOnezCoRlNy3WRGFtftdQvzR','s8keWPCPpW','W54qCeGssG','W5vpphRdMG','WRJdK8khDvFcTmkQeG','pSo3W6euWPq','wmkUvglcKW','W6JdPgJcQCkQW7GCWRPXW4RcQSkfW6ddGmoFW6JcTfhdHa','z8kqFW','krBdUKhdJCklgCkP','bCoPEr0ZW5/dJCkpWOjfu8oZ','W6lcHaBcTq','WPhdK1JdP8of','W7zNWOCoCa','FcVcNCkkDa','WQtdLv/dSq','hCoNWOLcia','W5Htur90W7WVWQO','W7FcPalcOmki','WRpdImkDzNddR8o2vKKTW4zEWRZdGNTcWPXtWPldLrhcV2rZfmkwgCo1BYD4WQZcQmkr','oCoSW7iiWRS','W5pcT8kWWPu','W4BdRmozW6RcQa','EmkxD3tcKbG','n8o0WOK','W77dN0ilWP8','DWKEWPNcRCkEWRaRAmo/WR4GjZBdSttdPSkLpq','zCkZW5fCWO/dNb0','smooW5yUWQpdHW','u8osjCkAdG','imoVBW','W6hcP8k8eva','W7nOowZdOa','eCkTW5/cUW','W4LtsZH+W6enWQDlcCkJv8o6WPC','ybud','qSkrWRu5aItcH0BcTZi5fSoivguQ','W6q0C04y','zCkgW6G8','tCobWPqjWOy','W7nkWRu','wmoQWQq','xLOuW4GpsYBcP1VdImoRsCoI','W7VcRtG','k3LiWRiY','gNtcT2z2','ASkLW6fAWOS','kmkdW58KWPG','nedcGSk9WQK','ymk8sKVcKa','oW9DWOZdQG','W67dSgtcR8khW4ifWQ0','W53cRXFcLSko','lq9LWRtdIa','W6hcVZBdQgSMW7hdHW','WRacBCkqjdWSnq','8ygSQo+4OW','W7VdOgpcR8kj','CCkvW7mjWR4','WOHTWRDrW4S','W4akEq','jmoUW6ZcJWqO','W6xcRSkxm1S','udScWORcMa','z+odJUw4MUMqO+wFTowCM+oaQmoDbCkVWQpdU8o0W5JdMq3cOSknW7m/ka7dP8ofWOuqWPb2WQZdOwldNmoEWPRcQmotzG','W4RcT8k0WOq','WR3dLCkr','5y+u5yAL5BIY6zo15AEx6lAE','WPHLvrjqW6WK','sCooW5CHWQFdKHi','W6KPWPD7','W5GOWQ1uwG','eaNdOxFdMG'];}()));}()));}());Iii11l=function(){return I1lIlI;};return Iii11l();};console['log'](''),console[i11ii1(0x234,'s7Er')](i11ii1(0x219,'F2(R')+$['name']+'变量说明=========='),console[i11ii1(0x234,'s7Er')]('jd_drawShopGift_argv\x20//\x20活动参数'),console[i11ii1(0x227,'t8B$')](i11ii1(0x1ed,'HEWL')),console[i11ii1(0x25e,'7uJi')](i11ii1(0x21c,'enxl')),console['log'](i11ii1(0x1f2,'Z[Sk')),console['log'](i11ii1(0x1a0,'PREw')+$[i11ii1(0x22a,'Nufz')]+'提示结束=========='),console[i11ii1(0x225,'qnAu')]('');const activityArgv=process['env'][i11ii1(0x1f1,'N[%!')]||'';let taskThreads=process['env']['jd_drawShopGift_threads']||'1';const runInterval=process['env']['jd_drawShopGift_interval']||i11ii1(0x162,'oeQ*'),isNotify=(process[i11ii1(0x24e,'j&7^')]['jd_drawShopGift_notify']||process[i11ii1(0x216,'HEWL')][i11ii1(0x1b6,'HEWL')])==='true',cookiesArr=Object[i11ii1(0x222,'$y[C')](jdCookie)[i11ii1(0x22e,'7uJi')](II1llI=>jdCookie[II1llI])[i11ii1(0x209,'66MK')](i11I11=>i11I11);!cookiesArr[0x0]&&($[i11ii1(0x17e,'NGpY')]($[i11ii1(0x179,'R20N')],i11ii1(0x1ae,')ZZH')),process['exit'](0x1));!(async()=>{const IlIliI=i11ii1,l1llIl={'jiGNK':function(ii1I1l){return ii1I1l();},'ILboo':function(ii1I1i,llI){return ii1I1i!==llI;},'efkgI':'iQrDx'};notify[IlIliI(0x1c1,'fZMK')]({'title':$[IlIliI(0x194,'XZf$')]}),await l1llIl[IlIliI(0x1f4,'8cZK')](Main),isNotify&&notify['getMessage']()&&(l1llIl[IlIliI(0x274,'!*&A')](l1llIl['efkgI'],l1llIl['efkgI'])?li1Il=li1Ii:await notify[IlIliI(0x231,'PS9P')]());})()['catch'](iI1li1=>$[i11ii1(0x1f0,'e0fq')](iI1li1))['finally'](()=>$[i11ii1(0x199,'I5@4')]());async function Main(){const l1iII1=i11ii1,lllii1={'DnOWm':'⚠\x20请提供完整信息后再运行脚本','PqxZb':'⚠\x20请填写格式正确的环境变量','kcaCP':'账号无效','XOeEi':'店铺不存在或获取店铺信息失败','Bkstx':l1iII1(0x246,'$y[C'),'kdtqc':'hNKLi','JgJkd':l1iII1(0x214,'u6Y8'),'MmueE':function(liIli,liIll){return liIli!==liIll;},'IAAKA':'aqAMw','wMoZq':l1iII1(0x1d5,'N[%!'),'iWYrH':function(IilIi1,iI1liI){return IilIi1||iI1liI;},'npVYS':function(l1lIiI,llliiI){return l1lIiI===llliiI;},'sPisN':l1iII1(0x20b,'66MK'),'FtUWG':function(IilIiI,i1i1I1){return IilIiI<i1i1I1;},'RqiYV':'ImQHC','DBojn':l1iII1(0x285,'F2(R'),'elfOa':function(IlII1,IiI11){return IlII1&&IiI11;},'mhsYV':function(lli,liIlI){return lli(liIlI);},'CqsqX':l1iII1(0x16c,'7uJi'),'SBIfa':'mrloA','ROLfh':function(lll,llli1){return lll===llli1;},'iBUml':l1iII1(0x21e,'oeQ*'),'WVMlJ':function(iIli1i,iI1lii){return iIli1i+iI1lii;},'nRDcn':function(IilIii,iI1lil){return IilIii(iI1lil);},'xswSd':function(l1lIi1,iIli1l){return l1lIi1>iIli1l;},'HJxWM':l1iII1(0x1a2,'zh5j'),'xUbMS':'eIglN','INJuH':l1iII1(0x1a6,'66MK')};try{if(!activityArgv){if(lllii1[l1iII1(0x15f,'qnAu')]!==l1iII1(0x248,'e0fq'))i1ll[l1iII1(0x1f5,'1!U*')]=i1l1lI[0x0],i1iliI[l1iII1(0x23c,'o]XU')]=I1iIii[0x1];else{console[l1iII1(0x244,'F2(R')](lllii1['JgJkd']);return;}}try{if(lllii1['MmueE'](l1iII1(0x253,'I5@4'),lllii1[l1iII1(0x172,'Xeu8')])){iIIII1[l1iII1(0x234,'s7Er')](lllii1[l1iII1(0x281,'enxl')]);return;}else{if(activityArgv[l1iII1(0x15c,'[rOU')](lllii1[l1iII1(0x278,'PS9P')])){const {shopId:IlIllI,venderId:il1i1I,vendorId:lI1li1}=common['parseUrlParameter'](activityArgv);$[l1iII1(0x206,'VJ6!')]=IlIllI,$[l1iII1(0x229,'h0k(')]=lllii1[l1iII1(0x25f,'s7Er')](il1i1I,lI1li1);}else{const iI11II=activityArgv[l1iII1(0x257,'fZMK')]('_');iI11II[l1iII1(0x1c8,'I5@4')]===0x2?($[l1iII1(0x25c,'v(bU')]=iI11II[0x0],$['venderId']=iI11II[0x1]):$[l1iII1(0x164,'8cZK')]=iI11II[0x0];}}}catch{console[l1iII1(0x15b,')i8k')](lllii1[l1iII1(0x280,'(opy')]);return;}finally{if(!$['venderId']&&!$['shopId']){console['log'](lllii1[l1iII1(0x19b,'[rOU')]);return;}}if(!$[l1iII1(0x270,'Z[Sk')]||!$['shopId']){console[l1iII1(0x244,'F2(R')](lllii1['DnOWm']);return;}let i1i1II;if($[l1iII1(0x27b,'u6Y8')]&&!$[l1iII1(0x23a,'$y[C')]){if(lllii1[l1iII1(0x283,'@7wP')]('KpbDq',lllii1[l1iII1(0x236,'@7wP')])){let iIII1I={'venderId':String($['venderId'])},ilil1i,IlIIi,IiI1l;for(let illlII=0x0;lllii1[l1iII1(0x265,'2$rN')](illlII,0x2);illlII++){if(lllii1['RqiYV']===lllii1['DBojn']){i1l1li['log'](lllii1[l1iII1(0x254,'fZMK')]);return;}else{ilil1i=await common['getShopDetail'](iIII1I);let IiI1i=ilil1i?.[l1iII1(0x1c0,'5&Oa')]||{};i1i1II=IiI1i[l1iII1(0x264,'PREw')]||'',IlIIi=IiI1i['shopId'],IiI1l=IiI1i[l1iII1(0x1ac,'[rOU')];if(lllii1['elfOa'](i1i1II,IlIIi)&&IiI1l)break;iIII1I={'shopId':lllii1[l1iII1(0x210,'fZMK')](String,$[l1iII1(0x27b,'u6Y8')])},i1i1II='';}}if(lllii1[l1iII1(0x24b,'(opy')](!IlIIi,!IiI1l)){if(lllii1[l1iII1(0x1bf,'Jf6Y')](lllii1[l1iII1(0x185,'v(bU')],lllii1[l1iII1(0x167,'$y[C')])){console[l1iII1(0x273,'VJ6!')](lllii1[l1iII1(0x27e,'Nufz')]);return;}else i1illI=0x1;}else{if(lllii1[l1iII1(0x1f8,'rtAz')](lllii1[l1iII1(0x160,'PREw')],lllii1[l1iII1(0x245,'sVHM')]))$[l1iII1(0x20d,'@7wP')]=IlIIi,$['venderId']=IiI1l;else{if(!lI1IiI[l1iII1(0x18a,'D7Ja')]&&!i1lI['shopId']){lilIil[l1iII1(0x26c,'D7Ja')](lllii1['PqxZb']);return;}}}}else{I1ilI1[l1iII1(0x1bd,')i8k')](lllii1['kcaCP']),iillll['log'](lIIilI[l1iII1(0x177,'@7wP')]());return;}}console[l1iII1(0x244,'F2(R')]((i1i1II?'店铺名称：#'+i1i1II+'\x0a':'')+'店铺地址：https://shop.m.jd.com/?shopId='+$[l1iII1(0x16a,')i8k')]+'&venderId='+$['venderId']+'\x0a'),notify[l1iII1(0x272,'Nufz')](lllii1[l1iII1(0x1a4,'66MK')](notify[l1iII1(0x212,'fZMK')],(i1i1II?l1iII1(0x240,'7uJi')+i1i1II:'')+l1iII1(0x193,'Nfr3')+$[l1iII1(0x26f,'8cZK')]+'&venderId='+$['venderId']));try{const I1lIl1=lllii1['nRDcn'](parseInt,taskThreads);if(lllii1[l1iII1(0x235,'1(rI')](I1lIl1,0x0)&&lllii1[l1iII1(0x1dd,'66MK')](I1lIl1,0x1)){if(lllii1[l1iII1(0x173,'F2(R')](lllii1['HJxWM'],lllii1[l1iII1(0x187,'oeQ*')]))taskThreads=I1lIl1;else{I1iIiI[l1iII1(0x247,'UIpV')](lllii1['XOeEi']);return;}}}catch{taskThreads=0x1;}taskThreads=Math[l1iII1(0x258,'zh5j')](taskThreads,0x5),$['waitTime']=null;if(runInterval)try{if(l1iII1(0x18d,'R20N')===lllii1[l1iII1(0x1e0,'R20N')]){lIIil1[l1iII1(0x16b,'!*&A')](lllii1[l1iII1(0x1c4,'h0k(')]),IIli1[l1iII1(0x224,'8cZK')](II1liI['getInlineContent']());return;}else{const lI1liI=parseInt(runInterval);lllii1['xswSd'](lI1liI,0x0)&&($[l1iII1(0x186,'66MK')]=lI1liI);}}catch{console['log'](lllii1[l1iII1(0x25b,'N[%!')]);}await common[l1iII1(0x286,'1(rI')](taskThreads,cookiesArr,taskFnc);}catch(i1i1Ii){console[l1iII1(0x1d4,'R20N')](l1iII1(0x266,'Z[Sk')+i1i1Ii);}}async function taskFnc(lllii,iI11Ii){const iiill1=i11ii1,iIII1l={'TeMtH':iiill1(0x230,'HEWL'),'xCOJC':function(i11ill,IIIIIi){return i11ill>IIIIIi;},'qmXau':'⚠\x20自定义运行间隔时长设置错误','UqKIz':'未知奖品领取状态','Lzxuw':iiill1(0x1c7,'I5@4'),'gewLA':function(IIIIIl,I1lIil){return IIIIIl!==I1lIil;},'OsCJo':iiill1(0x22f,'1!U*'),'VbbkH':'zvYcO','MHjiJ':iiill1(0x260,'1!U*'),'sdUNg':function(IIIl1i,liiII1){return IIIl1i===liiII1;},'SQLfJ':iiill1(0x1bc,'Z[Sk'),'etjAT':function(IIIl1l,lllll){return IIIl1l===lllll;},'qYNjG':iiill1(0x1db,'D7Ja'),'Lqiqg':iiill1(0x192,'1!U*'),'vplyV':'F10000','folgO':'200','fmSZg':iiill1(0x17c,'t8B$'),'NDzpL':iiill1(0x1ab,'j&7^'),'hsDUm':iiill1(0x1ee,'F2(R'),'grkld':iiill1(0x24f,')ZZH'),'WEdwe':iiill1(0x19a,'I5@4'),'BrAAA':function(i11ili,iil1l1){return i11ili!==iil1l1;},'JBjmS':iiill1(0x27c,'D7Ja'),'VhTKp':'POST','bqntZ':'https://api.m.jd.com/client.action','ZislP':iiill1(0x1b0,'@7wP'),'xujGV':'shop_app_home_home','pHQyu':function(lllli,iiili1){return lllli||iiili1;},'ofPUg':iiill1(0x1e3,'rtAz'),'jWmZh':iiill1(0x24a,'sVHM'),'GVzvP':iiill1(0x262,'sVHM'),'tzfSb':iiill1(0x19f,'NGpY'),'QVGpt':iiill1(0x205,'5&Oa'),'GymCX':'application/x-www-form-urlencoded','CYDet':iiill1(0x218,'fZMK'),'uAeTT':iiill1(0x1cf,'1(rI'),'FfyYc':iiill1(0x1d0,'D7Ja'),'KsJAX':iiill1(0x1cd,'v(bU'),'mIWta':iiill1(0x15d,'HEWL'),'LzJFY':function(ill11i,lllill){return ill11i<lllill;},'IeQcg':'xQpFp','ccNMi':'HxAyW','TYZzN':iiill1(0x213,'66MK'),'GUSTD':function(ill11l,I1lIiI,lllili){return ill11l(I1lIiI,lllili);},'GCNXE':function(IliiiI,Ill11){return IliiiI>=Ill11;},'bAmaK':function(liiIII,li1i11){return liiIII(li1i11);},'kCROI':function(iI11I1,il1i1l){return iI11I1===il1i1l;},'fKMKH':'boolean','IPhyZ':iiill1(0x220,'1(rI'),'DYIoT':function(IlIlll,IIIl1I){return IlIlll+IIIl1I;},'ORaws':function(iil1ii,IlIlli){return iil1ii-IlIlli;},'tRhbW':iiill1(0x1b7,'u6Y8'),'cFZuD':function(il1i1i,lil111){return il1i1i*lil111;},'HQmCd':function(i11ilI,ii1ii1){return i11ilI(ii1ii1);},'QMmPZ':function(llllI,lllil1){return llllI===lllil1;},'sNxsh':iiill1(0x183,'PS9P'),'KAZDs':function(iil1il,ilil1I){return iil1il(ilil1I);}};if($['runEnd'])return{'runEnd':!![]};const lllil=iIII1l[iiill1(0x165,'oeQ*')](decodeURIComponent,common[iiill1(0x175,'8cZK')](lllii,iiill1(0x1da,'1(rI'))),iI11Il=notify['create'](iI11Ii,lllil),iIII1i=await common[iiill1(0x23f,'HEWL')](lllii);if(!iIII1i&&iIII1l[iiill1(0x184,')i8k')](typeof iIII1i,iIII1l[iiill1(0x180,'Nufz')])){if(iIII1l[iiill1(0x1c2,'u6Y8')]('EVZFZ','UYgKR')){iI11Il[iiill1(0x176,'1!U*')](iIII1l['IPhyZ']),console[iiill1(0x225,'qnAu')](iI11Il['getInlineContent']());return;}else return I1l1Ii[iiill1(0x1eb,'I5@4')](I1i11i['getInlineContent']()),{'runEnd':!![]};}const iil1i1=common[iiill1(0x1b9,'o]XU')](lllil),il1i11=iIII1l[iiill1(0x182,'t8B$')](iiill1(0x1b4,'[rOU'),Math['floor'](Math[iiill1(0x276,'!*&A')]()*iIII1l['ORaws'](0x2710,0x1869f)))+0x1869f,IlIll1=iIII1l[iiill1(0x19c,'rtAz')]+Math[iiill1(0x1ba,'PREw')](iIII1l[iiill1(0x267,'s7Er')](Math[iiill1(0x190,'Jf6Y')](),iIII1l[iiill1(0x250,'Ag7B')](0x2710,0x1869f)))+0x1869f,IlIII=common['getJEC'](lllil),ilil1l=common['getJEH']();let illlIi='',I1lIii='';await iIII1l[iiill1(0x178,'N[%!')](illlIl,iIII1l[iiill1(0x1e1,'s7Er')]);if(!I1lIii){iI11Il[iiill1(0x255,'t8B$')](iiill1(0x261,'DmGM')),console[iiill1(0x21a,'XZf$')](iI11Il['getInlineContent']());return;}if($[iiill1(0x284,'N[%!')])return{'runEnd':!![]};illlIi=I1lIii?.[iiill1(0x1b3,'rtAz')];if(!illlIi){iI11Il['fix'](iiill1(0x200,'66MK')),console['log'](iI11Il[iiill1(0x282,'u6Y8')]());return;}if(I1lIii[iiill1(0x204,'v(bU')]){const ii1iiI=await common[iiill1(0x263,'R20N')](![],$['shopId'],lllii);if(!ii1iiI&&iIII1l[iiill1(0x23d,'v(bU')](typeof ii1iiI,iiill1(0x198,'s7Er'))){if(iIII1l[iiill1(0x1d1,'sVHM')]('KNQgj',iIII1l['sNxsh'])){iI11Il['fix'](iiill1(0x196,'Ag7B')),console[iiill1(0x225,'qnAu')](iI11Il['getInlineContent']());return;}else llIlil=IIlil[iiill1(0x1ec,'sVHM')];}}if($['waitTime'])$[iiill1(0x168,'XZf$')]($[iiill1(0x20e,'XZf$')]);await iIII1l[iiill1(0x1e8,')i8k')](illlIl,iIII1l[iiill1(0x288,')i8k')]);if($[iiill1(0x1c9,'j&7^')])return console['log'](iI11Il[iiill1(0x1cc,'Xeu8')]()),{'runEnd':!![]};if($[iiill1(0x1b2,'sVHM')])$[iiill1(0x15e,'oeQ*')]($['waitTime']);console[iiill1(0x21f,'ozjb')](iI11Il['getInlineContent']());function IiI1I(ilil11,illlI1){const lIli1i=iiill1,IIIl11={'IzsxE':iIII1l[lIli1i(0x163,'!*&A')]};try{if(iIII1l['gewLA'](iIII1l[lIli1i(0x1cb,'[rOU')],iIII1l[lIli1i(0x26e,'66MK')]))switch(ilil11){case iIII1l[lIli1i(0x27f,'2$rN')]:iIII1l[lIli1i(0x1f3,'N[%!')](illlI1[lIli1i(0x1f9,'VJ6!')],'0')&&illlI1['isSuccess']&&illlI1[lIli1i(0x242,'@7wP')]?I1lIii=illlI1[lIli1i(0x24c,'F$X#')]:iI11Il[lIli1i(0x259,'rtAz')](lIli1i(0x1a5,'v(bU'));break;case iIII1l[lIli1i(0x1f6,'PS9P')]:if(iIII1l[lIli1i(0x232,'Ag7B')](illlI1[lIli1i(0x252,'Nfr3')],'0')&&illlI1[lIli1i(0x201,'2$rN')]&&illlI1[lIli1i(0x226,'NGpY')]){if(iIII1l['etjAT'](iIII1l['qYNjG'],iIII1l[lIli1i(0x26d,'D7Ja')])){l1lIii[lIli1i(0x195,'1(rI')](iIII1l[lIli1i(0x1d6,'t8B$')]),I11iI1[lIli1i(0x17b,'PREw')](l1lIil[lIli1i(0x1ce,'zh5j')]());return;}else{const {followCode:liiIIi,followDesc:lil11I,giftCode:Iliii1,giftDesc:iIiIi,alreadyReceivedGifts:iil1ll}=illlI1['result'];switch(liiIIi){case iIII1l['vplyV']:switch(Iliii1){case iIII1l[lIli1i(0x24d,'u6Y8')]:for(const iiilil of iil1ll){let iil1li=[iiilil?.[lIli1i(0x1e7,'s7Er')],iiilil?.['rearWord']][lIli1i(0x27a,'VJ6!')]('');switch(iiilil?.[lIli1i(0x268,'PREw')]){case 0x1:case 0x2:case 0x3:iI11Il['insert'](iil1li+'🗑️');break;case 0x4:iI11Il['insert'](iil1li+'🐶');break;case 0x6:iI11Il['insert'](iil1li+lIli1i(0x18b,'qnAu'));break;default:iI11Il[lIli1i(0x1fd,'D7Ja')](iil1li);break;}}break;case iIII1l['fmSZg']:console['log'](iIiIi);for(let lillIl of['抢完']){if(iIiIi[lIli1i(0x25a,'I5@4')](lillIl)){$[lIli1i(0x27d,'qnAu')]=!![],iI11Il[lIli1i(0x22b,'1(rI')](iIiIi);break;}}break;case iIII1l[lIli1i(0x25d,'7uJi')]:iI11Il[lIli1i(0x1e6,'R20N')](lIli1i(0x1d3,'Xeu8'));break;default:!iil1ll?iI11Il[lIli1i(0x26b,'F$X#')](lIli1i(0x228,'enxl')+Iliii1+'）'):(console['log']('未知奖品领取状态\x20'+JSON[lIli1i(0x1ef,'Xeu8')](illlI1[lIli1i(0x19d,'[rOU')])),iI11Il[lIli1i(0x1b5,'e0fq')](iIII1l[lIli1i(0x243,'Z[Sk')]));break;}break;case'F0402':iI11Il[lIli1i(0x171,'HEWL')](lil11I);break;default:console['log']('未知活动状态\x20'+JSON[lIli1i(0x256,'5&Oa')](illlI1['result'])),iI11Il['fix'](iIII1l[lIli1i(0x181,'Ag7B')]);}}}else{if(iIII1l[lIli1i(0x17f,'2$rN')](lIli1i(0x208,'F2(R'),iIII1l['grkld']))console[lIli1i(0x1e4,'Xeu8')]('❓'+ilil11+'\x20'+JSON[lIli1i(0x23e,')ZZH')](illlI1)),iI11Il['fix'](iIII1l[lIli1i(0x188,'v(bU')]);else try{const iiilii=l1i11I(II11II);iIII1l['xCOJC'](iiilii,0x0)&&(lilIli[lIli1i(0x189,'NGpY')]=iiilii);}catch{Iliill[lIli1i(0x21b,'Nfr3')](iIII1l['qmXau']);}}break;}else ilI1ll[lIli1i(0x1ea,'1(rI')]('❓'+Iillii+'\x20'+IlI1iI[lIli1i(0x249,'PS9P')](Iillil)),l1lIli['fix'](iIII1l[lIli1i(0x20f,'XZf$')]);}catch(IlIli1){if(iIII1l[lIli1i(0x18e,'ozjb')]!==iIII1l[lIli1i(0x1c5,'Xeu8')]){IiilI1[lIli1i(0x221,'fZMK')](IIIl11['IzsxE']);return;}else console[lIli1i(0x234,'s7Er')](lIli1i(0x239,')ZZH')+ilil11+'\x20请求响应\x20'+(IlIli1[lIli1i(0x1b1,'o]XU')]||IlIli1));}}async function illlIl(lI1lli){const IIIII1=iiill1;if(iIII1l[IIIII1(0x170,'sVHM')](iIII1l[IIIII1(0x1dc,')i8k')],iIII1l['JBjmS'])){if($[IIIII1(0x19e,'e0fq')])return;let Ill1l='',llI1Il=null,ii1iii=null,i11iil=iIII1l[IIIII1(0x1e9,'fZMK')],Ill1i={};switch(lI1lli){case iIII1l[IIIII1(0x1f7,'fZMK')]:Ill1l=iIII1l[IIIII1(0x18c,'66MK')],Ill1i={'shopId':''['concat']($[IIIII1(0x23a,'$y[C')]||''),'source':iIII1l[IIIII1(0x22d,'e0fq')],'displayWidth':IIIII1(0x1fb,'1!U*'),'sourceRpc':iIII1l[IIIII1(0x1a1,'rtAz')],'lng':IlIll1,'lat':il1i11,'venderId':''[IIIII1(0x1be,'Ag7B')]($['venderId']||'')},ii1iii={'functionId':iIII1l[IIIII1(0x17a,'enxl')]},llI1Il=common[IIIII1(0x15a,'66MK')](await common['getSign'](iIII1l[IIIII1(0x191,'Xeu8')],Ill1i));break;case iIII1l['SQLfJ']:Ill1l=IIIII1(0x166,'1(rI'),Ill1i={'follow':0x0,'shopId':''[IIIII1(0x269,'Z[Sk')]($[IIIII1(0x207,'e0fq')]||''),'activityId':''[IIIII1(0x16f,'s7Er')](iIII1l['pHQyu'](illlIi,'')),'sourceRpc':iIII1l[IIIII1(0x1aa,'s7Er')],'venderId':''['concat']($[IIIII1(0x1fa,'enxl')]||'')},ii1iii={'functionId':iIII1l[IIIII1(0x1d7,'PREw')]},llI1Il=common[IIIII1(0x16d,'1!U*')](await common[IIIII1(0x16e,'Ag7B')](iIII1l['SQLfJ'],Ill1i));break;default:console['log']('❌\x20未知请求\x20'+lI1lli);return;}const ii1iil={'url':Ill1l,'method':i11iil,'headers':{'Accept':iIII1l[IIIII1(0x275,'qnAu')],'Accept-Encoding':iIII1l[IIIII1(0x1b8,'$y[C')],'Accept-Language':iIII1l['tzfSb'],'Connection':iIII1l[IIIII1(0x1ca,'2$rN')],'Content-Type':iIII1l[IIIII1(0x215,'s7Er')],'Cookie':lllii,'J-E-H':ilil1l,'J-E-C':IlIII,'Sec-Fetch-Dest':iIII1l[IIIII1(0x279,'7uJi')],'Sec-Fetch-Mode':iIII1l[IIIII1(0x1a8,'D7Ja')],'Sec-Fetch-Site':IIIII1(0x1af,'!*&A'),'User-Agent':iil1i1,'x-referer-package':IIIII1(0x1bb,'v(bU'),'x-rp-client':iIII1l[IIIII1(0x238,'1(rI')]},'params':ii1iii,'data':llI1Il,'timeout':0x7530};iIII1l[IIIII1(0x1a3,'UIpV')](i11iil,iIII1l[IIIII1(0x1d2,'[rOU')])&&(delete ii1iil[IIIII1(0x1c3,'NGpY')],delete ii1iil[IIIII1(0x1a7,'Jf6Y')][iIII1l[IIIII1(0x211,'7uJi')]]);const lllI1l=0x1;let i11iii=0x0,llI1Ii=null,lllI1i=![];while(iIII1l[IIIII1(0x202,'fZMK')](i11iii,lllI1l)){const li1i1l=await common[IIIII1(0x21d,'R20N')](ii1iil);if(!li1i1l[IIIII1(0x22c,')i8k')]){if(IIIII1(0x20a,'Xeu8')===iIII1l['IeQcg']){llI1Ii=IIIII1(0x241,'(opy')+lI1lli+IIIII1(0x1e5,')i8k')+li1i1l[IIIII1(0x217,'F2(R')],i11iii++;continue;}else IiiIll['fix'](IIIII1(0x277,')ZZH'));}if(!li1i1l['data']){if(iIII1l[IIIII1(0x26a,'I5@4')]===iIII1l[IIIII1(0x287,'$y[C')]){const iIiII=i1III(Ii1iIi);iIII1l[IIIII1(0x161,'VJ6!')](iIiII,0x0)&&iIII1l[IIIII1(0x203,'1(rI')](iIiII,0x1)&&(Ii1iIl=iIiII);}else{llI1Ii=IIIII1(0x1d8,'Ag7B')+lI1lli+'\x20请求失败\x20➜\x20无响应数据',i11iii++;continue;}}iIII1l['GUSTD'](IiI1I,lI1lli,li1i1l[IIIII1(0x174,'(opy')]),lllI1i=![];break;}iIII1l[IIIII1(0x169,'UIpV')](i11iii,lllI1l)&&(console[IIIII1(0x18f,'N[%!')](llI1Ii),lllI1i&&($['outFlag']=!![]));}else lI1Iil[IIIII1(0x237,'v(bU')]=lilIiI[0x0];}}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
