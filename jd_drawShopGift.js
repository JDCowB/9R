/*
活动名称：店铺关注有礼
活动链接：店铺首页关注按钮
环境变量：jd_drawShopGift_argv // 活动参数，支持四种格式：”<shopId(店铺id)>_<venderId(店主id)>“ 或 ”<venderId(店主id)>“ 或 ”<shopId(店铺id)>“ 或 ”<活动店铺首页链接>“
        jd_drawShopGift_threads // 控制并发线程数（正整数），默认1
        jd_drawShopGift_interval // 自定义运行间隔时长（整数，单位毫秒），默认1000
        jd_drawShopGift_notify // 是否推送通知（true/false），默认不推送

高并发脚本，黑号领不到奖品
活动限制IP严重，建议使用代理，谨慎使用并发
请尽量使用第一种变量格式提供完整信息，否则可能会查询不到店铺信息

cron:1 1 1 1 *

*/

const $ = new Env('店铺关注有礼')
var iｉl='jsjiami.com.v7';const llI1I1=iii1II;(function(li1i1l,II1i1,lI1lll,iIiII,iil1lI,iiiliI,li1i1I){return li1i1l=li1i1l>>0x8,iiiliI='hs',li1i1I='hs',function(illIii,ii1il1,lI1llI,illIil,Ill1I){const l1iIII=iii1II;illIil='tfi',iiiliI=illIil+iiiliI,Ill1I='up',li1i1I+=Ill1I,iiiliI=lI1llI(iiiliI),li1i1I=lI1llI(li1i1I),lI1llI=0x0;const i11iiI=illIii();while(!![]&&--iIiII+ii1il1){try{illIil=-parseInt(l1iIII(0x14d,'S(uG'))/0x1*(parseInt(l1iIII(0xd8,'zVPU'))/0x2)+-parseInt(l1iIII(0x1cb,'6X)i'))/0x3*(parseInt(l1iIII(0x1de,'IvOb'))/0x4)+-parseInt(l1iIII(0x19e,'g)aD'))/0x5+-parseInt(l1iIII(0x10c,')rst'))/0x6*(parseInt(l1iIII(0x14f,'C(Lt'))/0x7)+parseInt(l1iIII(0x18f,'LR$q'))/0x8+-parseInt(l1iIII(0xf4,')lc&'))/0x9+parseInt(l1iIII(0x1a4,'h5Xo'))/0xa*(parseInt(l1iIII(0xcb,'^Ehd'))/0xb);}catch(lIli11){illIil=lI1llI;}finally{Ill1I=i11iiI[iiiliI]();if(li1i1l<=iIiII)lI1llI?iil1lI?illIil=Ill1I:iil1lI=Ill1I:lI1llI=Ill1I;else{if(lI1llI==iil1lI['replace'](/[UqIhEdkJfgxTBVQpAXPewC=]/g,'')){if(illIil===ii1il1){i11iiI['un'+iiiliI](Ill1I);break;}i11iiI[li1i1I](Ill1I);}}}}}(lI1lll,II1i1,function(lllI1I,lillI1,IlIlii,i1l1i1,liil11,iiillI,l1l111){return lillI1='\x73\x70\x6c\x69\x74',lllI1I=arguments[0x0],lllI1I=lllI1I[lillI1](''),IlIlii='\x72\x65\x76\x65\x72\x73\x65',lllI1I=lllI1I[IlIlii]('\x76'),i1l1i1='\x6a\x6f\x69\x6e',(0x16147e,lllI1I[i1l1i1](''));});}(0xc200,0xc636b,Iii11l,0xc4),Iii11l)&&(iｉl=0x14eb);const jdCookie=require('./jdCookie'),notify=require(llI1I1(0x1b5,'h5Xo')),common=require(llI1I1(0x1b1,')lc&'));console[llI1I1(0x159,'eXtT')](''),console['log'](llI1I1(0x191,'xSTb')+$['name']+llI1I1(0x168,'92Jk')),console[llI1I1(0x14a,'G))P')](llI1I1(0x100,'MMuc')),console[llI1I1(0x1b0,'4y(w')](llI1I1(0x162,'U#^n')),console['log'](llI1I1(0x1cc,'sGqu')),console['log']('jd_drawShopGift_notify\x20//\x20是否通知(true/false)，默认不推送'),console[llI1I1(0xe2,'BgpU')]('=========='+$[llI1I1(0xf8,'zVPU')]+llI1I1(0x129,'i9wm')),console[llI1I1(0xfa,'l[mp')]('');const activityArgv=process['env']['jd_drawShopGift_argv']||'';let taskThreads=process['env'][llI1I1(0xe7,'zVPU')]||'1';const runInterval=process['env'][llI1I1(0x15a,'0Z)j')]||'1000',isNotify=(process[llI1I1(0xee,'vFZ*')][llI1I1(0x106,'i9wm')]||process[llI1I1(0x17e,'6X)i')][llI1I1(0x1a7,'BgpU')])===llI1I1(0x1d2,'KyVr'),cookiesArr=Object[llI1I1(0xc8,'xSTb')](jdCookie)['map'](l1il1l=>jdCookie[l1il1l])['filter'](liIil=>liIil);function iii1II(_0x330190,_0x15c451){const _0x2e561a=Iii11l();return iii1II=function(_0x5c8682,_0x35a8dd){_0x5c8682=_0x5c8682-0xb4;let _0x554a78=_0x2e561a[_0x5c8682];if(iii1II['CWpgVj']===undefined){var _0x576f38=function(_0x3dd975){const _0x11f9f5='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x45e504='',_0x40b1ef='';for(let _0xc68829=0x0,_0x12cb76,_0xbf471f,_0xe5f7a4=0x0;_0xbf471f=_0x3dd975['charAt'](_0xe5f7a4++);~_0xbf471f&&(_0x12cb76=_0xc68829%0x4?_0x12cb76*0x40+_0xbf471f:_0xbf471f,_0xc68829++%0x4)?_0x45e504+=String['fromCharCode'](0xff&_0x12cb76>>(-0x2*_0xc68829&0x6)):0x0){_0xbf471f=_0x11f9f5['indexOf'](_0xbf471f);}for(let _0x20c7ba=0x0,_0x3671a4=_0x45e504['length'];_0x20c7ba<_0x3671a4;_0x20c7ba++){_0x40b1ef+='%'+('00'+_0x45e504['charCodeAt'](_0x20c7ba)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x40b1ef);};const _0x362ea5=function(_0x32dc6c,_0x4e515f){let _0x4bc4b4=[],_0x6a14ea=0x0,_0x4b3b05,_0x8fdccb='';_0x32dc6c=_0x576f38(_0x32dc6c);let _0x48a32a;for(_0x48a32a=0x0;_0x48a32a<0x100;_0x48a32a++){_0x4bc4b4[_0x48a32a]=_0x48a32a;}for(_0x48a32a=0x0;_0x48a32a<0x100;_0x48a32a++){_0x6a14ea=(_0x6a14ea+_0x4bc4b4[_0x48a32a]+_0x4e515f['charCodeAt'](_0x48a32a%_0x4e515f['length']))%0x100,_0x4b3b05=_0x4bc4b4[_0x48a32a],_0x4bc4b4[_0x48a32a]=_0x4bc4b4[_0x6a14ea],_0x4bc4b4[_0x6a14ea]=_0x4b3b05;}_0x48a32a=0x0,_0x6a14ea=0x0;for(let _0x149fe8=0x0;_0x149fe8<_0x32dc6c['length'];_0x149fe8++){_0x48a32a=(_0x48a32a+0x1)%0x100,_0x6a14ea=(_0x6a14ea+_0x4bc4b4[_0x48a32a])%0x100,_0x4b3b05=_0x4bc4b4[_0x48a32a],_0x4bc4b4[_0x48a32a]=_0x4bc4b4[_0x6a14ea],_0x4bc4b4[_0x6a14ea]=_0x4b3b05,_0x8fdccb+=String['fromCharCode'](_0x32dc6c['charCodeAt'](_0x149fe8)^_0x4bc4b4[(_0x4bc4b4[_0x48a32a]+_0x4bc4b4[_0x6a14ea])%0x100]);}return _0x8fdccb;};iii1II['onkAyb']=_0x362ea5,_0x330190=arguments,iii1II['CWpgVj']=!![];}const _0x3d2300=_0x2e561a[0x0],_0xfd93f2=_0x5c8682+_0x3d2300,_0x18aefb=_0x330190[_0xfd93f2];return!_0x18aefb?(iii1II['HcIUDc']===undefined&&(iii1II['HcIUDc']=!![]),_0x554a78=iii1II['onkAyb'](_0x554a78,_0x35a8dd),_0x330190[_0xfd93f2]=_0x554a78):_0x554a78=_0x18aefb,_0x554a78;},iii1II(_0x330190,_0x15c451);}function Iii11l(){const I1lIli=(function(){return[iｉl,'JPjshjeiVaQfmqgi.cpQkoPxwm.vAA7CUBhEdTIX==','CSoebSkuWOP6','W6Hsk8kQtmkyiSkszNnPymk3FeRcKCkfaK8VW6W8rIP3uea','sCkBFai1Bq','AgmPWOi','bSkPW5/dNIy','WQaAkSkOyW','W4JdLYSoaG','wmkJWRSuWRm','WRJcT8or','h8knW6HnW50','q2WUWOaX','WRmrm8k/xSof','WQOsoq','FSkBW4hcQmkAlq','AKaeWROE','oSkJWQhcUcZdJW','WRZcRCogW5dcHSosvI8C','WRqJk8kfwW','mCklW4tdPZy','W67dN8kQWRNdLq','4PM1WOZOHQRLRAlKUPdOV5JOOAVPLz/PMy7MLPRPLQ/ORBVNVj3PLjtOR7C','W63cKCkohxe','W43dUCkxaZO','jvVdJSkpj8kSB8kEy8o5','ltdcMXtdImo/tMJdKrm7lb4PWRlcH8ksECkeW70AW7NcIZ/cSYrMdUIgG+wTHUs5I+I9OEIITEMvSUMAUoAxPEMwS+++OUM5UUISOmkJWRPoWPW','vCk7W5FcT8ku','WOuJW7SuW5S','4P+0WOJMNRhOG6FMRARNOlVLPA/NKkZcGa','WQuQdH/dSey','W53cISoQE3JcRCoRWPe','wmkSqSoh','W5JcN1CUW5BcTCoWW6b3vMu','WRz+WP/dQCoJ','WQq0W4RdKWZdUG','e8oXW7tdSSkuW5CvW5ZdQCoWvd0','tSkgWRVcHCoa','WQ7cSmkBWQVcS8kTE2lcP8oPW7VdUfOAW7BdR8k1W690W4ycW7zAW50nd8kZf8oTiISTW5ClicpdGqK/WP3dT1TkC2a','smoTvW','WQhJG7/LUjpPK6xLKjdNPk/JGRm','WP7dNCkZjYJdQ8kxWRqJWRrAW6dcPG','WOiugSklBW','a0fQW5hdMG','ECoVW77dIWVdQmo5hmkeya','kmkzW5b4W4G','u8o7xIFdG0NcPCkB','WQWGW7S/W4S','W4ZdImkYWOpdVW','5BQY6zgK5lI95AYB5z6o5OIT6i2B5yYP5BIz6zkI5l225OgF5AAC6lsw','W5VcLCk0fLiw','WPjPCrLoySk1W5iKWQNcL8oyW6NcQW','wCk0WPaq','WPeWdG','WPGtfq','g8keW5nOW4K','ksBcHSoIECkl','k8kKW4TvW5C','W4ShW5tdPrC','W6GWW4tdSdu','W5VcGCk0n1mF','wCksqq4B','wtyoW5ldG8k2vv0','t8kwE8oBW70','W5NcISo1ANJcRmow','hgjNW63dMCkRW67dPmoPbJRdRfLsCuGzW4NdQCorACktmq','W4b0WQrR','W5dORPdMSytLPi7OTie64P2rF+AuQEwrK+w5G+AuNUAmLW','lcVcH8o2vCkDW6uE','nmkyxCotW7aSW6dcR8oIW5JdTmkjtXi','W4CxCmkeWQm','ttGdW4m','sIZcJw4W','yY/cJuuG','W4FcJmkSa2y','W5P3W5r8WRHT','WRWPW4iJW4tdMhfr','oSkZWQ7cJXxdHmoSgq','WOVdHGTWWPW','yCkCW4K','WQi2W4KHASkTia','oxfOdCk1','sdvAW7VdOSkXW7BdPW','k8kvWOxcNGq','W6lcM8oawLa','4PQ5W4NOH7lLRRhKUyZOVBFOOORPLA/PMyxMLkxPL7hORkVNV7tPL7FOROO','qmk6WQFcS8o+WO5iW77dLSojvWlcSq','WQu0e8kGFG','tG3cJCoXdq','v8oyyXVdLG','DCkgFW','z8kRWRlcI8oA','W498WPa','hqxcRXFdVW','W456W49bWPr6c00PWPO','8ykMIo+5Uq','hSoSW6BdMSoZWPfkWOlcNG','ewnmW5RdG8kLW6NdV8oUbc/dQLnaBgeeW5xdOSo9zSkrlq','WRVdMcj9WP4','WPFdNJxcRSkx','w+IVSoAXKEwMJ+I2LmoK4PYcWOW'].concat((function(){return['bG3cVdhdNW','qJGa','iSkhFdZdKW','emk3W4u','6lEl5y2D5PAe5Pwx','kZVcJmoGsCk8W5GiWPbNzMBcG8oEpLaYW41J','5BIF6zgN5zo+56sq776SW4e','eSk8W4FdUZ1iACkqjLyFuCo+W5a','4P2nWOZMNypNNihORltMSzZdTa','W5RcN1aOW53dO8knW7r2CxRcGCoQ','qSkTWOtcMSoO','W4XBW61pWRW','WQvlWQZdIq','fwz+W5S','f2H0','v8kvDq','W6X9W5bUWRa','h8oUgq','WQqNeHRdLvy','WQyJW4S','ESkDENPp','z8kxW7hcVmkHkmkbW4JdQmoMW4FcRLaRdmkUBvbpWRj/B0pcSUA2RowkSUwnNEAwVW','5PYp55275AwM5zkc6AcG5y+T54MA5Oo+','WRGYW5mM','tSodpSk3WRK','4P+0WOJOHOhMNlBOV5NOOjNPGkZLIjRKUkBPLPROR7/dUG','W7FdHrufaW','mcRcTSo2qSkoW5SPWPfMCxxcHCo3kgu5W4fJFsxcPa','W5/cMLq','F8kvumoRW7W','nmoSW7VdSCkIW5eoWOhdUSoGqIW','CSoebSkuWOf/WQFdUCoZW4pdS8k3','W7hdIcmRfSkwdrS','q8kXW7NdOmktW6CGW7W','tCk7vmorW4a','WOCCW5G0BG','WQ8NxCoCtbmyW4H2da','B8o2oSkwWOi','WRjwWRBdImo7W6W','WQXwWQVdMSoJW7a','l8kZWRVcTWFdQa','4PYwBUAFG+IbR+ATK+EIGEwMQoErVmoz','WOmtDfzkFCkKoCkW','WRGPpapdTW','W6yhC8kqWOK','W4vWW5W','W4bYWOmzWPO','WRHkwCkpW4u','WRK+W6/dNde','W77dUmofWOjS','WQK/W5u9Eq','WO7dObf5WRO','hSkOW7ddHZ8','8kg+Mo+4Na','bSkXW5ZdHXTl','W4VdKSojCwi','eSk5uWtdKmkcimkSW4dcJSo8Bq','mxhdISkqySkSlG','W6GwCmkOWO0','WRJdNYC','s8oeyZhdPW','doISQEAXTEwrR+w4Vd0','5O6k56w057I65P+ndCosWPfhW4q0pa/dKCkS','uSo/wtFdSLlcGCkA','z8ofeq','g2ntWPhcPmoTdaVdIN4cE8kpW60','W4ldLmoVWR58sCkMW5i','qCkWWPmrWPvMn8oR','WRBdPaZcGCkm','5P6b55Yk5AEs5zoE6AkB5yYj54Iu5Oo0uq','pIhcH8o3','WOxdNHbVWP3dQmkBWRP5vexdRCofWOVcJ8kFfmkuWRfYWRFdGLhdOs/dSb3cLmkZWOeCW7dcPSkB','nclcN8ocAG','W49ixmkhW5NcHe1+CbH8','WRuvmCkUESkviConA35KAmk+uglcI8koceqs','emkIsG','W6ddIdKghCkilrhdMrBdSmoduKFcGmoU','WQFORzRMSi/LKOlLU6FdHa','B8kmDK9GW5xcJ8o/','5lQM566C5zke5BMf6zoZ6k6t5A2z5y2J5lIv5lIN57YC','W4xdOmoFWQbi','6lEZ5y2B5PAG5PAW','WOGFa8oBWPldHJqQ','WQysW6ZdVaO','W77cGCkmbh4','W4mjqa','W6VdGIO','WQWHW58ZF8kV','gmkzWPZcQq','WQK6W4i','WRajcIhdMG','W4lcGCo3EM/cQW','WOq9W7O+W5e','5P6j55+25AAH5zk76Ag05y2w54UK5Oku','n3/dKCkD','sCoXvW','rCkWWO4aWPXG','WPmSnSkGEW','W6nKWORcL1JdQuddVmkbWRFdTa','W6ibW7S','W4LxmaOskCkcomkIW6RcUGe'].concat((function(){return['F8klrIGx','W5KdsCknWR7cI0pcSG','W4Gdu8kGWRxcLwpcUhxdUNddP8ohWRRcQ8kV','WRqimmkBs8kq','WQNdNH5RWQG','W6BcHCk3bvi','W4HIWRqkWP8','8yYRUmkA','W6H7aSkoyci2W40','aCkaW6e','xCkXWQirWOj1cCoCla1wWRVdRxNdLs/dMmkIhZ3dLSkvW4ZcVG','WOKBbmolWQpdNraR','W4ZdGmkpkHeX','iSkbvsxdUq','WPtcK8kF','WQqKW5FdOW7dQG','W4HVW4TGWPHQgvGNWPayw17cHSkQlZNdL8oQWRxdJCo4rmkoz8kmW7zrD1NdN8kUWRe','WPO8btyMWPxcTq','W4n7W6rOWOnOd38MWPagm0/dJCkPbZRcKSo+WR/dNSoXgSoBoSopWRpMJPJLIklLUydLJARNUBtNQ57MLk3VVjJPUzJORBma','ls/cGmoM','qmkXua','jh/dJmkiu8kKlqK','lSk/WRC','tCkUr8kpW5T1WOKj','5yYT6yEd6k+X5PMuhdddO8kgFmocW4VcICkHW7m','Bb/cPmoopCkK','W5v2WPKEWPFdSHVdSq','WRmPW5ddKG','W5VcHCkPjLag','W58hvCkAWR7cRhJcUKddMg3dQmoEWRRcSCk+jG','WReMbq','W456W49fWP9LeuiRWRWzgLldJSkZla','6i6B5yYi5Rsm5yIk5l2j5OgY5AEx6lwC','hCouW6ldJ8kl','tmoPWOxcGMqCt8kzhLytsG','WPVcK8kwWPZdTCk8WRFdKa','W7DmAmo4jmkqWQZdUmo7oaHKWQS','DSkCBg1PW4BcOq','WP5wAmkXWRNcGeFcMq','44oU5O6Q56wx44kU6kYa5yE86i+k5y6ya0CJAt/cSa','E8kwW4dcVmk2o8k/W78','AsZcVq','W4PiaCoAWQpdRcCE','WO8SgmkBtq','5PYp55275Rsl5yUR54Iq5Oc6','gSkKvq','EqxcJq','jMnAf8kD','v8ozkmkSWPO','WQXCWQi','CatcNa','ySkUWQ/cICoVzSoO','emkpWO3cUdi','q8k7BSo0W40','m8kyrcpdRG','W47cL8kqnLC','igRdL8kvACkQkqOf','WPyoFG','uWtcLNeD','WPKeW73dSJO','W5b7WPGkWRZdOt/dSa','p8krW6hdUay','W71wWPfuoq','W6b2t1ZcPqnxW4xcKCovW73dJSoa','WRhdJttcMq','WPySW6aLu8kkdSoHWOVdRW','WRKKW43dOaZdR2m','W61Rd8kjycmm','W6JdIWWMga','zSoYDstdHa','W4X0WQLramoBwSkYW5pcKsfcArbkW5C','5PYe556Y5RwC5yIo54IH5OoEga','W6/dKCoQyWXc','8jkPVSoD','WPxcSmkWWP7dTW','iCk4WRZcMdddNW','c8kgW74','WQeQeW7dUuaSW7m','g2vqWP7cOSoRdxNdGeiuzSkf','W7ZdNmoHBK8','a8k8W53dKZDDsCkA','W4JdLCoIWRfOwq','iSobW5ldGCkT','WPullSopWPO','W7DneCkgr8knhmoY','W6tdGIbHqmosDb3dIsZcSCohqK/cGCo4W74NW4K','wdijW4ldSSkTCvW','W4L3WQGEWOddOsxdHSkXW4tdI1FcG8oPW69wWOnSnKFcNCkx','hKnfW73dVa','W414WQu','WPRdIW1RWRRcU8ozW7a','CCoMW7RdJdhdJCoqmmkJBW','ouZdLSk2vW','umkVWPqfW5W0gSoQiG5hWOJdOtpcGrldGW','W45Wk8k7Cq','j8k3WQtcK8oUBCoUuehdSG','W4FcGmoJ','W4pcHrfRWOFcVSohWRPkqu7cPSoeW5BcUSkrxSk0WRfYW7xdJLm','hgjNW63dMCkRW67dQmoJhZ7dHfy','bmoRW7RdTCkyW54kW5ZdSCoXxstcKCoBdmk9hHy'];}()));}()));}());Iii11l=function(){return I1lIli;};return Iii11l();};!cookiesArr[0x0]&&($[llI1I1(0x1d9,'G))P')]($['name'],llI1I1(0x177,'%FW^')),process[llI1I1(0x16b,'S(uG')](0x1));!(async()=>{const IlIlil=llI1I1;notify['config']({'title':$[IlIlil(0xba,'0Z)j')]}),await Main(),isNotify&&notify[IlIlil(0xe4,'U#^n')]()&&await notify['push']();})()[llI1I1(0x119,'BgpU')](IllI1I=>$['logErr'](IllI1I))['finally'](()=>$[llI1I1(0x131,'i9wm')]());async function Main(){const lIli1I=llI1I1,liIii={'DUAcI':'未知奖品领取状态','FKMuZ':lIli1I(0xef,')lc&'),'LcBNP':function(II1ll1,IlI1Ii){return II1ll1||IlI1Ii;},'hhhMs':function(i11I1I,l1il1i){return i11I1I(l1il1i);},'EvVXE':function(ll1,iI1llI){return ll1>iI1llI;},'nZSrA':function(llliii,IllI11){return llliii===IllI11;},'EbkbA':'HifzG','FeONi':'⚠\x20请先定义必要的环境变量后再运行脚本','gwJek':'https://','TLNOP':lIli1I(0xcc,'10sN'),'fjsvP':function(l1llIi,II1llI){return l1llIi||II1llI;},'VGLLW':'⚠\x20请填写格式正确的环境变量','aecsh':lIli1I(0x171,')rst'),'eDVCM':lIli1I(0x18d,'vFZ*'),'UBIPe':function(i11I11,l1llIl){return i11I11<l1llIl;},'TJgVz':lIli1I(0x1bd,'eXtT'),'vMZTt':'bHCMq','IaTyR':function(ii1I1l,ii1I1i){return ii1I1l(ii1I1i);},'DRwPd':function(llI,llliI){return llI||llliI;},'DiDUJ':function(iI1li1,lllii1){return iI1li1!==lllii1;},'GpWAV':lIli1I(0x17f,'r05&'),'odrQk':lIli1I(0xc1,'WS%m'),'BruVN':lIli1I(0x1a2,')rst'),'pdlhW':function(liIli,liIll){return liIli!==liIll;},'ofAik':lIli1I(0x11b,'S(uG'),'ItDEM':lIli1I(0xd7,'r05&'),'ayReO':function(IilIi1,iI1liI){return IilIi1===iI1liI;},'pCUZj':lIli1I(0x1be,'u%H^'),'GUepo':lIli1I(0x1b9,'h5Xo')};try{if(liIii[lIli1I(0x13b,'7t(6')](liIii[lIli1I(0xfb,'U#^n')],liIii['EbkbA'])){if(!activityArgv){console[lIli1I(0x179,'J0c$')](liIii['FeONi']);return;}try{if(activityArgv[lIli1I(0x12d,'7t(6')](liIii[lIli1I(0x187,'%%C&')])){if(liIii[lIli1I(0x127,'G))P')](liIii[lIli1I(0xed,'L&Hm')],'rZZRK'))ilI1li[lIli1I(0x15e,'GE%f')]('❓'+IIliI+'\x20'+ilI1ll[lIli1I(0x188,'iZIL')](Iillii)),IlI1iI[lIli1I(0x166,'IvOb')](liIii[lIli1I(0xb6,'iqvQ')]);else{const {shopId:IilIiI,venderId:i1i1I1,vendorId:IlII1}=common['parseUrlParameter'](activityArgv);$['shopId']=IilIiI,$['venderId']=liIii[lIli1I(0xe1,'O7FL')](i1i1I1,IlII1);}}else{const IiI11=activityArgv['split']('_');liIii[lIli1I(0x110,'^Ehd')](IiI11['length'],0x2)?($[lIli1I(0x1bf,'HzpS')]=IiI11[0x0],$[lIli1I(0x19d,'LR$q')]=IiI11[0x1]):$[lIli1I(0x1d1,'4y(w')]=IiI11[0x0];}}catch{console[lIli1I(0x182,'6X)i')](liIii[lIli1I(0x18a,'J0c$')]);return;}finally{if(liIii['aecsh']!==liIii[lIli1I(0x10d,'KyVr')]){const liIlI=II1Ii[lIli1I(0x1b8,'vFZ*')]('_');liIlI[lIli1I(0x112,'a&g9')]===0x2?(lI1Il1[lIli1I(0x121,'vFZ*')]=liIlI[0x0],lilIi1[lIli1I(0xd2,'i#qZ')]=liIlI[0x1]):IiilII['venderId']=liIlI[0x0];}else{if(!$[lIli1I(0xca,'i9wm')]&&!$[lIli1I(0xd1,'U#^n')]){console['log'](liIii[lIli1I(0x18e,'xSTb')]);return;}}}let l1lIiI;if($[lIli1I(0x158,'aTJ(')]&&!$['shopId']){if(liIii[lIli1I(0x1a8,'zVPU')]!==liIii[lIli1I(0xf6,'U#^n')])I1i11l=llIlii[lIli1I(0x16c,'%%C&')];else{let llli1={'venderId':String($[lIli1I(0x16a,'BgpU')])},iIli1i,iI1lii,IilIii;for(let iI1lil=0x0;liIii[lIli1I(0x11c,'7t(6')](iI1lil,0x2);iI1lil++){if(liIii[lIli1I(0x15d,'L&Hm')]===liIii[lIli1I(0x1d4,'a&g9')]){I1lliI[lIli1I(0x19c,'eXtT')](liIii[lIli1I(0xbf,'eXtT')]),llIllI[lIli1I(0x1bc,'ts3#')](I1ilI1['getInlineContent']());return;}else{iIli1i=await common[lIli1I(0x1b2,'zVPU')](llli1);let iIli1l=iIli1i?.[lIli1I(0x10a,'^Ehd')]||{};l1lIiI=iIli1l[lIli1I(0x18c,'BgpU')]||'',iI1lii=iIli1l['shopId'],IilIii=iIli1l['venderId'];if(l1lIiI&&iI1lii&&IilIii)break;llli1={'shopId':liIii[lIli1I(0x117,'10sN')](String,$[lIli1I(0x1a6,'g)aD')])},l1lIiI='';}}if(liIii[lIli1I(0x1c6,'vFZ*')](!iI1lii,!IilIii)){if(liIii['DiDUJ'](liIii[lIli1I(0x125,'10sN')],liIii['odrQk'])){console[lIli1I(0x181,'a&g9')](lIli1I(0xb7,'G))P'));return;}else Iii11I['waitTime']=Iil1II;}else $[lIli1I(0x1c1,'MMuc')]=iI1lii,$[lIli1I(0x1a0,'vFZ*')]=IilIii;}}console[lIli1I(0xd5,'MMuc')]((l1lIiI&&lIli1I(0xf1,'iqvQ')+l1lIiI+'\x0a')+'店铺地址：https://shop.m.jd.com/?shopId='+$['shopId']+lIli1I(0x1af,'O7FL')+$[lIli1I(0x13d,'%FW^')]+'\x0a'),notify['updateContent'](notify[lIli1I(0x183,'O7FL')]+((l1lIiI&&lIli1I(0x1da,'4y(w')+l1lIiI)+'\x0a【店铺地址】https://shop.m.jd.com/?shopId='+$[lIli1I(0xfd,'LR$q')]+'&venderId='+$[lIli1I(0xb4,'G))P')]));try{const liiIIl=parseInt(taskThreads);liiIIl>0x0&&liIii[lIli1I(0x1dc,'h5Xo')](liiIIl,0x1)&&(taskThreads=liiIIl);}catch{'eykLb'!==liIii[lIli1I(0xe9,'ai4m')]?taskThreads=0x1:lI1Iil['venderId']=lilIiI[0x0];}$[lIli1I(0x15b,'%FW^')]=null;if(runInterval){if(liIii['pdlhW'](liIii[lIli1I(0x116,'LR$q')],liIii[lIli1I(0x194,'hKR%')])){const {shopId:il1i1I,venderId:lI1li1,vendorId:iI11II}=II11Ii[lIli1I(0x16d,'10sN')](II11Il);IlI11[lIli1I(0xbe,'i9wm')]=il1i1I,iIIIIl[lIli1I(0x139,'OI%F')]=liIii['LcBNP'](lI1li1,iI11II);}else try{const iIII1I=parseInt(runInterval);iIII1I>0x0&&(liIii['nZSrA'](liIii[lIli1I(0xda,'4y(w')],liIii['ItDEM'])?$[lIli1I(0x12a,'G))P')]=iIII1I:IliilI[lIli1I(0xfe,'i#qZ')](lIli1I(0x104,'P0W5')+i1II1));}catch{if(liIii['ayReO'](liIii[lIli1I(0x13e,'S(uG')],liIii['GUepo'])){const IiI1l=liIii['hhhMs'](i1illl,I1llil);liIii[lIli1I(0x1df,'eXtT')](IiI1l,0x0)&&(lilIll['waitTime']=IiI1l);}else console[lIli1I(0x17d,'L&Hm')](lIli1I(0x1c8,'ai4m'));}}await common[lIli1I(0x173,'GE%f')](taskThreads,cookiesArr,taskFnc);}else IIli1l['log'](lIli1I(0x1cf,'P0W5')+II1lii+lIli1I(0x128,'KyVr')+(lIIii1[lIli1I(0xd6,'IWvq')]||ll1i1));}catch(iIII11){console[lIli1I(0x140,'10sN')]('❌\x20脚本运行遇到了错误\x0a'+iIII11);}}async function taskFnc(IiI1i,llll1){const II1il=llI1I1,lil11l={'fBYYc':'未知活动状态','szRkk':II1il(0xdb,'OI%F'),'kqCpm':'getShopHomeActivityInfo','flWxj':function(iil1i1,il1i11){return iil1i1===il1i11;},'OoWSz':II1il(0x1d6,')rst'),'PnGQt':II1il(0x198,'%%C&'),'VrFbp':'402','hPKxC':II1il(0x1c4,'iqvQ'),'tZwJL':II1il(0x13a,'7t(6'),'DtztF':function(IlIll1,IlIII){return IlIll1===IlIII;},'cCJcF':II1il(0xc5,'KyVr'),'HObfe':II1il(0x101,'G))P'),'HkxfO':function(ilil1l,illlIi){return ilil1l!==illlIi;},'UkzQN':'【提示】请先获取Cookie','phXJp':II1il(0x132,')lc&'),'NqVyp':II1il(0x167,'KyVr'),'jRsJP':function(I1lIii,IiI1I){return I1lIii||IiI1I;},'SUjol':II1il(0x1ad,'0Z)j'),'mLHaV':II1il(0x1d8,'ts3#'),'TyRHR':'keep-alive','crZbq':'empty','oeYVe':'cors','CPPkY':'same-origin','xFyok':function(illlIl,i11ill){return illlIl===i11ill;},'RIZzM':'yJYmN','RfvOY':function(IIIIIi,IIIIIl){return IIIIIi===IIIIIl;},'tIOWB':II1il(0xbd,'eXtT'),'bhShA':'MYGSQ','rFSXp':function(I1lIil,IIIl1i){return I1lIil(IIIl1i);},'VuAHY':II1il(0x169,'6X)i'),'ClEgb':II1il(0x124,'iZIL'),'ovFaC':II1il(0x13c,'ai4m'),'DqTNM':function(liiII1,IIIl1l){return liiII1+IIIl1l;},'ctbQJ':II1il(0xfc,'KyVr'),'EBKpL':function(lllll,i11ili){return lllll*i11ili;},'OzfAq':function(iil1l1,lllli){return iil1l1-lllli;},'XYBEp':'114.','ZQkgE':function(iiili1,ill11i){return iiili1*ill11i;},'OGzxJ':function(lllill,ill11l){return lllill(ill11l);},'xJlIz':'POJMG','eMOoi':II1il(0x170,'KyVr'),'bVvJJ':function(I1lIiI,lllili){return I1lIiI!==lllili;},'XHyoG':II1il(0x145,'LR$q'),'qCVgt':'JvNrD','cJufT':function(IliiiI,Ill11){return IliiiI===Ill11;},'WaVWB':II1il(0x108,'KyVr'),'OemVn':'ekGiH','XZbRz':function(liiIII,li1i11){return liiIII(li1i11);},'ESvPm':function(iI11I1,il1i1l){return iI11I1!==il1i1l;}};if($[II1il(0xb8,'%%C&')])return{'runEnd':!![]};const i1i1Il=lil11l[II1il(0xdf,'G))P')](decodeURIComponent,common[II1il(0xb9,'92Jk')](IiI1i,lil11l[II1il(0x180,'^Ehd')])),I1lIl1=notify[II1il(0x142,'IWvq')](llll1,i1i1Il),lil11i=await common[II1il(0xf2,'vFZ*')](IiI1i);if(!lil11i&&lil11l[II1il(0x19f,'P0W5')](typeof lil11i,lil11l[II1il(0x195,'G))P')])){I1lIl1[II1il(0xbb,'EWTh')](lil11l[II1il(0x1bb,'0Z)j')]),console[II1il(0xe2,'BgpU')](I1lIl1[II1il(0x152,'10sN')]());return;}const IlIIl=common['genUA'](i1i1Il),lI1liI=lil11l[II1il(0x150,'l[mp')](lil11l[II1il(0xff,'OI%F')]+Math[II1il(0x11d,'IWvq')](lil11l['EBKpL'](Math[II1il(0x1b6,'l[mp')](),lil11l[II1il(0x1ba,'hKR%')](0x2710,0x1869f))),0x1869f),i1i1Ii=lil11l[II1il(0x1c9,'%%C&')](lil11l['DqTNM'](lil11l[II1il(0x184,'IvOb')],Math[II1il(0xd4,')lc&')](lil11l[II1il(0xe3,'sGqu')](Math[II1il(0xc2,'%%C&')](),lil11l['OzfAq'](0x2710,0x1869f)))),0x1869f),lllii=common[II1il(0x113,'IvOb')](i1i1Il),iI11Ii=common['getJEH']();let iIII1l='',lllil='';await lil11l[II1il(0x1d7,'O7FL')](iIII1i,lil11l['kqCpm']);if(!lllil){if(lil11l['xJlIz']==='POJMG'){I1lIl1['fix'](lil11l[II1il(0xdd,'HzpS')]),console[II1il(0xec,'g)aD')](I1lIl1[II1il(0x137,'hKR%')]());return;}else IIlil[II1il(0x189,'C(Lt')](lil11l[II1il(0x1c7,'iqvQ')]);}if($[II1il(0x1c3,'IvOb')])return{'runEnd':!![]};iIII1l=lllil?.['activityId'];if(!iIII1l){I1lIl1[II1il(0xbc,'%FW^')]('活动不存在或已领过'),console['log'](I1lIl1['getInlineContent']());return;}if(lllil['followed']){if(lil11l[II1il(0x1ca,'r)[(')](lil11l[II1il(0x1cd,'MMuc')],lil11l['qCVgt'])){const IIIl1I=await common['followShop'](![],$[II1il(0x1b4,'^Ehd')],IiI1i);if(!IIIl1I&&lil11l[II1il(0x11e,')lc&')](typeof IIIl1I,lil11l[II1il(0xf5,'O7FL')])){if(lil11l[II1il(0x13f,'%%C&')]!==lil11l[II1il(0x155,'%%C&')]){I1lIl1[II1il(0x14e,'WS%m')]('取关店铺失败'),console[II1il(0x141,'hKR%')](I1lIl1[II1il(0x16f,'U#^n')]());return;}else I1iIli[II1il(0x164,'KyVr')](lil11l[II1il(0x122,'P0W5')]);}}else i1ll['shopId']=i1l1lI[0x0],i1iliI[II1il(0x10b,'hKR%')]=I1iIii[0x1];}if($[II1il(0x165,'iZIL')])$[II1il(0x102,'IWvq')]($[II1il(0x1aa,')lc&')]);await lil11l['XZbRz'](iIII1i,II1il(0x123,'L&Hm'));if($[II1il(0x153,'h5Xo')]){if(lil11l[II1il(0x186,'L&Hm')](II1il(0x17b,'HzpS'),II1il(0x18b,'S(uG')))IllIIl['log'](IiiIi1),l1ii1&&(IliI1l[II1il(0x175,'OI%F')]=!![]);else return console[II1il(0xe0,'OI%F')](I1lIl1[II1il(0x16f,'U#^n')]()),{'runEnd':!![]};}if($[II1il(0xc4,'g)aD')])$[II1il(0x163,'i9wm')]($['waitTime']);console['log'](I1lIl1[II1il(0x196,'xSTb')]());function iI11Il(lil111,i11ilI){const lllI11=II1il;try{switch(lil111){case lil11l[lllI11(0x156,'BgpU')]:lil11l[lllI11(0xb5,'i#qZ')](i11ilI[lllI11(0xcd,'g)aD')],'0')&&i11ilI['isSuccess']&&i11ilI[lllI11(0x111,'a&g9')]?lllil=i11ilI[lllI11(0x1d5,'S(uG')]:I1lIl1[lllI11(0x144,'IWvq')](lllI11(0x17c,'G))P'));break;case lil11l[lllI11(0x103,'^Ehd')]:if(i11ilI['code']==='0'&&i11ilI['isSuccess']&&i11ilI[lllI11(0x1d5,'S(uG')]){const {followCode:ii1ii1,followDesc:llllI,giftCode:lllil1,giftDesc:iil1il,alreadyReceivedGifts:ilil1I}=i11ilI[lllI11(0x14b,'0Z)j')];switch(ii1ii1){case lil11l[lllI11(0x1ae,'aTJ(')]:switch(lllil1){case lllI11(0x107,')lc&'):for(const i11il1 of ilil1I){let ii1iiI=[i11il1?.['redWord'],i11il1?.[lllI11(0xd3,'IvOb')]]['join']('');switch(i11il1?.['prizeType']){case 0x1:case 0x2:case 0x3:I1lIl1['insert'](ii1iiI+lllI11(0xe5,'EWTh'));break;case 0x4:I1lIl1[lllI11(0x19b,'IvOb')](ii1iiI+'🐶');break;case 0x6:I1lIl1['insert'](ii1iiI+lllI11(0x120,'zVPU'));break;default:I1lIl1[lllI11(0x146,'4y(w')](ii1iiI);break;}}break;case lil11l[lllI11(0xe8,')lc&')]:console[lllI11(0x17d,'L&Hm')](iil1il);for(let lllilI of['抢完']){if(iil1il['includes'](lllilI)){$[lllI11(0x15f,'S(uG')]=!![],I1lIl1['insert'](iil1il);break;}}break;case lil11l['hPKxC']:I1lIl1[lllI11(0xbb,'EWTh')](lil11l[lllI11(0x1c5,'HzpS')]);break;default:!ilil1I?I1lIl1[lllI11(0x1a9,'xSTb')]('参与活动成功但未领取到奖品（'+lllil1+'）'):lil11l[lllI11(0x154,')lc&')](lllI11(0x12f,'ai4m'),lil11l[lllI11(0xd9,'IvOb')])?(console[lllI11(0x181,'a&g9')](lllI11(0x130,'4y(w')+JSON['stringify'](i11ilI['result'])),I1lIl1[lllI11(0x136,'L&Hm')](lil11l[lllI11(0x10e,'IWvq')])):(lilIii['shopId']=i1ill1,iIIl1l['venderId']=llIli1);break;}break;case lllI11(0x11a,'%FW^'):I1lIl1[lllI11(0x16e,'LR$q')](llllI);break;default:console['log'](lllI11(0x197,'g)aD')+JSON[lllI11(0x115,'C(Lt')](i11ilI[lllI11(0x1d0,'LR$q')])),I1lIl1[lllI11(0x189,'C(Lt')](lil11l[lllI11(0x1c2,'u%H^')]);}}else console[lllI11(0x118,'U#^n')]('❓'+lil111+'\x20'+JSON['stringify'](i11ilI)),I1lIl1[lllI11(0x12b,'^Ehd')](lllI11(0x148,'BgpU'));break;}}catch(illlI1){lil11l['HkxfO'](lllI11(0x133,'i9wm'),lllI11(0xd0,'%%C&'))?lliiii[lllI11(0x192,'S(uG')]=!![]:console[lllI11(0x1c0,'h5Xo')](lllI11(0x114,'i9wm')+lil111+lllI11(0x138,'hKR%')+(illlI1[lllI11(0x161,'EWTh')]||illlI1));}}async function iIII1i(I1lIi1){const I1lIll=II1il;if($['runEnd'])return;let liiIIi='',lil11I=null,Iliii1=null,iIiIi=I1lIll(0x143,'IvOb'),iil1ll={};switch(I1lIi1){case lil11l[I1lIll(0x1a3,'%FW^')]:liiIIi=lil11l[I1lIll(0x105,'hKR%')],iil1ll={'shopId':''['concat']($['shopId']||''),'source':lil11l[I1lIll(0x147,'i#qZ')],'displayWidth':I1lIll(0x134,'%FW^'),'sourceRpc':I1lIll(0x1b3,')rst'),'lng':i1i1Ii,'lat':lI1liI,'venderId':''[I1lIll(0x15c,'r)[(')]($[I1lIll(0x12e,'0Z)j')]||'')},Iliii1={'functionId':lil11l[I1lIll(0x11f,'vFZ*')]},lil11I=common[I1lIll(0xf0,'i9wm')](await common['getSign'](I1lIll(0xc7,'zVPU'),iil1ll));break;case lil11l[I1lIll(0xce,'J0c$')]:liiIIi='https://api.m.jd.com/client.action',iil1ll={'follow':0x0,'shopId':''['concat']($['shopId']||''),'activityId':''[I1lIll(0x1a1,'7t(6')](lil11l[I1lIll(0x1ac,'iZIL')](iIII1l,'')),'sourceRpc':I1lIll(0x135,'h5Xo'),'venderId':''['concat']($[I1lIll(0x178,'MMuc')]||'')},Iliii1={'functionId':lil11l[I1lIll(0xc0,'WS%m')]},lil11I=common['queryStringToObject'](await common['getSign'](lil11l[I1lIll(0x1ce,'i#qZ')],iil1ll));break;default:console[I1lIll(0xf9,'zVPU')](I1lIll(0xf3,'^Ehd')+I1lIi1);return;}const iiilil={'url':liiIIi,'method':iIiIi,'headers':{'Accept':'*/*','Accept-Encoding':lil11l[I1lIll(0x14c,'HzpS')],'Accept-Language':lil11l[I1lIll(0x19a,'GE%f')],'Connection':lil11l['TyRHR'],'Content-Type':I1lIll(0x160,'U#^n'),'Cookie':IiI1i,'J-E-H':iI11Ii,'J-E-C':lllii,'Sec-Fetch-Dest':lil11l['crZbq'],'Sec-Fetch-Mode':lil11l[I1lIll(0x185,'KyVr')],'Sec-Fetch-Site':lil11l['CPPkY'],'User-Agent':IlIIl,'x-referer-package':I1lIll(0x1a5,'hKR%'),'x-rp-client':I1lIll(0xe6,')rst')},'params':Iliii1,'data':lil11I,'timeout':0x7530};lil11l[I1lIll(0xcf,'J0c$')](iIiIi,'GET')&&(delete iiilil[I1lIll(0x190,'ai4m')],delete iiilil['headers'][I1lIll(0x109,')rst')]);const iil1li=0x1;let lillIl=0x0,iIiIl=null,iiilii=![];while(lillIl<iil1li){const li1i1i=await common[I1lIll(0xc6,'4y(w')](iiilil);if(!li1i1i[I1lIll(0x193,'aTJ(')]){iIiIl=I1lIll(0x157,'IWvq')+I1lIi1+I1lIll(0xea,'zVPU')+li1i1i['error'],lillIl++;continue;}if(!li1i1i[I1lIll(0x149,'iZIL')]){if(lil11l[I1lIll(0x1dd,'zVPU')](I1lIll(0xeb,'sGqu'),lil11l['RIZzM']))lilIl1[I1lIll(0x126,'ai4m')](i1l1ii['name'],lil11l['UkzQN']),i1l1[I1lIll(0xf7,'a&g9')](0x1);else{iIiIl=I1lIll(0x199,'0Z)j')+I1lIi1+I1lIll(0xc9,'C(Lt'),lillIl++;continue;}}iI11Il(I1lIi1,li1i1i[I1lIll(0x1b7,'u%H^')]),iiilii=![];break;}if(lillIl>=iil1li){console[I1lIll(0xd5,'MMuc')](iIiIl);if(iiilii){if(lil11l[I1lIll(0xde,'6X)i')](lil11l['tIOWB'],lil11l[I1lIll(0xc3,'l[mp')])){if(!lI1IiI[I1lIll(0x151,'10sN')]&&!i1lI['shopId']){lilIil[I1lIll(0x179,'J0c$')]('⚠\x20请填写格式正确的环境变量');return;}}else $['outFlag']=!![];}}}}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
