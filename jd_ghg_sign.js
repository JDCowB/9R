/*
活动名称：个护馆签到

cron:39 9 * * *

*/

const $ = new Env('个护馆签到')
var iｉl='jsjiami.com.v7';const l1iIIi=iii1II;(function(l1iil,ii1l1,lIIill,I11iIi,I1ilII,I11iIl,l1l11l){return l1iil=l1iil>>0x2,I11iIl='hs',l1l11l='hs',function(IilIil,l1iIi,l1l11i,l1iIl,illIll){const lIII1l=iii1II;l1iIl='tfi',I11iIl=l1iIl+I11iIl,illIll='up',l1l11l+=illIll,I11iIl=l1l11i(I11iIl),l1l11l=l1l11i(l1l11l),l1l11i=0x0;const iIli1I=IilIil();while(!![]&&--I11iIi+l1iIi){try{l1iIl=parseInt(lIII1l(0x94,'zUNf'))/0x1+-parseInt(lIII1l(0xec,'Ty0@'))/0x2+-parseInt(lIII1l(0xc9,'6flb'))/0x3+parseInt(lIII1l(0xef,'zUNf'))/0x4+-parseInt(lIII1l(0x10f,'6P0N'))/0x5+parseInt(lIII1l(0xfa,'p2^v'))/0x6*(-parseInt(lIII1l(0x96,'2%Y%'))/0x7)+parseInt(lIII1l(0x99,'n85U'))/0x8;}catch(Iiil1){l1iIl=l1l11i;}finally{illIll=iIli1I[I11iIl]();if(l1iil<=I11iIi)l1l11i?I1ilII?l1iIl=illIll:I1ilII=illIll:l1l11i=illIll;else{if(l1l11i==I1ilII['replace'](/[MHWLnCdYGKgxIqRl=]/g,'')){if(l1iIl===l1iIi){iIli1I['un'+I11iIl](illIll);break;}iIli1I[l1l11l](illIll);}}}}}(lIIill,ii1l1,function(iiilli,l1iIIl,iiilll,lI11Il,lIII1i,l11i11,IilIl1){return l1iIIl='\x73\x70\x6c\x69\x74',iiilli=arguments[0x0],iiilli=iiilli[l1iIIl](''),iiilll=`\x72\x65\x76\x65\x72\x73\x65`,iiilli=iiilli[iiilll]('\x76'),lI11Il=`\x6a\x6f\x69\x6e`,(0x163adc,iiilli[lI11Il](''));});}(0x32c,0xb3c8b,Iii11l,0xcd),Iii11l)&&(iｉl=l1iIIi(0xd1,'SSw2'));function iii1II(_0xb06a4a,_0xc94f66){const _0x4ce77e=Iii11l();return iii1II=function(_0x3d50a5,_0x4a9fbe){_0x3d50a5=_0x3d50a5-0x8b;let _0x4f6088=_0x4ce77e[_0x3d50a5];if(iii1II['jewezn']===undefined){var _0x22578b=function(_0x404bb9){const _0x39e0e2='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x935cff='',_0x3d9440='';for(let _0x4a1fed=0x0,_0x380132,_0x3ac928,_0x2fc19e=0x0;_0x3ac928=_0x404bb9['charAt'](_0x2fc19e++);~_0x3ac928&&(_0x380132=_0x4a1fed%0x4?_0x380132*0x40+_0x3ac928:_0x3ac928,_0x4a1fed++%0x4)?_0x935cff+=String['fromCharCode'](0xff&_0x380132>>(-0x2*_0x4a1fed&0x6)):0x0){_0x3ac928=_0x39e0e2['indexOf'](_0x3ac928);}for(let _0x3e0a8f=0x0,_0x4ebe99=_0x935cff['length'];_0x3e0a8f<_0x4ebe99;_0x3e0a8f++){_0x3d9440+='%'+('00'+_0x935cff['charCodeAt'](_0x3e0a8f)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3d9440);};const _0x2e57a2=function(_0x18dc2b,_0x57b2b3){let _0x51f1ec=[],_0x2520ff=0x0,_0x37b8c4,_0x1c9d51='';_0x18dc2b=_0x22578b(_0x18dc2b);let _0x3ded16;for(_0x3ded16=0x0;_0x3ded16<0x100;_0x3ded16++){_0x51f1ec[_0x3ded16]=_0x3ded16;}for(_0x3ded16=0x0;_0x3ded16<0x100;_0x3ded16++){_0x2520ff=(_0x2520ff+_0x51f1ec[_0x3ded16]+_0x57b2b3['charCodeAt'](_0x3ded16%_0x57b2b3['length']))%0x100,_0x37b8c4=_0x51f1ec[_0x3ded16],_0x51f1ec[_0x3ded16]=_0x51f1ec[_0x2520ff],_0x51f1ec[_0x2520ff]=_0x37b8c4;}_0x3ded16=0x0,_0x2520ff=0x0;for(let _0x58b685=0x0;_0x58b685<_0x18dc2b['length'];_0x58b685++){_0x3ded16=(_0x3ded16+0x1)%0x100,_0x2520ff=(_0x2520ff+_0x51f1ec[_0x3ded16])%0x100,_0x37b8c4=_0x51f1ec[_0x3ded16],_0x51f1ec[_0x3ded16]=_0x51f1ec[_0x2520ff],_0x51f1ec[_0x2520ff]=_0x37b8c4,_0x1c9d51+=String['fromCharCode'](_0x18dc2b['charCodeAt'](_0x58b685)^_0x51f1ec[(_0x51f1ec[_0x3ded16]+_0x51f1ec[_0x2520ff])%0x100]);}return _0x1c9d51;};iii1II['IQRits']=_0x2e57a2,_0xb06a4a=arguments,iii1II['jewezn']=!![];}const _0x410f8c=_0x4ce77e[0x0],_0x4a28d7=_0x3d50a5+_0x410f8c,_0x550a07=_0xb06a4a[_0x4a28d7];return!_0x550a07?(iii1II['wUdSdl']===undefined&&(iii1II['wUdSdl']=!![]),_0x4f6088=iii1II['IQRits'](_0x4f6088,_0x4a9fbe),_0xb06a4a[_0x4a28d7]=_0x4f6088):_0x4f6088=_0x550a07,_0x4f6088;},iii1II(_0xb06a4a,_0xc94f66);}const jdCookie=require(l1iIIi(0x118,'GRQX')),notify=require(l1iIIi(0x91,'yKJ2')),common=require('./utils/Rebels_jdCommon'),{H5st}=require(l1iIIi(0xb6,'2%Y%')),isNotify=![];let cookie='';const cookiesArr=Object[l1iIIi(0xe1,'9nju')](jdCookie)[l1iIIi(0x11b,'Y#d[')](ilI1li=>jdCookie[ilI1li])[l1iIIi(0xa6,'SSw2')](IIliI=>IIliI);!cookiesArr[0x0]&&($['msg']($['name'],l1iIIi(0xbc,'[@m!')),process['exit'](0x1));function Iii11l(){const iIli11=(function(){return[...[iｉl,'IxKjILxsRGRjidaHmglMi.nMcqoMmCII.lWvYI7G==','W57cJNNdJSom','stVdSSkysa','WPqLdSkmWP8','44cm5O2p56wH44gJ6k+65ysU6i235yYxWQuYW5VcRCkqCq','gmoJW6KYW5xdLKG','W4NdQ8kGo8obWPNdMq','WPapp0NcLW','WOJdKCoQ','sfFcQmoxwa','vWJdV8kIWQK','W4rPatxcR8kQ','sH/dJmkLW4DOW4hcUKpdHmorW6PVCh5OW4W','s8khWRi','W5/dINpdON4','WQDFW63dNCkZW5L+WRRcKrtcUmoYW4e','eSkZWP1mWQO','W4xdR8k1pG','WQmGhvtcRW','WO3dMh3cHfm','WPO3hq','W7pdN8kG','WRjCt18','W5BdKMf0','pCoZW78/','WQ/cL8kPA28','l8ooW7m+W60','mf7dMCkrWR1WcwrtW7f7WQdcMwJcGti','emowW5mN','WONORlBMSy3LK6NLUzBdJq','WRqRzq','mSk0WPXuWORcOgNdRW','WQG1gmkCcY8','44k85OYQ56sR44kq6k2m5yAU6i+b5y2hWOtdRmoMvCkTWR8','WO1kimktza','WOFdLglcTey','DSo7obPIe8kQWQJcHZpdK8kzWPeH','cSosW4KGW497eW','amosW44FW49OeWVdJZpcOSoIWOvLW7iFsSoyW6u','WO7cLCoXWR9jsq','s8oOW5rdW7ZcMJpdKJTWo8oOfq','t8kNwSkZWOWTWQSSt8kQEfG','DmoRlWj+xmoVW67cLI/dM8oOWPq6WRZcSgZcKCo6W73cVupcSWe4k8k1e0r6DSobFY4RW4GFu8k0zaJdRmkhsSkwWR7cQrXyqfXBW4/cU27dQCkrdd7cJt/cI8osxXP7rwNcQSksqmoV','WOddLmoGkq','WOhcRSkCz1m','WOFdVhNcTMa','WQ3cGCoWDCkbqIP8WOT2WOjrW4W','W5FdI8osomoS','cSoWW502W4K','WRZcUSkCCvqKoM4ur1xcQmo3W7W+kSkRfx0','p8oMbq','eSoXdKu','WP4lkq','pmo9tdeKFYG'],...(function(){return[...['W4HZbYJcQ8k1AhtdGHhcJmk/xJm','WPBdQw5VWQq6xvZdQ8oLfrzzW7i','AmkPqmkM','W74bza','EtdcN8oaW50OW5PxW5JdKIjM','W758WPbhEW','uJxcQYy+xmoHCSku','x2BdG8oqofRdRa','W4hcN2ldSSoAWOet','sSknWQy+emkHcq','WOamELy','e8kaBa','4PYsl+AFJoIdS+ATT+EJVowLNoEqQ8og','a8owW44Y','aCoEW4i','WQyHW7e','W4RdQ8k4la','g8kABW','W4fXqSozW4FcMYhcIfBdUSo2W7a','WPdcHCoXWP1trq','FNhdMCkDW4O','WOpdM8o5mGWhoMzTv8o8WPL0tW','smkDWQelhCkNcW','W5FcHtq6ac5pWO00exzjg8oYkXK6Eh5sovzad8kDW5/dPKRdVmoyW5LN','WOpcGmoVWRruqKeaW6RcNCkQWRDdeWmZtsq2W7ddLepdULtcOSk4W6ldQLtdO3nYaG','WRmjchdcMW','WP5/zxvyW4NcP8oSrCo2WOv3q0BcN1mBWOZdOSoaW7BdJSovvG/cVW','W7L/s8opsN/dP3tdJCkWFexdHG','v3hdGSomk3ddRdaxWOBcJ8kb','WQ/cHmolWRXZ','ySkUd3z1BqZcSa/cTmoo','W43dHSkjl8ov','EWNdHCkr','4P6pWRRMNj3OGi7MRzFNO7xLPkZNKkNcRa','WPJdTIeq','WO7cN8o4','6lEr5y6Z5PAA5PAN','m27cJ2a','kmo5W5qvW74','W4JdS8oFlCoB','WO3dLSoc','eglcUGW8xSotuG','WQaIgmknuIVcVxpdTSkG','W6ddRg5mnG','566J5yM05OIg5yQklW','lCoCW5uMW6q','WO3dT8o1cu0','WRCoxvjw','rCk4WPGLpa','tSoIW5fgW7NcMtddJszsg8o4iG','iCoSydiSDG','WR4kggxcRq','DSkcxCkIWRe','WPldH8o7mSkJ','WRhdV0dcKKBdV2zoW6eM'],...(function(){return['yvVdOmobnG','WR1ssv14W67cJG','ffVcPufw','W4BdNCkxnCoj','umoleJXh','vGtdJ8kwWP4','nNVcKN5NWQH3aSkhW7KBWQ0LbGVdHSk9W7G9W4jOp8ojW5W6','At3dLtKKWQrTxmk2W548W6eT','W7bkbrxcPq','WROwgmk8WQy','WPBdRwPRWQy9uZ3dRCoZbILp','wtJdJCkcWPu','AmkUvWFcOr/cJow/PUwLGEoaJos4Ros5SEI0NowmOW','WPRdLmoGmW','WP4Wt1fP','d8oHdL7dQLldGW','W5TnjvNcRCoAW6hdHxn7','c8oyW50','WQWIcCkXhJ7cTgNdTmkeyKFdGSoXWQtdKSo3zSkB','WPOLcG','8lU7Hsm','WQ/dUmo9eZm','o33cLgfMW589xSkvW6GvW6y','lmoFW60lW60','W49ZcG','WPKnka','dmkwFbnzW6PXCZRcPq','W7hdGCkscW','W4nWhs3cO8k7yc7dIbhcJ8k+qNDDmGhcRmkmz8kteCoUvCo4t2pcGKaEhNXc','WO11lSklWQW','8lgAV1y','rthcQWq','tZRdTCkrq04a','W7xdK1a','WOexpvpcJCouW7ZdILL2W4CliSoqW61ZWO3cRwC','E8o6lZO4fCk0','WOieDG','tY7dU8kxc1ibF8ovWPtcUq','W49LhJlcQ8k/za','WQqREf9w','hwdcIhPXW7WSamkYW7acW6y','amoOW4qwW6q','WPSllfBcOmouW6pdIW','dMNcP3mFWQlcISoCW5nAtJJcMSkNFWbbW7/cMhT/bqPnWQaUWPe','CH7dIW','zmkDWQ1k','ymkRc3vYixVcRr/cO8oQWQ4T','WOddUmoLdq','ketcLmotW6qLiXfdW4j1WRa','ySkPwCkI','W7zbWPXWuq','z8kFWRbiWPBcK8k9WR99xMRcV1vL','WOybW4VcSSobW7BdHSo4W63cLW8IC1NcLG','WOmRcSkJWP7dJb0'];}())];}())];}());Iii11l=function(){return iIli11;};return Iii11l();};!(async()=>{const lilIi=l1iIIi,ilI1ll={'zmZwB':function(Iillii,IlI1iI){return Iillii(IlI1iI);},'QDaqo':lilIi(0x103,'zUNf'),'kjBiv':lilIi(0xeb,'jZYj'),'ONnFP':'0123456789abcdef','mGgeg':function(Iillil){return Iillil();},'GIagA':function(l1lIli,lIIiiI){return l1lIli!==lIIiiI;},'CtYDj':lilIi(0x104,'GRQX')};notify['config']({'title':$[lilIi(0x97,'iahz')]});for(let II1lil=0x0;II1lil<cookiesArr[lilIi(0xc2,'B&(w')];II1lil++){$['index']=II1lil+0x1,cookie=cookiesArr[II1lil],common[lilIi(0xd7,'p2^v')](cookie),$['UserName']=ilI1ll[lilIi(0xa5,'*$rc')](decodeURIComponent,common['getCookieValue'](cookie,ilI1ll['QDaqo'])),$['UA']=common['genUA']($['UserName']),$[lilIi(0x8c,'SSw2')]=notify[lilIi(0xbb,'Ty0@')]($[lilIi(0xff,'IWg7')],$[lilIi(0xba,'Ugmv')]),$['nickName']='',console[lilIi(0xb0,'6flb')](lilIi(0x114,'pyfq')+$['index']+'】'+($[lilIi(0x90,'GRQX')]||$['UserName'])+'******\x0a'),$['eid']=common[lilIi(0x9a,'Nobr')](0x5a,ilI1ll['kjBiv'])['toUpperCase'](),$['fp']=common['genRandomString'](0x20,ilI1ll[lilIi(0xf7,'0EZb')]),await ilI1ll[lilIi(0xcb,'0EZb')](Main),common['unsetCookie']();if($['runEnd'])break;await $[lilIi(0xc6,'XYPK')](0x3e8);}isNotify&&notify['getMessage']()&&(ilI1ll[lilIi(0x113,'2%Y%')](lilIi(0x11f,'0EZb'),ilI1ll[lilIi(0x116,'X3UV')])?(iii1Ii[lilIi(0x121,'GRQX')](iii1Il[lilIi(0x11e,'6P0N')]),lI1IiI[lilIi(0x117,'pyfq')][lilIi(0xdf,'0EZb')](i1lI['errorMessage'])):(notify[lilIi(0xaa,'r)cg')]('\x0a'),await notify[lilIi(0xce,'pyfq')]()));})()[l1iIIi(0x9e,'Y#d[')](II1lii=>$['logErr'](II1lii))['finally'](()=>$['done']());async function Main(){const l1l11I=l1iIIi,lIIii1={'gSVjm':l1l11I(0xc4,'iahz'),'pXxsM':function(IIli1i,I1iIi1){return IIli1i===I1iIi1;},'ZqtZf':function(lliil1,IIllI){return lliil1!==IIllI;},'VBRiA':'MRbSQ','DfNET':l1l11I(0xb1,'jZYj'),'fdgTG':l1l11I(0x100,'X3UV')},ll1i1=await common[l1l11I(0xe6,'!RE[')](cookie);if(!ll1i1&&lIIii1['pXxsM'](typeof ll1i1,l1l11I(0x109,'jZYj'))){console['log'](l1l11I(0xf5,'Y#d['));return;}try{lIIii1[l1l11I(0xc7,'VSRm')](l1l11I(0x111,'Y#d['),lIIii1[l1l11I(0xad,'GRQX')])?(delete Iliil1[l1l11I(0xb2,'^LZC')],delete i1III['headers'][lIIii1[l1l11I(0x10b,'9nju')]]):await sendRequest(lIIii1[l1l11I(0xc8,'ZDQ%')]);}catch(lili1){l1l11I(0x9c,'[@m!')===lIIii1['fdgTG']?II11I1[l1l11I(0xd9,'[@m!')]['fix'](Iii11I):console[l1l11I(0xa3,'!RE[')]('❌\x20脚本运行遇到了错误\x0a'+lili1);}}async function handleResponse(IllIIi,IllIIl){const lilIl=l1iIIi,IiiIi1={'FkGMu':lilIl(0xf6,'6P0N'),'HucsJ':function(l1ii1,ii1ll){return l1ii1===ii1ll;},'AvEAj':function(IliI1l,lliiil){return IliI1l!==lliiil;},'wPUgm':'flyGd','yonJU':'jciWJ','bPMhM':lilIl(0xae,'ZDQ%')};try{switch(IllIIi){case IiiIi1[lilIl(0xea,'GRQX')]:if(IiiIi1['HucsJ'](IllIIl[lilIl(0x128,'SKkL')],!![])&&IllIIl?.[lilIl(0xde,'0EZb')]?.['signSuccess'])IiiIi1['AvEAj'](IiiIi1[lilIl(0xca,'1i7[')],IiiIi1['wPUgm'])?I1iIil['log'](lI1Iil['data']?.[lilIl(0x120,'SSw2')]):IllIIl?.[lilIl(0xdb,'!0c]')]?.['signSuccess']?console[lilIl(0xf4,'B&(w')]('签到成功,'+IllIIl[lilIl(0xac,'9nju')]['topLine']+IllIIl[lilIl(0xd3,'iahz')][lilIl(0x107,'ZDQ%')]):IiiIi1[lilIl(0x10d,'2%Y%')](IiiIi1[lilIl(0x8d,'X3UV')],lilIl(0xf8,'1i7['))?iIIIIi?.[lilIl(0x95,'IWg7')]?.['signSuccess']?lI1Il1['log'](lilIl(0xfd,'X3UV')+lilIi1['data'][lilIl(0x9b,'Y#d[')]+IiilII[lilIl(0x127,'p2^v')][lilIl(0x122,'qSeN')]):IliI1I[lilIl(0x121,'GRQX')](lI1Iii[lilIl(0xb3,'I^Oz')]?.['msg']):console['log'](IllIIl['data']?.[lilIl(0xdc,'qSeN')]);else IllIIl[lilIl(0xd5,'!TlB')]?(console[lilIl(0xa8,'#J%P')](IllIIl[lilIl(0xed,'wSGP')]),$['message']['fix'](IllIIl['errorMessage'])):IiiIi1['bPMhM']===IiiIi1[lilIl(0x101,'#J%P')]?console[lilIl(0x92,'2%Y%')]('❓'+IllIIi+'\x20'+JSON['stringify'](IllIIl)):(li1Ii['log'](Iliiii),i1illI&&(Iii111[lilIl(0xe7,'#J%P')]=!![],l1l1II[lilIl(0xd8,'wSGP')]&&l1i11I[lilIl(0xda,'#J%P')][lilIl(0x12c,'!0c]')](II11II)));break;}}catch(IIli11){console[lilIl(0x129,')7gC')](lilIl(0xf2,'ZDQ%')+IllIIi+lilIl(0xb8,'ZXs#')+(IIli11['message']||IIli11));}}async function sendRequest(IllIII){const IilIlI=l1iIIi,ii1li={'UBGhG':IilIlI(0x9f,'fvCU'),'GdvBS':IilIlI(0x123,'9nju'),'PWPLY':IilIlI(0x115,'XYPK'),'HyImC':IilIlI(0xe5,'!TlB'),'xvVXG':IilIlI(0xbf,'fvCU'),'gYlmU':IilIlI(0xb9,'X3UV'),'RvNhc':IilIlI(0xe8,'^LZC'),'tnfFO':IilIlI(0xcf,'Y#d['),'SXPbo':IilIlI(0x93,'n85U'),'qWbqs':IilIlI(0x124,'SSw2'),'TQkAW':'zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,en-GB;q=0.6','FvDcJ':IilIlI(0xfb,'Ty0@'),'zJieX':IilIlI(0xe9,'B&(w'),'DNUGr':'api.m.jd.com','PDaCi':IilIlI(0xc5,'fvCU'),'RJhTo':IilIlI(0xa2,'GRQX'),'yjnFY':'cors','WoLvp':IilIlI(0x8b,'SKkL'),'tHAVZ':function(lilil,ll1ll){return lilil===ll1ll;},'utdjn':IilIlI(0x11d,'!RE['),'jhMFf':IilIlI(0x8e,'6P0N'),'LTINJ':function(Illl11,ii1lI){return Illl11<ii1lI;},'MtTdN':IilIlI(0x125,'xNXS'),'JTCOB':function(I1ilIl,I11iII){return I1ilIl>I11iII;},'CDGim':function(I1ilIi,IiiiI,llIlli){return I1ilIi(IiiiI,llIlli);}};if($[IilIlI(0xe4,'B&(w')]||$[IilIlI(0xa0,'tkeW')])return;let IIll1='',ll1il={},IiiIiI=ii1li['GdvBS'];switch(IllIII){case ii1li[IilIlI(0xbd,'Ki(6')]:h5stOptions={'appId':ii1li[IilIlI(0xb5,'0EZb')],'functionId':IilIlI(0x12a,'GRQX'),'appid':ii1li[IilIlI(0xfe,'n85U')],'clientVersion':common[IilIlI(0xc1,'0EZb')](),'client':ii1li['gYlmU'],'body':{'code':ii1li[IilIlI(0xf0,'6flb')],'fp':$['fp'],'eid':$['eid'],'deviceInfoVO':{'openid':-0x1,'client':IilIlI(0xf9,'IWg7'),'clientVersion':common[IilIlI(0xcc,'VSRm')](),'uuid':'','osVersion':IilIlI(0xf3,'ZXs#')}},'version':IilIlI(0xcd,'iahz'),'ua':$['UA'],'t':!![]},h5st=await H5st[IilIlI(0x12b,'fvCU')](h5stOptions),IIll1=IilIlI(0x10e,'6P0N')+h5st['params'],ll1il={'code':ii1li['RvNhc'],'fp':$['fp'],'eid':$[IilIlI(0xe2,'qSeN')],'deviceInfoVO':{'openid':-0x1,'client':ii1li[IilIlI(0xa4,'l4km')],'clientVersion':common[IilIlI(0x11a,'Ty0@')](),'uuid':'','osVersion':ii1li[IilIlI(0x108,'wSGP')]}};break;default:console[IilIlI(0xd4,'Ni4k')]('❌\x20未知请求\x20'+IllIII);return;}const lilii={'url':IIll1,'method':IiiIiI,'headers':{'Accept':ii1li[IilIlI(0x98,'vU]y')],'Accept-Encoding':IilIlI(0xa7,'*$rc'),'Accept-Language':ii1li[IilIlI(0xfc,'^LZC')],'Connection':ii1li[IilIlI(0xa9,')7gC')],'Content-Type':ii1li[IilIlI(0x105,'iahz')],'Cookie':cookie,'Host':ii1li[IilIlI(0xbe,'ZDQ%')],'Referer':ii1li['PDaCi'],'Origin':'https://pro.m.jd.com','Sec-Fetch-Dest':ii1li[IilIlI(0x110,'SSw2')],'Sec-Fetch-Mode':ii1li[IilIlI(0xd6,'vU]y')],'Sec-Fetch-Site':ii1li['WoLvp'],'User-Agent':$['UA']},'body':ll1il,'timeout':0x7530};ii1li[IilIlI(0xb4,'VSRm')](IiiIiI,IilIlI(0xe0,'Nobr'))&&(ii1li[IilIlI(0x9d,'SKkL')]!==ii1li[IilIlI(0xab,'Ugmv')]?iIIl1l[IilIlI(0x129,')7gC')](IilIlI(0xdd,'6P0N')+llIli1+'\x20请求响应\x20'+(iliIII[IilIlI(0xc0,'0EZb')]||iIIl1i)):(delete lilii['body'],delete lilii[IilIlI(0xa1,'9nju')][ii1li['jhMFf']]));const l1iiI=0x1;let ll1li=0x0,Illl1I=null,lliiiI=![];while(ii1li[IilIlI(0x10c,'fvCU')](ll1li,l1iiI)){if(ii1li[IilIlI(0xee,'B&(w')]!==ii1li['MtTdN'])lilIl1[IilIlI(0xaf,'Y#d[')](i1l1ii['name'],ii1li[IilIlI(0x8f,'n85U')]),i1l1[IilIlI(0xf1,'2%Y%')](0x1);else{ii1li[IilIlI(0x10a,'6P0N')](ll1li,0x0)&&await $[IilIlI(0xb7,'0EZb')](0x3e8);const Iiii1=await common['request'](lilii);if(!Iiii1['success']){Illl1I=IilIlI(0x126,'v&f5')+IllIII+'\x20请求失败\x20➜\x20'+Iiii1[IilIlI(0x106,'XYPK')],ll1li++;continue;}if(!Iiii1?.['data']){Illl1I=IilIlI(0x11c,'Ni4k')+IllIII+'\x20请求失败\x20➜\x20无响应数据',ll1li++;continue;}ii1li['CDGim'](handleResponse,IllIII,Iiii1['data']),lliiiI=![];break;}}ll1li>=l1iiI&&(console[IilIlI(0x119,'0EZb')](Illl1I),lliiiI&&($['outFlag']=!![],$[IilIlI(0xd0,'zUNf')]&&$['message']['fix'](Illl1I)));}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `🔔${this.name}, 开始!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============📣系统通知📣=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `🔔${this.name}, 结束! 🕛 ${s} 秒`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
